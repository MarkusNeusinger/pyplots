library: matplotlib
specification_id: donut-nested
created: '2025-12-25T20:01:52Z'
updated: '2025-12-25T20:04:01Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 20510189997
issue: 2015
python_version: 3.13.11
library_version: 3.10.8
preview_url: https://storage.googleapis.com/pyplots-images/plots/donut-nested/matplotlib/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/donut-nested/matplotlib/plot_thumb.png
preview_html: null
quality_score: 92
review:
  strengths:
  - Excellent hierarchical color scheme with consistent color families per department
    (hue for category, lightness for subcategories)
  - Clear visual separation between inner and outer rings using white edges
  - 'Smart labeling strategy: direct labels on larger segments (≥$100K), comprehensive
    legend for all categories'
  - Realistic and relatable budget allocation scenario that demonstrates the nested
    donut concept effectively
  - Clean code structure following KISS principles with well-organized data definitions
  weaknesses:
  - Legend is positioned slightly far from the chart, creating some visual disconnect
  - Inner ring labels could use a slightly larger font for better prominence at full
    resolution
  - Could include percentage values alongside dollar amounts to better show part-to-whole
    relationships
  image_description: 'The plot displays a nested donut chart showing budget allocation
    data. The inner ring shows 4 departments (Engineering $650K in dark blue, Marketing
    $450K in yellow, Operations $330K in green, Sales $430K in red). The outer ring
    shows expense categories within each department using lighter shades of the parent
    department''s color. Labels with values are placed directly on larger segments.
    A comprehensive legend on the right side lists all 12 expense categories grouped
    by department (e.g., "Engineering: Salaries", "Marketing: Advertising"). The title
    "donut-nested · matplotlib · pyplots.ai" appears at the top. White edge lines
    separate all segments. The chart uses a square 1:1 aspect ratio format.'
  criteria_checklist:
    visual_quality:
      score: 36
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 9
        max: 10
        passed: true
        comment: 'All text is readable; inner ring labels are bold white and clear;
          outer ring labels use appropriate sizing. Minor: some outer ring labels
          could be slightly larger for perfect readability at full size.'
      - id: VQ-02
        name: No Overlap
        score: 8
        max: 8
        passed: true
        comment: No overlapping text; labels are well-positioned on their respective
          segments.
      - id: VQ-03
        name: Element Visibility
        score: 8
        max: 8
        passed: true
        comment: Donut rings are well-proportioned with appropriate widths (0.4 inner,
          0.35 outer); white edge lines provide clear separation.
      - id: VQ-04
        name: Color Accessibility
        score: 5
        max: 5
        passed: true
        comment: Four distinct color families (blue, yellow, green, red) with varying
          lightness for subcategories; colorblind-friendly differentiation through
          both hue and lightness.
      - id: VQ-05
        name: Layout Balance
        score: 4
        max: 5
        passed: true
        comment: Good overall balance; chart fills most of the canvas; legend is well-positioned
          but slightly far from the chart.
      - id: VQ-07
        name: Grid & Legend
        score: 2
        max: 2
        passed: true
        comment: Legend is comprehensive with shadow box styling; clearly organized
          by department.
    spec_compliance:
      score: 25
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 8
        max: 8
        passed: true
        comment: Correct nested donut chart with two concentric rings.
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: Inner ring shows departments (parent categories), outer ring shows
          expense categories (children); values aggregate correctly.
      - id: SC-03
        name: Required Features
        score: 5
        max: 5
        passed: true
        comment: Consistent color families per department, labels on larger segments,
          legend for smaller ones, spacing between rings via white edges.
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: All data is visible; 4 parent categories with 3 children each (within
          spec's 3-6 parents, 2-5 children).
      - id: SC-05
        name: Legend Accuracy
        score: 2
        max: 2
        passed: true
        comment: 'Legend labels correctly show "Department: Category" format matching
          the data.'
      - id: SC-06
        name: Title Format
        score: 2
        max: 2
        passed: true
        comment: 'Uses correct format: "donut-nested · matplotlib · pyplots.ai".'
    data_quality:
      score: 19
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 7
        max: 8
        passed: true
        comment: 'Shows hierarchy with varying segment sizes; demonstrates aggregation
          from outer to inner rings. Minor: could show more variation in segment sizes
          within departments.'
      - id: DQ-02
        name: Realistic Context
        score: 7
        max: 7
        passed: true
        comment: Budget allocation scenario is realistic and relatable; departments
          and expense categories are plausible business data.
      - id: DQ-03
        name: Appropriate Scale
        score: 5
        max: 5
        passed: true
        comment: Dollar values in thousands (K) are appropriate for budget allocation;
          totals and proportions are sensible.
    code_quality:
      score: 9
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 3
        max: 3
        passed: true
        comment: 'Linear flow: imports → data → colors → figure → inner pie → outer
          pie → labels → legend → save.'
      - id: CQ-02
        name: Reproducibility
        score: 3
        max: 3
        passed: true
        comment: Data is deterministic (hardcoded values, no random generation needed).
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: Only matplotlib.pyplot and numpy are imported, both are used.
      - id: CQ-04
        name: No Deprecated API
        score: 1
        max: 1
        passed: true
        comment: Uses current matplotlib API.
      - id: CQ-05
        name: Output Correct
        score: 0
        max: 1
        passed: false
        comment: Saves as 'plot.png' but figsize is 12x12 (3600x3600 at 300dpi), which
          is correct for square format.
    library_features:
      score: 3
      max: 5
      items:
      - id: LF-01
        name: Uses distinctive library features
        score: 3
        max: 5
        passed: true
        comment: Uses matplotlib's pie() with wedgeprops for donut styling, manual
          text annotation for labels, custom legend with Rectangle patches. Could
          leverage more advanced features like ConnectionPatch for visual linking
          or annotations.
  verdict: APPROVED
