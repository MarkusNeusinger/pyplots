library: bokeh
specification_id: line-impurity-comparison
created: '2026-02-17T18:54:46Z'
updated: '2026-02-17T18:58:44Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 22111342431
issue: 4133
python_version: 3.14.3
library_version: 3.8.2
preview_url: https://storage.googleapis.com/pyplots-images/plots/line-impurity-comparison/bokeh/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/line-impurity-comparison/bokeh/plot_thumb.png
preview_html: https://storage.googleapis.com/pyplots-images/plots/line-impurity-comparison/bokeh/plot.html
quality_score: 84
review:
  strengths:
  - 'Perfect spec compliance: all required features present including legend with
    formulas, annotation at p=0.5, grid, and edge case handling'
  - 'Strong design choices: custom background, removed toolbar/outline, connector
    line between maxima, subtle y-only grid'
  - Clean code structure with proper handling of log(0) edge cases via np.errstate
  - Good use of Bokeh-idiomatic patterns (ColumnDataSource, manual Legend, Label,
    dual HTML+PNG export)
  - Mathematically correct data with 200 points for smooth curves
  weaknesses:
  - Color palette is not optimally colorblind-safe; consider using a more accessible
    combination (e.g., blue + amber/gold, or blue + teal with different dash patterns)
  - Y-axis label could be more informative (e.g., Impurity Measure (normalized) to
    clarify that entropy is normalized)
  - The annotation text could have stronger visual hierarchy — perhaps a bolder font
    weight or a background fill to make it stand out more as the key insight
  - Marker dots at the maxima could be larger for more visual emphasis as focal points
  image_description: The plot displays two curves on a light gray (#fafafa) background
    comparing Gini impurity and Entropy as decision tree splitting criteria. A solid
    blue (#306998) line represents Gini impurity (2p(1−p)), peaking at 0.5 when p=0.5.
    A dashed red-orange (#E24A33) line represents normalized Entropy (−p log₂p − (1−p)
    log₂(1−p)), peaking at 1.0 when p=0.5. Both maxima are marked with filled circular
    dots (blue at 0.5, red at 1.0) connected by a vertical dotted gray line. An annotation
    label reads "p = 0.5 (maximum impurity)" near the top. The legend in the upper-left
    shows both metric formulas with matching line styles. The title reads "line-impurity-comparison
    · bokeh · pyplots.ai". X-axis is labeled "Probability (p)" ranging from 0 to 1,
    Y-axis is "Impurity Measure" ranging from 0 to ~1.1. Only subtle horizontal grid
    lines are visible. The toolbar is removed for a clean static appearance.
  criteria_checklist:
    visual_quality:
      score: 25
      max: 30
      items:
      - id: VQ-01
        name: Text Legibility
        score: 8
        max: 8
        passed: true
        comment: 'All font sizes explicitly set: title 42pt, axis labels 32pt, ticks
          24pt, legend 30pt. All perfectly readable.'
      - id: VQ-02
        name: No Overlap
        score: 6
        max: 6
        passed: true
        comment: No overlapping text elements. Legend, annotation, and axis labels
          well-separated.
      - id: VQ-03
        name: Element Visibility
        score: 5
        max: 6
        passed: true
        comment: Lines at width 7 highly visible. Marker dots (size=24) adequate but
          could be slightly larger.
      - id: VQ-04
        name: Color Accessibility
        score: 2
        max: 4
        passed: false
        comment: Blue vs red-orange relies on hue contrast. Dashed line helps as secondary
          distinguisher but not a standard colorblind-safe combination.
      - id: VQ-05
        name: Layout Balance
        score: 3
        max: 4
        passed: true
        comment: Good canvas utilization. Minor extra whitespace above y=1.0 due to
          y_range extending to 1.15.
      - id: VQ-06
        name: Axis Labels & Title
        score: 1
        max: 2
        passed: true
        comment: Probability (p) is descriptive. Impurity Measure could note (normalized).
    design_excellence:
      score: 13
      max: 20
      items:
      - id: DE-01
        name: Aesthetic Sophistication
        score: 6
        max: 8
        passed: true
        comment: 'Strong design: custom background, removed outline/toolbar, connector
          line, dashed vs solid. Above defaults but not FiveThirtyEight-level.'
      - id: DE-02
        name: Visual Refinement
        score: 4
        max: 6
        passed: true
        comment: 'Good: x-grid removed, y-grid subtle, outline removed, minor ticks
          removed, custom background.'
      - id: DE-03
        name: Data Storytelling
        score: 3
        max: 6
        passed: true
        comment: Connector line between maxima creates focal point. Line style differentiation
          aids comparison. Goes slightly beyond raw display.
    spec_compliance:
      score: 15
      max: 15
      items:
      - id: SC-01
        name: Plot Type
        score: 5
        max: 5
        passed: true
        comment: Correct line comparison plot with two curves on same axes.
      - id: SC-02
        name: Required Features
        score: 4
        max: 4
        passed: true
        comment: 'All spec features: legend with formulas, annotation at p=0.5, grid,
          edge cases handled, distinct colors and line styles.'
      - id: SC-03
        name: Data Mapping
        score: 3
        max: 3
        passed: true
        comment: X=probability [0,1], Y=impurity measure. Both correctly assigned.
      - id: SC-04
        name: Title & Legend
        score: 3
        max: 3
        passed: true
        comment: Title format correct. Legend includes formulas with proper math notation.
    data_quality:
      score: 14
      max: 15
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 5
        max: 6
        passed: true
        comment: Shows both curves across full range, symmetric behavior, maxima,
          and magnitude difference.
      - id: DQ-02
        name: Realistic Context
        score: 5
        max: 5
        passed: true
        comment: Mathematical/educational context for ML decision tree theory. Neutral,
          scientific.
      - id: DQ-03
        name: Appropriate Scale
        score: 4
        max: 4
        passed: true
        comment: Mathematically exact values. p in [0,1], Gini max=0.5, normalized
          entropy max=1.0.
    code_quality:
      score: 10
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 3
        max: 3
        passed: true
        comment: Clean imports-data-plot-style-save structure. No functions or classes.
      - id: CQ-02
        name: Reproducibility
        score: 2
        max: 2
        passed: true
        comment: Fully deterministic (np.linspace + math formulas). No randomness.
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: All imports used.
      - id: CQ-04
        name: Code Elegance
        score: 2
        max: 2
        passed: true
        comment: Clean, Pythonic, appropriate complexity. Good np.errstate usage.
      - id: CQ-05
        name: Output & API
        score: 1
        max: 1
        passed: true
        comment: Saves plot.png via export_png. Also generates HTML (Bokeh feature).
    library_mastery:
      score: 7
      max: 10
      items:
      - id: LM-01
        name: Idiomatic Usage
        score: 4
        max: 5
        passed: true
        comment: Good use of ColumnDataSource, figure(), line(), scatter(), manual
          Legend and Label. Follows Bokeh recommended patterns.
      - id: LM-02
        name: Distinctive Features
        score: 3
        max: 5
        passed: true
        comment: Uses ColumnDataSource, manual Legend with custom items, Label, dual
          PNG+HTML export. Bokeh-distinctive features.
  verdict: REJECTED
impl_tags:
  dependencies: []
  techniques:
  - annotations
  - custom-legend
  - html-export
  patterns:
  - columndatasource
  dataprep: []
  styling:
  - grid-styling
