library: letsplot
specification_id: alluvial-basic
created: '2025-12-26T10:37:09Z'
updated: '2025-12-26T10:39:30Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 20520941938
issue: 1878
python_version: 3.13.11
library_version: 4.8.2
preview_url: https://storage.googleapis.com/pyplots-images/plots/alluvial-basic/letsplot/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/alluvial-basic/letsplot/plot_thumb.png
preview_html: https://storage.googleapis.com/pyplots-images/plots/alluvial-basic/letsplot/plot.html
quality_score: 91
impl_tags:
  dependencies: []
  techniques:
  - layer-composition
  - bezier-curves
  - html-export
  - annotations
  patterns:
  - iteration-over-groups
  dataprep: []
  styling:
  - alpha-blending
review:
  strengths:
  - Excellent choice of realistic voter migration data that perfectly demonstrates
    alluvial diagram use case
  - Clean visual design with good color choices and appropriate transparency for flow
    bands
  - Smooth curved flows using parametric interpolation with easing function
  - Proper dual output (PNG + HTML) leveraging lets-plot interactivity
  - Direct labeling strategy eliminates need for separate legend while maintaining
    clarity
  - Title follows required format exactly
  weaknesses:
  - Helper functions (calculate_node_positions, add_flows) deviate slightly from pure
    KISS flat script style
  - Yellow (Independents) could be more distinguishable from gray (Non-Voters) in
    certain viewing conditions
  image_description: The plot displays an alluvial diagram showing voter migration
    between four political affiliations (Democrats, Republicans, Independents, Non-Voters)
    across three US election cycles (2016, 2020, 2024). Three vertical columns represent
    each election year, with colored rectangular nodes indicating party/voter status.
    Blue represents Democrats (bottom), red for Republicans, yellow for Independents,
    and gray for Non-Voters (top). Curved bands flow between nodes showing voter transitions
    - flows are colored by destination party with ~55% transparency. The left side
    shows party labels, while the right side shows party names with final 2024 totals
    in millions (Democrats 85M, Republicans 78M, Independents 10M, Non-Voters 58M).
    Title follows the required format at top-left.
  criteria_checklist:
    visual_quality:
      score: 36
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 9
        max: 10
        passed: true
        comment: Title, year headers, and party labels are clearly readable. Font
          sizes are appropriate for the canvas size.
      - id: VQ-02
        name: No Overlap
        score: 8
        max: 8
        passed: true
        comment: No overlapping text elements. Labels are well-positioned outside
          the plot area.
      - id: VQ-03
        name: Element Visibility
        score: 7
        max: 8
        passed: true
        comment: Nodes and flows are clearly visible. Flow bands have good alpha (0.55)
          for overlap handling. Some minor flow crossings are hard to trace.
      - id: VQ-04
        name: Color Accessibility
        score: 4
        max: 5
        passed: true
        comment: Blue, red, yellow, gray palette is distinguishable. Red-blue distinction
          works for most colorblind types, though red-green sensitive users may have
          some difficulty with yellow-gray distinction.
      - id: VQ-05
        name: Layout Balance
        score: 5
        max: 5
        passed: true
        comment: Plot fills canvas well, good margins, balanced whitespace.
      - id: VQ-06
        name: Axis Labels
        score: 2
        max: 2
        passed: true
        comment: N/A for alluvial diagrams; party labels and year headers serve this
          purpose and are descriptive with context (values in millions).
      - id: VQ-07
        name: Grid & Legend
        score: 1
        max: 2
        passed: true
        comment: No legend shown (legend_position="none"), but colors are identifiable
          via labels. Grid appropriately hidden for this plot type.
    spec_compliance:
      score: 25
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 8
        max: 8
        passed: true
        comment: Correct alluvial diagram with vertical time ordering and flow bands
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: Time points as columns, categories as nodes, flow magnitudes as band
          widths
      - id: SC-03
        name: Required Features
        score: 5
        max: 5
        passed: true
        comment: Shows transitions across 3 time points, 4 categories, proportional
          band widths
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: All data visible, flows span full range between nodes
      - id: SC-05
        name: Legend Accuracy
        score: 2
        max: 2
        passed: true
        comment: Direct labeling replaces legend effectively
      - id: SC-06
        name: Title Format
        score: 2
        max: 2
        passed: true
        comment: Uses "alluvial-basic · letsplot · pyplots.ai" format correctly
    data_quality:
      score: 18
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 7
        max: 8
        passed: true
        comment: Shows multiple flow directions (retention, migration between parties,
          mobilization from non-voters). Could show more dramatic shifts for variety.
      - id: DQ-02
        name: Realistic Context
        score: 7
        max: 7
        passed: true
        comment: US election voter migration is a perfect, comprehensible real-world
          scenario
      - id: DQ-03
        name: Appropriate Scale
        score: 4
        max: 5
        passed: true
        comment: Values in millions are plausible for US electorate. Some totals seem
          reasonable though exact numbers are illustrative.
    code_quality:
      score: 9
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 2
        max: 3
        passed: true
        comment: Uses helper functions (calculate_node_positions, add_flows) which
          slightly deviates from pure KISS style, but keeps code organized
      - id: CQ-02
        name: Reproducibility
        score: 3
        max: 3
        passed: true
        comment: Deterministic data, no random seed needed (all values hardcoded)
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: All imports are used
      - id: CQ-04
        name: No Deprecated API
        score: 1
        max: 1
        passed: true
        comment: Uses current lets-plot API
      - id: CQ-05
        name: Output Correct
        score: 1
        max: 1
        passed: true
        comment: Saves as plot.png with correct scaling
    library_features:
      score: 3
      max: 5
      items:
      - id: LF-01
        name: Uses distinctive library features
        score: 3
        max: 5
        passed: true
        comment: Uses ggplot grammar with geom_polygon for custom shapes, scale_fill_manual,
          theme customization. However, lets-plot does not have a native alluvial
          geom, so manual polygon construction was necessary. Good use of ggsize and
          ggsave with scale parameter.
  verdict: APPROVED
