library: matplotlib
specification_id: stock-event-flags
created: '2026-01-21T13:17:05Z'
updated: '2026-01-21T13:19:43Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 21210864175
issue: 3749
python_version: 3.13.11
library_version: 3.10.8
preview_url: https://storage.googleapis.com/pyplots-images/plots/stock-event-flags/matplotlib/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/stock-event-flags/matplotlib/plot_thumb.png
preview_html: null
quality_score: 92
review:
  strengths:
  - Excellent flag-style visualization with clean connector lines and colored markers
    at price points
  - Smart use of 3 alternating height levels to prevent flag overlap
  - Good color palette distinguishing event types (blue, green, yellow, crimson)
  - Professional styling with rounded flag boxes, white edges, and subtle area fill
  - Properly formatted title following pyplots.ai convention
  weaknesses:
  - Legend shows only event type colors but omits the Close Price line label that
    is defined in the code
  - Grid and legend could be slightly refined (legend does not match all plotted elements)
  image_description: |-
    The plot displays a stock price chart spanning January 2025 to September 2025, showing approximately 180 trading days of price data. The price line is rendered in Python blue (#306998) with a linewidth of 2.5, starting around $150 and trending down to approximately $120-130 before recovering toward $145 at the end. A light blue fill (alpha 0.1) extends from the minimum price level to the line, creating an area chart effect.

    Nine event flags are positioned above the price data at three alternating height levels to prevent overlap. Each flag is a rounded rectangle with white bold text showing a single-character type indicator (E, D, S, !) followed by a label. The flags are color-coded: blue for earnings (E Q4, E Q1, E Q2), green for dividends (D 0.50, D 0.50, D 0.55), yellow for split (S 2:1), and crimson/red for news (! Launch, ! Interview). Vertical dashed lines connect each flag to a colored circular marker on the price line at the corresponding date.

    The legend in the upper-left shows all four event types with their colors. Axis labels are "Date" (x-axis, fontsize 20) and "Price ($)" (y-axis, fontsize 20). The title follows the required format: "stock-event-flags · matplotlib · pyplots.ai" at fontsize 24. A subtle grid (alpha 0.3, dashed) provides reference. X-axis dates are rotated 30 degrees for readability.
  criteria_checklist:
    visual_quality:
      score: 37
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 10
        max: 10
        passed: true
        comment: Title 24pt, labels 20pt, ticks 16pt, all perfectly readable
      - id: VQ-02
        name: No Overlap
        score: 8
        max: 8
        passed: true
        comment: Flags use alternating heights (3 levels), no overlapping elements
      - id: VQ-03
        name: Element Visibility
        score: 7
        max: 8
        passed: true
        comment: Markers visible (s=100), line width 2.5 good; could be slightly larger
      - id: VQ-04
        name: Color Accessibility
        score: 5
        max: 5
        passed: true
        comment: Blue/green/yellow/red distinguishable; not relying solely on red-green
      - id: VQ-05
        name: Layout Balance
        score: 5
        max: 5
        passed: true
        comment: Plot fills canvas well, good margins, legend positioned well
      - id: VQ-06
        name: Axis Labels
        score: 2
        max: 2
        passed: true
        comment: Price ($) includes units, Date is descriptive
      - id: VQ-07
        name: Grid & Legend
        score: 0
        max: 2
        passed: false
        comment: Legend shows only event types, not the price line label
    spec_compliance:
      score: 23
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 8
        max: 8
        passed: true
        comment: Correct stock chart with event flags
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: Date on X, Price on Y, events correctly positioned
      - id: SC-03
        name: Required Features
        score: 4
        max: 5
        passed: true
        comment: Has flags, connector lines, color-coded event types
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: Y-axis accommodates both price data and flags
      - id: SC-05
        name: Legend Accuracy
        score: 1
        max: 2
        passed: false
        comment: Legend shows event types but not price line label
      - id: SC-06
        name: Title Format
        score: 2
        max: 2
        passed: true
        comment: Uses exact format stock-event-flags · matplotlib · pyplots.ai
    data_quality:
      score: 18
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 7
        max: 8
        passed: true
        comment: Shows all 4 event types; demonstrates price volatility and trend
      - id: DQ-02
        name: Realistic Context
        score: 6
        max: 7
        passed: true
        comment: Plausible tech stock scenario with quarterly earnings, dividends,
          split, news
      - id: DQ-03
        name: Appropriate Scale
        score: 5
        max: 5
        passed: true
        comment: Price range $120-165 realistic for mid-cap stock
    code_quality:
      score: 10
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 3
        max: 3
        passed: true
        comment: Imports → Data → Plot → Save, no functions/classes
      - id: CQ-02
        name: Reproducibility
        score: 3
        max: 3
        passed: true
        comment: np.random.seed(42) set
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: Only necessary imports (matplotlib, numpy, pandas)
      - id: CQ-04
        name: No Deprecated API
        score: 1
        max: 1
        passed: true
        comment: Uses current matplotlib APIs
      - id: CQ-05
        name: Output Correct
        score: 1
        max: 1
        passed: true
        comment: Saves as plot.png
    library_features:
      score: 4
      max: 5
      items:
      - id: LF-01
        name: Distinctive Features
        score: 4
        max: 5
        passed: true
        comment: Good use of ax.annotate with bbox, ax.scatter, mpatches for custom
          legend, fill_between
  verdict: APPROVED
impl_tags:
  dependencies: []
  techniques:
  - annotations
  - custom-legend
  - patches
  patterns:
  - data-generation
  - iteration-over-groups
  dataprep:
  - time-series
  styling:
  - alpha-blending
  - edge-highlighting
  - grid-styling
