library: plotnine
specification_id: hierarchy-toggle-view
created: '2026-01-11T21:04:35Z'
updated: '2026-01-11T21:07:10Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 20901764320
issue: 3697
python_version: 3.13.11
library_version: 0.15.2
preview_url: https://storage.googleapis.com/pyplots-images/plots/hierarchy-toggle-view/plotnine/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/hierarchy-toggle-view/plotnine/plot_thumb.png
preview_html: null
quality_score: 85
review:
  strengths:
  - Excellent dual-view implementation showing both treemap and sunburst representations
    of the same hierarchical data
  - Consistent color mapping between views makes it easy to identify corresponding
    elements
  - 'Good use of plotnine grammar of graphics: geom_rect, geom_polygon, annotations,
    and theme_void'
  - Clean visual design with white borders separating elements
  - Realistic research budget scenario with plausible values
  - Center annotation in sunburst showing total budget is a nice touch
  weaknesses:
  - Specification calls for a toggle mechanism to switch between views, but implementation
    shows both views side-by-side (static); plotnine cannot support interactive toggles
  - Uses helper functions instead of KISS flat structure (build_treemap_data, create_wedge,
    etc.)
  - Sunburst inner ring labels lack budget values while treemap has all values shown
    - should be more consistent
  - Font sizes are adequate but could be slightly larger for better readability at
    full resolution
  image_description: The plot displays a side-by-side visualization of hierarchical
    data representing a "Research Department Budget Allocation." On the left is a
    Treemap View showing nested rectangles in four columns, each representing a main
    division (Biology - blue, Chemistry - yellow, Physics - green, Computing - orange).
    Within each column, subdepartments are stacked vertically with labels and budget
    values (e.g., "Genetics $150K", "Organic $130K"). On the right is a Sunburst View
    showing the same data as concentric rings - an inner ring with four major divisions
    (Biology, Chemistry, Physics, Computing) and an outer ring with their subdepartments.
    The center displays "Total $1370K". Colors are consistent across both views. The
    main title reads "hierarchy-toggle-view 路 plotnine 路 pyplots.ai" with a subtitle
    "Research Department Budget Allocation". View titles "Treemap View" and "Sunburst
    View" appear above each visualization.
  criteria_checklist:
    visual_quality:
      score: 34
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 8
        max: 10
        passed: true
        comment: Text is readable but slightly small for the canvas size; font sizes
          could be larger
      - id: VQ-02
        name: No Overlap
        score: 8
        max: 8
        passed: true
        comment: No overlapping text; all labels are clearly positioned
      - id: VQ-03
        name: Element Visibility
        score: 6
        max: 8
        passed: true
        comment: Elements are visible but rectangles and wedges could use more spacing/padding
      - id: VQ-04
        name: Color Accessibility
        score: 5
        max: 5
        passed: true
        comment: Uses colorblind-safe palette (blue, yellow, green, orange)
      - id: VQ-05
        name: Layout Balance
        score: 5
        max: 5
        passed: true
        comment: Good use of canvas with both views side-by-side, well balanced
      - id: VQ-06
        name: Axis Labels
        score: 0
        max: 2
        passed: false
        comment: N/A for this plot type (no axes)
      - id: VQ-07
        name: Grid & Legend
        score: 2
        max: 2
        passed: true
        comment: Clean void theme, no distracting grid; legend not needed as labels
          are on shapes
    spec_compliance:
      score: 20
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 6
        max: 8
        passed: true
        comment: Shows both treemap and sunburst views, but no actual toggle mechanism
          (static side-by-side instead of interactive toggle)
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: Values correctly mapped to areas (treemap) and angles (sunburst)
      - id: SC-03
        name: Required Features
        score: 3
        max: 5
        passed: false
        comment: 'Missing: toggle button/switch, animated transitions, hover state
          preservation'
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: All data shown with appropriate range
      - id: SC-05
        name: Legend Accuracy
        score: 1
        max: 2
        passed: false
        comment: Labels on shapes but treemap shows values while sunburst labels are
          inconsistent
      - id: SC-06
        name: Title Format
        score: 2
        max: 2
        passed: true
        comment: 'Correct format: hierarchy-toggle-view 路 plotnine 路 pyplots.ai'
    data_quality:
      score: 18
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 7
        max: 8
        passed: true
        comment: Shows hierarchy with 2 levels, 4 categories, different value distributions
      - id: DQ-02
        name: Realistic Context
        score: 7
        max: 7
        passed: true
        comment: Research department budget is a realistic, neutral scenario
      - id: DQ-03
        name: Appropriate Scale
        score: 4
        max: 5
        passed: true
        comment: Budget values are plausible ($70K-$200K range)
    code_quality:
      score: 8
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 1
        max: 3
        passed: false
        comment: Uses helper functions (build_treemap_data, create_wedge, build_sunburst_data,
          build_sunburst_labels)
      - id: CQ-02
        name: Reproducibility
        score: 3
        max: 3
        passed: true
        comment: Deterministic data (no random seed needed, hardcoded values)
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: All imports are used
      - id: CQ-04
        name: No Deprecated API
        score: 1
        max: 1
        passed: true
        comment: Modern plotnine API
      - id: CQ-05
        name: Output Correct
        score: 1
        max: 1
        passed: true
        comment: Saves as plot.png
    library_features:
      score: 5
      max: 5
      items:
      - id: LF-01
        name: Distinctive Features
        score: 5
        max: 5
        passed: true
        comment: 'Excellent use of plotnine grammar: geom_rect for treemap, geom_polygon
          for sunburst wedges, scale_fill_identity, theme_void, annotations'
  verdict: REJECTED
impl_tags:
  dependencies: []
  techniques:
  - annotations
  - patches
  - layer-composition
  patterns:
  - data-generation
  - iteration-over-groups
  dataprep: []
  styling:
  - minimal-chrome
  - edge-highlighting
