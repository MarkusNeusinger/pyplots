library: bokeh
specification_id: flowmap-origin-destination
created: '2026-01-16T08:06:03Z'
updated: '2026-01-16T08:08:37Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 21059785728
issue: 3765
python_version: 3.13.11
library_version: 3.8.2
preview_url: https://storage.googleapis.com/pyplots-images/plots/flowmap-origin-destination/bokeh/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/flowmap-origin-destination/bokeh/plot_thumb.png
preview_html: https://storage.googleapis.com/pyplots-images/plots/flowmap-origin-destination/bokeh/plot.html
quality_score: 91
review:
  strengths:
  - Excellent use of Bokeh tile provider for geographic basemap
  - Bezier curves create smooth, visually appealing flow arcs
  - Color gradient effectively encodes flow magnitude
  - Interactive features (hover tooltips, pan, zoom) enhance usability
  - Proper Web Mercator projection for map tiles
  weaknesses:
  - Uses helper functions instead of inline code (minor KISS violation)
  - Uses deprecated string-based tile provider API
  - Flow arcs lack hover tooltips (only ports have them)
  image_description: The plot displays an origin-destination flow map showing trade
    routes between major world ports overlaid on a CartoDB Positron basemap. The map
    uses Web Mercator projection and shows curved Bezier arcs connecting 10 port cities
    across the globe (Shanghai, Singapore, Rotterdam, Los Angeles, Dubai, Hong Kong,
    Hamburg, New York, Tokyo, Sydney). Arc colors transition from dark blue/gray to
    yellow based on flow magnitude, with line thickness proportional to trade volume.
    Port locations are marked with blue circular markers. The title "flowmap-origin-destination
    路 bokeh 路 pyplots.ai" appears in the top-left corner. Axes show "Longitude" and
    "Latitude" labels with Mercator coordinate values. A legend labeled "Ports" appears
    in the top-left area. The map covers roughly -180 to 200 longitude and displays
    the full global extent with proper geographic context.
  criteria_checklist:
    visual_quality:
      score: 36
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 8
        max: 10
        passed: true
        comment: Title and axis labels readable but tick labels appear somewhat small
      - id: VQ-02
        name: No Overlap
        score: 8
        max: 8
        passed: true
        comment: No overlapping text elements, arcs overlap appropriately with transparency
      - id: VQ-03
        name: Element Visibility
        score: 8
        max: 8
        passed: true
        comment: Arc thickness varies with flow magnitude, port markers clearly visible
      - id: VQ-04
        name: Color Accessibility
        score: 5
        max: 5
        passed: true
        comment: Blue-to-yellow gradient is colorblind-safe
      - id: VQ-05
        name: Layout Balance
        score: 5
        max: 5
        passed: true
        comment: Map fills canvas well with balanced margins
      - id: VQ-06
        name: Axis Labels
        score: 1
        max: 2
        passed: true
        comment: Labels say Longitude and Latitude but no units
      - id: VQ-07
        name: Grid & Legend
        score: 1
        max: 2
        passed: true
        comment: Legend present but minimal; basemap provides geographic context
    spec_compliance:
      score: 25
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 8
        max: 8
        passed: true
        comment: Correct origin-destination flow map with curved arcs
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: Origin/destination coordinates correctly mapped, flow magnitude encoded
          in thickness
      - id: SC-03
        name: Required Features
        score: 5
        max: 5
        passed: true
        comment: Bezier arcs, proportional width, transparency, basemap, hover tooltips
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: All flows visible, map extent appropriate
      - id: SC-05
        name: Legend Accuracy
        score: 2
        max: 2
        passed: true
        comment: Legend correctly identifies port markers
      - id: SC-06
        name: Title Format
        score: 2
        max: 2
        passed: true
        comment: Uses correct format flowmap-origin-destination 路 bokeh 路 pyplots.ai
    data_quality:
      score: 18
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 8
        max: 8
        passed: true
        comment: Shows multiple flow magnitudes, bidirectional flows, varied geographic
          distances
      - id: DQ-02
        name: Realistic Context
        score: 5
        max: 7
        passed: true
        comment: Trade flows between major ports is plausible but values are fictional
      - id: DQ-03
        name: Appropriate Scale
        score: 5
        max: 5
        passed: true
        comment: 18 flows with magnitudes 260-850 represent reasonable trade volumes
    code_quality:
      score: 8
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 2
        max: 3
        passed: true
        comment: Has helper functions for coordinate conversion and Bezier curves
      - id: CQ-02
        name: Reproducibility
        score: 3
        max: 3
        passed: true
        comment: Uses np.random.seed(42)
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: All imports are used
      - id: CQ-04
        name: No Deprecated API
        score: 0
        max: 1
        passed: false
        comment: Uses deprecated string-based tile provider add_tile()
      - id: CQ-05
        name: Output Correct
        score: 1
        max: 1
        passed: true
        comment: Saves as plot.png and plot.html
    library_features:
      score: 4
      max: 5
      items:
      - id: LF-01
        name: Distinctive Features
        score: 4
        max: 5
        passed: true
        comment: Uses Bokeh tile providers, ColumnDataSource, HoverTool, Web Mercator
          projection, HTML export
  verdict: APPROVED
impl_tags:
  dependencies: []
  techniques:
  - bezier-curves
  - hover-tooltips
  - html-export
  patterns:
  - data-generation
  - columndatasource
  - iteration-over-groups
  dataprep: []
  styling:
  - alpha-blending
  - custom-colormap
