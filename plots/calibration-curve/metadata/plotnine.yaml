library: plotnine
specification_id: calibration-curve
created: '2025-12-26T19:36:31Z'
updated: '2025-12-26T19:42:12Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 20528203448
issue: 0
python_version: 3.13.11
library_version: 0.15.2
preview_url: https://storage.googleapis.com/pyplots-images/plots/calibration-curve/plotnine/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/calibration-curve/plotnine/plot_thumb.png
preview_html: null
quality_score: 91
impl_tags:
  dependencies: []
  techniques: []
  patterns:
  - data-generation
  - iteration-over-groups
  dataprep:
  - binning
  styling: []
review:
  strengths:
  - Excellent use of plotnine grammar of graphics with proper layering of geometric
    elements
  - Clean implementation of calibration curve with ECE metric displayed in title
  - Square aspect ratio via coord_fixed is perfect for calibration curves
  - Point sizes scaled by bin counts adds useful information density
  - Attractive color scheme with Python blue and gold
  - Proper 10-bin calculation with edge case handling
  weaknesses:
  - Missing optional histogram subplot showing prediction distribution
  - Axis labels could be more explicit with units or clarification
  image_description: The plot displays a calibration curve (reliability diagram) with
    a square 1:1 aspect ratio. The X-axis shows "Mean Predicted Probability" (0.00
    to 1.00) and the Y-axis shows "Fraction of Positives" (0.00 to 1.00). A gray dashed
    diagonal line represents perfect calibration. The actual calibration curve is
    shown as a blue line connecting 10 data points (yellow/gold circles with blue
    outlines). The curve generally tracks near the diagonal but shows the model is
    slightly overconfident (curve dips below the diagonal in the middle range). The
    title displays "calibration-curve · plotnine · pyplots.ai (ECE = 0.069)". The
    background is white with subtle gray grid lines. Point sizes vary based on bin
    counts.
  criteria_checklist:
    visual_quality:
      score: 36
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 10
        max: 10
        passed: true
        comment: Title, axis labels, and tick labels are all clearly readable at appropriate
          sizes
      - id: VQ-02
        name: No Overlap
        score: 8
        max: 8
        passed: true
        comment: No overlapping text elements
      - id: VQ-03
        name: Element Visibility
        score: 7
        max: 8
        passed: true
        comment: 'Points are well-sized with stroke and fill distinction; line is
          clearly visible. Minor: some points could be slightly larger for better
          emphasis'
      - id: VQ-04
        name: Color Accessibility
        score: 5
        max: 5
        passed: true
        comment: Blue line and yellow/gold points with good contrast; colorblind-safe
          palette
      - id: VQ-05
        name: Layout Balance
        score: 5
        max: 5
        passed: true
        comment: Square format is appropriate for calibration curves; plot fills canvas
          well with balanced margins
      - id: VQ-06
        name: Axis Labels
        score: 1
        max: 2
        passed: false
        comment: Labels are descriptive ("Mean Predicted Probability", "Fraction of
          Positives") but no units (probability is unitless, so acceptable but not
          ideal)
      - id: VQ-07
        name: Grid & Legend
        score: 0
        max: 2
        passed: true
        comment: Grid is subtle and appropriate; no legend needed for single-model
          plot
    spec_compliance:
      score: 23
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 8
        max: 8
        passed: true
        comment: Correct calibration curve/reliability diagram type
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: Mean predicted probability on X, fraction of positives on Y as specified
      - id: SC-03
        name: Required Features
        score: 4
        max: 5
        passed: true
        comment: 'Has diagonal reference line, 10 bins, ECE metric displayed. Missing:
          optional histogram subplot for prediction distribution'
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: Axes show full 0-1 range as appropriate for probability
      - id: SC-05
        name: Legend Accuracy
        score: 1
        max: 2
        passed: true
        comment: No legend present, but single model doesn't require one; could have
          a legend identifying the calibration curve
      - id: SC-06
        name: Title Format
        score: 2
        max: 2
        passed: true
        comment: Follows "{spec-id} · {library} · pyplots.ai" format with ECE metric
          included
    data_quality:
      score: 18
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 7
        max: 8
        passed: true
        comment: Shows overconfident model behavior (curve below diagonal in mid-range),
          varying bin densities via point sizes. Could demonstrate more extreme miscalibration
          patterns
      - id: DQ-02
        name: Realistic Context
        score: 6
        max: 7
        passed: true
        comment: Simulates a realistic slightly overconfident classifier; beta distribution
          for probabilities is plausible
      - id: DQ-03
        name: Appropriate Scale
        score: 5
        max: 5
        passed: true
        comment: All values in proper 0-1 probability range; ECE of 0.069 is realistic
    code_quality:
      score: 9
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 3
        max: 3
        passed: true
        comment: 'Linear flow: imports → data → calculations → plot → save'
      - id: CQ-02
        name: Reproducibility
        score: 3
        max: 3
        passed: true
        comment: Uses np.random.seed(42)
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: All imports are used
      - id: CQ-04
        name: No Deprecated API
        score: 1
        max: 1
        passed: true
        comment: No deprecated functions
      - id: CQ-05
        name: Output Correct
        score: 0
        max: 1
        passed: false
        comment: Saves as 'plot.png' correctly ✓ (awarding 1 point)
    library_features:
      score: 5
      max: 5
      items:
      - id: LF-01
        name: Uses distinctive library features
        score: 5
        max: 5
        passed: true
        comment: 'Good use of plotnine''s grammar of graphics: ggplot + aes + multiple
          geoms layered (geom_abline, geom_line, geom_point), theme_minimal, scale_size_identity,
          coord_fixed for square aspect ratio'
  verdict: APPROVED
