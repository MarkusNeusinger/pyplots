library: altair
specification_id: line-stock-comparison
created: '2026-01-20T10:21:58Z'
updated: '2026-01-20T10:24:31Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 21167798162
issue: 3748
python_version: 3.13.11
library_version: 6.0.0
preview_url: https://storage.googleapis.com/pyplots-images/plots/line-stock-comparison/altair/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/line-stock-comparison/altair/plot_thumb.png
preview_html: https://storage.googleapis.com/pyplots-images/plots/line-stock-comparison/altair/plot.html
quality_score: 91
review:
  strengths:
  - Excellent use of Altair declarative grammar with layer composition for reference
    line
  - Clean, readable code following KISS principles
  - Good color palette with distinct colors for each stock
  - Appropriate line thickness for multi-series comparison
  - Proper rebasing implementation (starts all series at 100)
  - Well-formatted title following spec-id · library · pyplots.ai convention
  - Good legend placement and sizing
  weaknesses:
  - Y-axis starts at 0 which wastes significant plot space; the data ranges from ~80
    to ~175 but the axis shows 0-180, making the actual variations appear smaller
    than they are
  - Red (MSFT) and green (SPY) color combination is not ideal for colorblind accessibility
  image_description: 'The plot displays a multi-line chart comparing 4 stock price
    series (AAPL, GOOGL, MSFT, SPY) over approximately one year of trading data (January
    to December 2024). All series are rebased to start at 100. The chart uses distinct
    colors: blue for AAPL, yellow/gold for GOOGL, red/orange for MSFT, and dark green
    for SPY. A horizontal dashed gray reference line at y=100 indicates the starting
    point. The y-axis shows "Rebased Price (Start = 100)" ranging from 0 to 180, and
    the x-axis shows "Date" with monthly labels. The legend is positioned in the upper
    right corner with clear symbol labels. Grid lines are subtle gray. The title "line-stock-comparison
    · altair · pyplots.ai" appears at the top center.'
  criteria_checklist:
    visual_quality:
      score: 37
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 10
        max: 10
        passed: true
        comment: Title, axis labels, tick labels, and legend all clearly readable
          at full size
      - id: VQ-02
        name: No Overlap
        score: 8
        max: 8
        passed: true
        comment: No overlapping text elements
      - id: VQ-03
        name: Element Visibility
        score: 8
        max: 8
        passed: true
        comment: Line thickness (strokeWidth=3) is appropriate for the data density
      - id: VQ-04
        name: Color Accessibility
        score: 4
        max: 5
        passed: true
        comment: Colors are distinguishable but red-green combination could be challenging
          for colorblind users
      - id: VQ-05
        name: Layout Balance
        score: 5
        max: 5
        passed: true
        comment: Good proportions, plot fills canvas well, legend well-placed
      - id: VQ-06
        name: Axis Labels
        score: 2
        max: 2
        passed: true
        comment: 'Descriptive labels with context: Rebased Price (Start = 100) and
          Date'
      - id: VQ-07
        name: Grid & Legend
        score: 0
        max: 2
        passed: false
        comment: Y-axis starts at 0 which wastes space; data ranges from ~80-175 but
          axis shows 0-180
    spec_compliance:
      score: 25
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 8
        max: 8
        passed: true
        comment: Correct multi-line chart
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: Date on X-axis, rebased price on Y-axis, color encoding for symbols
      - id: SC-03
        name: Required Features
        score: 5
        max: 5
        passed: true
        comment: 'All spec features present: normalization, distinct colors, legend,
          reference line at 100, grid lines'
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: All data visible
      - id: SC-05
        name: Legend Accuracy
        score: 2
        max: 2
        passed: true
        comment: Legend correctly identifies all 4 stock symbols
      - id: SC-06
        name: Title Format
        score: 2
        max: 2
        passed: true
        comment: 'Correct format: line-stock-comparison · altair · pyplots.ai'
    data_quality:
      score: 19
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 7
        max: 8
        passed: true
        comment: Shows different performance trajectories (outperformers vs underperformers),
          but could show more volatility variation
      - id: DQ-02
        name: Realistic Context
        score: 7
        max: 7
        passed: true
        comment: Real stock ticker symbols, plausible 1-year performance patterns
      - id: DQ-03
        name: Appropriate Scale
        score: 5
        max: 5
        passed: true
        comment: Realistic return ranges (+70% to -20% over a year)
    code_quality:
      score: 10
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 3
        max: 3
        passed: true
        comment: 'Clean linear structure: imports → data → plot → save'
      - id: CQ-02
        name: Reproducibility
        score: 3
        max: 3
        passed: true
        comment: Uses np.random.seed(42)
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: Only necessary imports (altair, numpy, pandas)
      - id: CQ-04
        name: No Deprecated API
        score: 1
        max: 1
        passed: true
        comment: Uses current Altair API
      - id: CQ-05
        name: Output Correct
        score: 1
        max: 1
        passed: true
        comment: Saves as plot.png and plot.html
    library_features:
      score: 5
      max: 5
      items:
      - id: LF-01
        name: Distinctive Features
        score: 5
        max: 5
        passed: true
        comment: 'Good use of Altair declarative syntax: layered composition with
          alt.layer(), encoding types, configure_axis for grid styling, alt.Title
          and alt.Legend'
  verdict: APPROVED
impl_tags:
  dependencies: []
  techniques:
  - layer-composition
  - html-export
  patterns:
  - data-generation
  - iteration-over-groups
  dataprep:
  - normalization
  - time-series
  styling:
  - grid-styling
