library: matplotlib
specification_id: heatmap-clustered
created: '2025-12-25T19:20:03Z'
updated: '2025-12-25T19:22:42Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 20509770742
issue: 2021
python_version: 3.13.11
library_version: 3.10.8
preview_url: https://storage.googleapis.com/pyplots-images/plots/heatmap-clustered/matplotlib/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/heatmap-clustered/matplotlib/plot_thumb.png
preview_html: null
quality_score: 92
review:
  strengths:
  - Excellent realistic gene expression data scenario with proper biological context
    (tumor vs. normal, functional gene groups)
  - Clean implementation of clustered heatmap using scipy hierarchical clustering
    with Ward's method
  - Proper use of diverging colormap (RdBu_r) centered on zero for expression data
  - Well-organized code with gridspec for professional dendrogram + heatmap layout
  - Clear visual distinction between sample groups and gene clusters in the final
    visualization
  weaknesses:
  - Missing explicit x-axis and y-axis labels (could add Samples and Genes labels)
  - Could add row/column color bars to annotate gene functional groups and sample
    types as suggested in spec
  - Tick label fontsize (14pt) slightly below the recommended 16pt for optimal legibility
    at full resolution
  image_description: The plot displays a clustered heatmap showing gene expression
    data across 15 genes and 12 samples. The title "heatmap-clustered · matplotlib
    · pyplots.ai" appears at the top in clear, readable font. A row dendrogram on
    the left shows hierarchical clustering of genes (IL6, TNF, IFNG, IL1B, CXCL8 grouped
    together as immune genes; CCNB1, AURKA, BUB1, CDK1, PLK1 clustered as cell cycle
    genes; LDHA, HK2, PKM, GAPDH, ENO1 clustered as metabolism genes). A column dendrogram
    on top shows sample clustering with normal samples (N1_B, N1_A, N1_C, N2_B, N2_A,
    N2_C) on the left and tumor samples (T2_A, T2_B, T2_C, T1_C, T1_A, T1_B) on the
    right. The heatmap uses a diverging RdBu_r colormap with red indicating high expression
    (~+2.5 z-score) and blue indicating low expression (~-2.5 z-score). A colorbar
    on the right is labeled "Expression (z-score)". The clustering clearly reveals
    the tumor vs. normal distinction and gene functional groupings.
  criteria_checklist:
    visual_quality:
      score: 36
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 9
        max: 10
        passed: true
        comment: All text is readable; title 24pt, tick labels 14pt are slightly below
          recommended 16pt but still clear
      - id: VQ-02
        name: No Overlap
        score: 8
        max: 8
        passed: true
        comment: No overlapping text; X-axis labels rotated 45° to prevent collision
      - id: VQ-03
        name: Element Visibility
        score: 8
        max: 8
        passed: true
        comment: Heatmap cells clearly visible with good contrast between values
      - id: VQ-04
        name: Color Accessibility
        score: 5
        max: 5
        passed: true
        comment: RdBu_r is an excellent diverging colormap, colorblind-safe
      - id: VQ-05
        name: Layout Balance
        score: 4
        max: 5
        passed: true
        comment: Good layout with gridspec; slight imbalance with empty corner space
      - id: VQ-06
        name: Axis Labels
        score: 1
        max: 2
        passed: true
        comment: Gene and sample names are descriptive but no explicit axis titles
          (x/y labels)
      - id: VQ-07
        name: Grid & Legend
        score: 1
        max: 2
        passed: true
        comment: 'Colorbar well placed; no grid needed for heatmap; minor: colorbar
          could be more prominent'
    spec_compliance:
      score: 25
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 8
        max: 8
        passed: true
        comment: 'Correct: clustered heatmap with dendrograms'
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: Matrix correctly mapped to heatmap cells
      - id: SC-03
        name: Required Features
        score: 5
        max: 5
        passed: true
        comment: 'All features present: dendrograms on both axes, reordered rows/columns,
          diverging colormap, colorbar'
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: Symmetric color scale around zero shows all data properly
      - id: SC-05
        name: Legend Accuracy
        score: 2
        max: 2
        passed: true
        comment: Colorbar correctly labeled with z-score
      - id: SC-06
        name: Title Format
        score: 2
        max: 2
        passed: true
        comment: 'Correct format: "heatmap-clustered · matplotlib · pyplots.ai"'
    data_quality:
      score: 18
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 7
        max: 8
        passed: true
        comment: Shows clear cluster structure with multiple gene clusters and sample
          groups; could benefit from more diverse expression patterns
      - id: DQ-02
        name: Realistic Context
        score: 7
        max: 7
        passed: true
        comment: 'Excellent: real gene names (CDK1, GAPDH, IL6, etc.) with tumor vs.
          normal comparison is a classic bioinformatics use case'
      - id: DQ-03
        name: Appropriate Scale
        score: 4
        max: 5
        passed: true
        comment: Z-scores in reasonable range (-2.5 to +2.5); slightly engineered
          block patterns
    code_quality:
      score: 10
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 3
        max: 3
        passed: true
        comment: 'Clean linear structure: imports → data → clustering → plot → save'
      - id: CQ-02
        name: Reproducibility
        score: 3
        max: 3
        passed: true
        comment: np.random.seed(42) ensures reproducibility
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: All imports used (matplotlib, numpy, scipy.cluster.hierarchy, scipy.spatial.distance)
      - id: CQ-04
        name: No Deprecated API
        score: 1
        max: 1
        passed: true
        comment: Uses current matplotlib and scipy APIs
      - id: CQ-05
        name: Output Correct
        score: 1
        max: 1
        passed: true
        comment: Saves as plot.png with correct settings
    library_features:
      score: 3
      max: 5
      items:
      - id: LF-01
        name: Distinctive Features
        score: 3
        max: 5
        passed: true
        comment: Uses matplotlib's gridspec for complex layout and scipy for clustering;
          could leverage matplotlib's more advanced features like color bars for row/column
          annotations
  verdict: APPROVED
