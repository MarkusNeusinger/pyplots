library: altair
specification_id: heatmap-geographic
created: '2026-01-10T08:16:12Z'
updated: '2026-01-10T08:18:56Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 20875420007
issue: 3638
python_version: 3.13.11
library_version: 6.0.0
preview_url: https://storage.googleapis.com/pyplots-images/plots/heatmap-geographic/altair/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/heatmap-geographic/altair/plot_thumb.png
preview_html: https://storage.googleapis.com/pyplots-images/plots/heatmap-geographic/altair/plot.html
quality_score: 91
review:
  strengths:
  - Excellent use of Altair geographic capabilities with topo_feature for basemap
  - Well-implemented density visualization using size+color encoding with transparency
  - Good use of interactive tooltips showing lat/lon/value
  - Clean, readable code following KISS principles
  - Realistic European city data with proper geographic coordinates
  - Inferno colormap provides good contrast and colorblind accessibility
  weaknesses:
  - Title format includes extra descriptive text before the required format
  - Does not use true KDE (kernel density estimation) as suggested in spec - uses
    circle overlay approach instead
  - Some rural points at lower density are quite small and harder to see
  image_description: The plot displays a geographic heatmap of European activity density.
    It features a light gray basemap showing country boundaries of Europe, the Middle
    East, and parts of North Africa. Overlaid are semi-transparent circles of varying
    sizes representing data points. The circles use the "inferno" colormap ranging
    from dark purple (low intensity ~0) through magenta/pink to yellow/cream (high
    intensity ~30). Major European cities like London, Paris, Berlin, Madrid, Rome,
    and others are visible as clusters of larger, brighter circles indicating higher
    density. Scattered smaller, darker circles represent rural points across the continent.
    A vertical colorbar legend on the right shows "Intensity" values from 0-30. The
    title "European Activity Density · heatmap-geographic · altair · pyplots.ai" is
    centered at the top.
  criteria_checklist:
    visual_quality:
      score: 36
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 10
        max: 10
        passed: true
        comment: Title at 28pt is clearly readable, legend title at 18pt and labels
          at 14pt are well-sized
      - id: VQ-02
        name: No Overlap
        score: 8
        max: 8
        passed: true
        comment: No overlapping text elements
      - id: VQ-03
        name: Element Visibility
        score: 7
        max: 8
        passed: true
        comment: Circles are well-sized with opacity=0.5 creating good heatmap effect;
          some smaller rural points could be slightly larger
      - id: VQ-04
        name: Color Accessibility
        score: 5
        max: 5
        passed: true
        comment: Inferno colormap is colorblind-safe sequential palette
      - id: VQ-05
        name: Layout Balance
        score: 4
        max: 5
        passed: true
        comment: Good canvas utilization with map centered; slight excess white space
          on edges due to geographic projection
      - id: VQ-06
        name: Axis Labels
        score: 0
        max: 2
        passed: false
        comment: Geographic maps do not use traditional axis labels; no lat/lon scale
          provided
      - id: VQ-07
        name: Grid & Legend
        score: 2
        max: 2
        passed: true
        comment: Colorbar well-placed on right, appropriate size
    spec_compliance:
      score: 23
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 8
        max: 8
        passed: true
        comment: Correct geographic heatmap using circles with size+color encoding
          for density
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: Latitude, longitude, and value correctly mapped
      - id: SC-03
        name: Required Features
        score: 4
        max: 5
        passed: true
        comment: Has basemap, colorbar, transparency; uses circle overlay instead
          of KDE but effectively shows density
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: All data visible within the projection
      - id: SC-05
        name: Legend Accuracy
        score: 2
        max: 2
        passed: true
        comment: Intensity legend correctly shows 0-30 scale
      - id: SC-06
        name: Title Format
        score: 1
        max: 2
        passed: false
        comment: Title includes spec-id, library, and pyplots.ai but has extra descriptive
          prefix
    data_quality:
      score: 19
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 8
        max: 8
        passed: true
        comment: Shows urban clusters (high density), rural scattered points (low
          density), and variation in intensity values
      - id: DQ-02
        name: Realistic Context
        score: 7
        max: 7
        passed: true
        comment: European activity density is a neutral, plausible scenario with recognizable
          city locations
      - id: DQ-03
        name: Appropriate Scale
        score: 4
        max: 5
        passed: true
        comment: Intensity values 0-30 are reasonable; coordinates match actual European
          city locations
    code_quality:
      score: 10
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 3
        max: 3
        passed: true
        comment: 'Clean linear flow: imports → data generation → basemap → heatmap
          → combine → save'
      - id: CQ-02
        name: Reproducibility
        score: 3
        max: 3
        passed: true
        comment: Uses np.random.seed(42)
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: Only altair, numpy, pandas imported
      - id: CQ-04
        name: No Deprecated API
        score: 1
        max: 1
        passed: true
        comment: Uses current Altair API
      - id: CQ-05
        name: Output Correct
        score: 1
        max: 1
        passed: true
        comment: Saves as plot.png and plot.html
    library_features:
      score: 3
      max: 5
      items:
      - id: LF-01
        name: Distinctive Features
        score: 3
        max: 5
        passed: true
        comment: Uses Altair geographic projection with topo_feature, layer composition,
          and interactive tooltips; could leverage more declarative features
  verdict: APPROVED
impl_tags:
  dependencies: []
  techniques:
  - layer-composition
  - hover-tooltips
  - html-export
  patterns:
  - data-generation
  - iteration-over-groups
  dataprep: []
  styling:
  - custom-colormap
  - alpha-blending
