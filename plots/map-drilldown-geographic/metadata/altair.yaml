library: altair
specification_id: map-drilldown-geographic
created: '2026-01-20T07:44:04Z'
updated: '2026-01-20T07:53:28Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 21163297410
issue: 3770
python_version: 3.13.11
library_version: 6.0.0
preview_url: https://storage.googleapis.com/pyplots-images/plots/map-drilldown-geographic/altair/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/map-drilldown-geographic/altair/plot_thumb.png
preview_html: https://storage.googleapis.com/pyplots-images/plots/map-drilldown-geographic/altair/plot.html
quality_score: 86
review:
  strengths:
  - Excellent use of Altair selection_point for cross-filtering between bar chart
    and map
  - Clean implementation of US TopoJSON with transform_lookup for data joining
  - Well-designed sidebar layout with region overview and state detail panels
  - Professional color scheme using colorblind-safe categorical palette
  - Proper breadcrumb-style navigation hint in chart titles
  weaknesses:
  - States appear gray in default/static view - choropleth color encoding only activates
    when region is selected. For static PNG export, map should show colors by default
  - The conditional color encoding uses empty=False which means nothing is highlighted
    initially. Consider using empty=True or having default selection so static image
    shows actual data
  - Breadcrumb navigation is display-only, not truly interactive for navigating back
    up hierarchy
  image_description: 'The visualization displays a US choropleth map with drill-down
    capability. The main title "map-drilldown-geographic ¬∑ altair ¬∑ pyplots.ai" appears
    at the top with subtitles explaining the interaction. The left side shows a US
    map rendered via TopoJSON with all 50 states visible in gray (no region selected).
    A vertical blue color scale legend labeled "Sales ($K)" ranging from 0-500 is
    positioned at bottom-left. On the right sidebar: a horizontal bar chart titled
    "üìç USA > Click a Region to Drill Down" displays 4 regions (South ~3200K, West
    ~1700K, Midwest ~1400K, Northeast ~1300K) with gray bars (unselected). A horizontal
    color legend shows region colors (West=blue, South=red, Midwest=green, Northeast=yellow).
    Below is an empty "üìä States in Selected Region" panel with placeholder text "‚Üê
    Click a region bar to view states". White borders separate states clearly. Overall
    proportions are balanced with the map occupying roughly 60% of the canvas width.'
  criteria_checklist:
    visual_quality:
      score: 36
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 9
        max: 10
        passed: true
        comment: Title at 28pt excellent, labels at 14-16pt good but could be slightly
          larger
      - id: VQ-02
        name: No Overlap
        score: 8
        max: 8
        passed: true
        comment: All text elements clearly separated, no overlap issues
      - id: VQ-03
        name: Element Visibility
        score: 7
        max: 8
        passed: true
        comment: Map and bars clearly visible, though states lack color encoding in
          default view
      - id: VQ-04
        name: Color Accessibility
        score: 5
        max: 5
        passed: true
        comment: Colorblind-safe palette (blue, red, green, yellow) for regions
      - id: VQ-05
        name: Layout Balance
        score: 4
        max: 5
        passed: false
        comment: Good layout but map shows gray states in default view, wasting visual
          space
      - id: VQ-06
        name: Axis Labels
        score: 2
        max: 2
        passed: true
        comment: 'Labels include units: Sales ($K), Total Sales ($K)'
      - id: VQ-07
        name: Grid & Legend
        score: 1
        max: 2
        passed: true
        comment: Legend well placed, no grid on bar charts (acceptable for this design)
    spec_compliance:
      score: 20
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 8
        max: 8
        passed: true
        comment: Correct choropleth map with drill-down hierarchy
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: Region/state/value correctly mapped
      - id: SC-03
        name: Required Features
        score: 2
        max: 5
        passed: false
        comment: 'Missing: breadcrumb not clickable, states should show color in default
          view'
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: All data visible, color scale covers 0-550 range
      - id: SC-05
        name: Legend Accuracy
        score: 2
        max: 2
        passed: true
        comment: Region colors and sales legend accurate
      - id: SC-06
        name: Title Format
        score: 2
        max: 2
        passed: true
        comment: 'Correct format: map-drilldown-geographic ¬∑ altair ¬∑ pyplots.ai'
    data_quality:
      score: 18
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 6
        max: 8
        passed: true
        comment: Shows regional aggregation and state detail concept, but default
          view doesn't demonstrate choropleth coloring
      - id: DQ-02
        name: Realistic Context
        score: 7
        max: 7
        passed: true
        comment: US sales data by region/state is realistic business scenario
      - id: DQ-03
        name: Appropriate Scale
        score: 5
        max: 5
        passed: true
        comment: Sales values in $K (25-520) are plausible regional sales figures
    code_quality:
      score: 9
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 3
        max: 3
        passed: true
        comment: 'Clean linear structure: imports ‚Üí data ‚Üí charts ‚Üí composition ‚Üí
          save'
      - id: CQ-02
        name: Reproducibility
        score: 3
        max: 3
        passed: true
        comment: Deterministic data (hardcoded values)
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: Only altair and pandas imported, both used
      - id: CQ-04
        name: No Deprecated API
        score: 1
        max: 1
        passed: true
        comment: Uses current Altair 5.x API
      - id: CQ-05
        name: Output Correct
        score: 0
        max: 1
        passed: false
        comment: Saves both plot.png and plot.html
    library_features:
      score: 3
      max: 5
      items:
      - id: LF-01
        name: Distinctive Features
        score: 3
        max: 5
        passed: true
        comment: Good use of selection_point, transform_lookup, topo_feature, but
          could better leverage Altair's declarative layering
  verdict: REJECTED
impl_tags:
  dependencies: []
  techniques:
  - hover-tooltips
  - layer-composition
  - html-export
  patterns:
  - groupby-aggregation
  dataprep: []
  styling:
  - edge-highlighting
  - custom-colormap
