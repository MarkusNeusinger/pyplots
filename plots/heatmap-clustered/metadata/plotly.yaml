library: plotly
specification_id: heatmap-clustered
created: '2025-12-26T15:25:12Z'
updated: '2025-12-26T15:27:32Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 20524719987
issue: 0
python_version: 3.13.11
library_version: 6.5.0
preview_url: https://storage.googleapis.com/pyplots-images/plots/heatmap-clustered/plotly/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/heatmap-clustered/plotly/plot_thumb.png
preview_html: https://storage.googleapis.com/pyplots-images/plots/heatmap-clustered/plotly/plot.html
quality_score: 91
impl_tags:
  dependencies:
  - scipy
  techniques:
  - hover-tooltips
  - html-export
  - colorbar
  patterns:
  - data-generation
  - matrix-construction
  dataprep:
  - hierarchical-clustering
  styling:
  - custom-colormap
review:
  strengths:
  - Excellent use of scipy hierarchical clustering with proper Ward's method and Euclidean
    distance
  - Dendrograms correctly rendered using manual Scatter traces to match heatmap alignment
  - Biologically meaningful data with real gene names organized by pathway (cell cycle,
    metabolism, immune, cancer)
  - Clean tumor vs normal separation visible through clustering
  - Diverging colormap correctly centered at zero
  - Proper hover template for interactive exploration
  - Outputs both PNG and HTML for static and interactive use
  weaknesses:
  - Missing axis labels (e.g., "Genes" for Y-axis, "Samples" for X-axis) - only tick
    labels are present
  - No row/column color bars for group annotations as suggested in spec Notes (could
    annotate gene pathways or tumor/normal status)
  image_description: 'The plot shows a clustered heatmap displaying gene expression
    data for 20 genes across 12 samples. The visualization features:

    - **Dendrograms**: Blue hierarchical clustering trees on both the top (column
    clustering) and left (row clustering) sides

    - **Heatmap**: A well-proportioned central heatmap using the RdBu_r diverging
    colormap (red=high expression ~3, blue=low expression ~-3)

    - **Title**: Correctly formatted as "heatmap-clustered · plotly · pyplots.ai"
    centered at top

    - **Gene labels** (rows): PLK1, CDK1, MYC, BUB1, AURKA, CCNB1, VEGFA, EGFR, BRCA1,
    TP53, PKM, HK2, LDHA, ENO1, GAPDH, CXCL8, IL1B, IFNG, TNF, IL6

    - **Sample labels** (columns): N2_C, N2_A, N2_B, N1_C, N1_A, N1_B, T1_C, T1_A,
    T1_B, T2_C, T2_A, T2_B (rotated 45°)

    - **Colorbar**: On the right with "Expression (z-score)" title, range -3 to 3

    - **Clear clustering**: Normal samples (N) cluster together on the left, Tumor
    samples (T) on the right, demonstrating successful hierarchical clustering'
  criteria_checklist:
    visual_quality:
      score: 36
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 9
        max: 10
        passed: true
        comment: 'Title is large and clear, gene/sample labels readable at full size,
          colorbar text legible. Minor: could be slightly larger for optimal readability'
      - id: VQ-02
        name: No Overlap
        score: 8
        max: 8
        passed: true
        comment: No overlapping text anywhere, labels well-spaced
      - id: VQ-03
        name: Element Visibility
        score: 8
        max: 8
        passed: true
        comment: Heatmap cells clearly visible, dendrograms well-rendered with appropriate
          line width
      - id: VQ-04
        name: Color Accessibility
        score: 5
        max: 5
        passed: true
        comment: RdBu_r diverging colormap is colorblind-safe for this use case
      - id: VQ-05
        name: Layout Balance
        score: 4
        max: 5
        passed: true
        comment: 'Good proportions, plot fills canvas well. Minor: slight imbalance
          with left dendrogram area'
      - id: VQ-06
        name: Axis Labels
        score: 0
        max: 2
        passed: true
        comment: No explicit axis labels (X/Y titles), only tick labels present
      - id: VQ-07
        name: Grid & Legend
        score: 2
        max: 2
        passed: true
        comment: Colorbar well-positioned, no distracting grid
    spec_compliance:
      score: 23
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 8
        max: 8
        passed: true
        comment: Correct clustered heatmap with dendrograms
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: Genes on rows, samples on columns, correctly reordered
      - id: SC-03
        name: Required Features
        score: 5
        max: 5
        passed: true
        comment: Has dendrograms on both axes, reordering, diverging colormap centered
          at zero, colorbar legend
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: All data visible, appropriate z-score range
      - id: SC-05
        name: Legend Accuracy
        score: 0
        max: 2
        passed: true
        comment: Colorbar shows values but lacks row/column group annotations mentioned
          in spec Notes
      - id: SC-06
        name: Title Format
        score: 2
        max: 2
        passed: true
        comment: 'Correct format: "heatmap-clustered · plotly · pyplots.ai"'
    data_quality:
      score: 19
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 7
        max: 8
        passed: true
        comment: Shows clear cluster structure, tumor vs normal separation, but no
          explicit group color bars for pathway annotation
      - id: DQ-02
        name: Realistic Context
        score: 7
        max: 7
        passed: true
        comment: Gene expression analysis with real gene names (CDK1, TP53, etc.)
          and tumor/normal samples - excellent realistic scenario
      - id: DQ-03
        name: Appropriate Scale
        score: 5
        max: 5
        passed: true
        comment: Z-score normalized expression values in typical -3 to 3 range
    code_quality:
      score: 10
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 3
        max: 3
        passed: true
        comment: 'Clean linear flow: imports → data → clustering → plot → save'
      - id: CQ-02
        name: Reproducibility
        score: 3
        max: 3
        passed: true
        comment: np.random.seed(42) is set
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: All imports are used (numpy, plotly.graph_objects, make_subplots,
          scipy clustering)
      - id: CQ-04
        name: No Deprecated API
        score: 1
        max: 1
        passed: true
        comment: Current plotly API used
      - id: CQ-05
        name: Output Correct
        score: 1
        max: 1
        passed: true
        comment: Saves as plot.png and plot.html
    library_features:
      score: 3
      max: 5
      items:
      - id: LF-01
        name: Uses distinctive library features
        score: 3
        max: 5
        passed: true
        comment: Uses make_subplots for multi-panel layout, go.Heatmap with hover
          templates, colorbar customization. Could leverage more interactivity features.
  verdict: APPROVED
