library: highcharts
specification_id: heatmap-clustered
created: '2025-12-25T19:26:52Z'
updated: '2025-12-25T19:29:18Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 20509770793
issue: 2021
python_version: 3.13.11
library_version: unknown
preview_url: https://storage.googleapis.com/pyplots-images/plots/heatmap-clustered/highcharts/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/heatmap-clustered/highcharts/plot_thumb.png
preview_html: https://storage.googleapis.com/pyplots-images/plots/heatmap-clustered/highcharts/plot.html
quality_score: 91
review:
  strengths:
  - Excellent implementation of hierarchical clustering with Ward's method and Euclidean
    distance as specified
  - Both row and column dendrograms properly displayed and aligned with the heatmap
  - Diverging blue-white-red colormap perfectly centered around zero for expression
    data
  - Realistic gene expression context with meaningful cluster structure (drug-specific
    responses)
  - Clean integration of dendrograms via SVG overlay technique
  - Good use of square 1:1 aspect ratio appropriate for clustered heatmaps
  - Properly saves both PNG and interactive HTML versions
  weaknesses:
  - The helper function get_dendro_paths() breaks the KISS principle (imports → data
    → plot → save)
  - Row dendrogram lines could be slightly thicker for better visibility at the rendered
    size
  - Minor excess whitespace at bottom of the chart
  image_description: The plot displays a clustered heatmap showing gene expression
    data across 20 genes (y-axis) and 12 samples (x-axis). The heatmap uses a diverging
    blue-white-red colormap where blue indicates low/negative expression values (-4
    to -2) and red indicates high/positive expression values (2 to 4). A column dendrogram
    is displayed above the heatmap showing hierarchical clustering of samples, which
    groups the Drug_A, Drug_C, Drug_B, and Control samples into distinct clusters.
    A row dendrogram is displayed on the left side showing hierarchical clustering
    of genes. The title reads "Gene Expression Clusters · heatmap-clustered · highcharts
    · pyplots.ai" with a subtitle "Hierarchical clustering reveals drug-specific expression
    patterns". The colorbar legend on the right shows the "Expression" scale from
    -4 to 4. Sample labels are rotated at the bottom, and gene labels (Gene_01 through
    Gene_20) are displayed on the left y-axis. The layout uses a square 1:1 aspect
    ratio.
  criteria_checklist:
    visual_quality:
      score: 36
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 9
        max: 10
        passed: true
        comment: Title, axis labels, and tick labels are clearly readable. Gene labels
          on left side are slightly small but still legible.
      - id: VQ-02
        name: No Overlap
        score: 8
        max: 8
        passed: true
        comment: No overlapping text elements. Rotated x-axis labels are well spaced.
      - id: VQ-03
        name: Element Visibility
        score: 7
        max: 8
        passed: true
        comment: Heatmap cells are clearly visible with good sizing. The dendrogram
          lines are visible but could be slightly thicker for better visibility.
      - id: VQ-04
        name: Color Accessibility
        score: 5
        max: 5
        passed: true
        comment: Blue-white-red diverging colormap is colorblind-safe and provides
          excellent contrast.
      - id: VQ-05
        name: Layout Balance
        score: 4
        max: 5
        passed: true
        comment: Good use of square format for clustered heatmap. Margins accommodate
          dendrograms well, though there's slight excess whitespace at bottom.
      - id: VQ-06
        name: Axis Labels
        score: 2
        max: 2
        passed: true
        comment: '"Samples" and "Genes" are descriptive axis titles.'
      - id: VQ-07
        name: Grid & Legend
        score: 1
        max: 2
        passed: true
        comment: Colorbar is well-placed with "Expression" title. White cell borders
          provide visual separation. No grid needed for heatmap.
    spec_compliance:
      score: 25
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 8
        max: 8
        passed: true
        comment: Correct clustered heatmap with dendrograms.
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: Genes on rows, samples on columns, correctly mapped.
      - id: SC-03
        name: Required Features
        score: 5
        max: 5
        passed: true
        comment: Has dendrograms on both rows and columns, reordered data based on
          clustering, diverging colormap, colorbar legend.
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: Expression values centered around zero, scale from -4 to 4 visible
          in colorbar.
      - id: SC-05
        name: Legend Accuracy
        score: 2
        max: 2
        passed: true
        comment: Colorbar correctly labeled "Expression".
      - id: SC-06
        name: Title Format
        score: 2
        max: 2
        passed: true
        comment: Uses correct format "heatmap-clustered · highcharts · pyplots.ai"
          in title.
    data_quality:
      score: 18
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 7
        max: 8
        passed: true
        comment: Shows clear cluster structure with genes responding differently to
          Drug_A, Drug_B, Drug_C, and Control. Multiple gene groups visible. Could
          have slightly more variation in cluster patterns.
      - id: DQ-02
        name: Realistic Context
        score: 7
        max: 7
        passed: true
        comment: Gene expression microarray experiment is an excellent, realistic
          application for clustered heatmaps.
      - id: DQ-03
        name: Appropriate Scale
        score: 4
        max: 5
        passed: true
        comment: Expression values in reasonable range (-4 to +4 log-fold change).
          Sample and gene counts (12 samples, 20 genes) are appropriate for the visualization.
    code_quality:
      score: 9
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 2
        max: 3
        passed: true
        comment: Mostly follows KISS pattern but includes a helper function `get_dendro_paths()`
          which adds complexity. Understandable given the need for custom dendrogram
          SVG generation.
      - id: CQ-02
        name: Reproducibility
        score: 3
        max: 3
        passed: true
        comment: Uses `np.random.seed(42)` for reproducible data generation.
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: All imports are used appropriately.
      - id: CQ-04
        name: No Deprecated API
        score: 1
        max: 1
        passed: true
        comment: Uses current Highcharts and scipy APIs.
      - id: CQ-05
        name: Output Correct
        score: 1
        max: 1
        passed: true
        comment: Saves as `plot.png` and `plot.html`.
    library_features:
      score: 3
      max: 5
      items:
      - id: LF-01
        name: Distinctive Features
        score: 3
        max: 5
        passed: true
        comment: Uses Highcharts heatmap module with custom SVG overlay for dendrograms.
          Creative solution but dendrograms are not native Highcharts feature - implemented
          via custom SVG overlay which works but is a workaround.
  verdict: APPROVED
