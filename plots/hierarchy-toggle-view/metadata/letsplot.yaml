library: letsplot
specification_id: hierarchy-toggle-view
created: '2026-01-11T09:33:07Z'
updated: '2026-01-11T09:37:11Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 20892895549
issue: 3697
python_version: 3.13.11
library_version: 4.8.2
preview_url: https://storage.googleapis.com/pyplots-images/plots/hierarchy-toggle-view/letsplot/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/hierarchy-toggle-view/letsplot/plot_thumb.png
preview_html: https://storage.googleapis.com/pyplots-images/plots/hierarchy-toggle-view/letsplot/plot.html
quality_score: 88
review:
  strengths:
  - Excellent dual-view implementation showing same data in both treemap and sunburst
    formats
  - Consistent color scheme across both views enables easy identification
  - Good use of lets-plot gggrid for side-by-side layout
  - Interactive HTML version provides true toggle functionality with smooth rendering
  - Realistic company budget data with 3-level hierarchy
  - Well-balanced layout using canvas space effectively
  weaknesses:
  - Some label overlaps in sunburst view where small segments cluster (Mobile, Logistics,
    Monitoring)
  - Code uses multiple helper functions instead of KISS inline structure
  - No explicit legend showing department color groupings
  image_description: |-
    The plot displays a side-by-side visualization showing both a Treemap View (left) and a Sunburst View (right) of company budget allocation data. The main title "hierarchy-toggle-view 路 letsplot 路 pyplots.ai" appears at the top with a subtitle explaining the toggle functionality.

    Treemap View (left): Shows nested rectangles representing budget items with area proportional to their values. Colors include yellow (Sales: North 13%, South 10%), green (Marketing: Digital 11%, Brand 8%), blue shades (Engineering: API Core 8%, Infra 6%, Mobile 5%, Web App 8%, Analytics 7%, Monitoring - unlabeled), and coral/pink (Operations: Facilities 7%, Logistics 5%). Each rectangle displays a label and percentage. White borders separate the rectangles cleanly.

    Sunburst View (right): Shows a donut/radial chart with the same data. Segments are colored consistently with the treemap. Labels are placed within or near their corresponding segments. The center is empty (donut style). Colors match between views, making identification easy.

    Both views use consistent colors for the same categories. The layout is well-balanced with good use of canvas space.
  criteria_checklist:
    visual_quality:
      score: 35
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 8
        max: 10
        passed: true
        comment: Most text readable, but some smaller treemap labels cramped and sunburst
          labels overlap slightly in crowded areas
      - id: VQ-02
        name: No Overlap
        score: 6
        max: 8
        passed: true
        comment: Minor label overlaps in sunburst view where small segments cluster
          together
      - id: VQ-03
        name: Element Visibility
        score: 8
        max: 8
        passed: true
        comment: All rectangles and segments clearly visible with good sizing
      - id: VQ-04
        name: Color Accessibility
        score: 5
        max: 5
        passed: true
        comment: Colorblind-friendly with distinct hues (yellow, green, blue shades,
          coral/pink)
      - id: VQ-05
        name: Layout Balance
        score: 5
        max: 5
        passed: true
        comment: Both views well-proportioned and fill canvas appropriately
      - id: VQ-06
        name: Axis Labels
        score: 2
        max: 2
        passed: true
        comment: N/A for treemap/sunburst; titles and labels are descriptive
      - id: VQ-07
        name: Grid & Legend
        score: 1
        max: 2
        passed: true
        comment: No legend shown (labels inline), works but legend would help identify
          color groupings
    spec_compliance:
      score: 23
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 8
        max: 8
        passed: true
        comment: 'Correct: both treemap and sunburst views implemented'
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: Values correctly mapped to area (treemap) and angle (sunburst)
      - id: SC-03
        name: Required Features
        score: 4
        max: 5
        passed: true
        comment: Toggle in HTML but PNG shows side-by-side (acceptable). Colors consistent
          across views
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: All data visible in both views
      - id: SC-05
        name: Legend Accuracy
        score: 1
        max: 2
        passed: true
        comment: No explicit legend; inline labels work but color groupings not explicitly
          shown
      - id: SC-06
        name: Title Format
        score: 2
        max: 2
        passed: true
        comment: 'Correct format: hierarchy-toggle-view 路 letsplot 路 pyplots.ai'
    data_quality:
      score: 18
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 7
        max: 8
        passed: true
        comment: Shows 3-level hierarchy with 16 leaf nodes. Could show more variety
          in segment sizes
      - id: DQ-02
        name: Realistic Context
        score: 7
        max: 7
        passed: true
        comment: Company budget allocation is a perfect, realistic use case
      - id: DQ-03
        name: Appropriate Scale
        score: 4
        max: 5
        passed: true
        comment: Values are plausible budget figures
    code_quality:
      score: 8
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 1
        max: 3
        passed: false
        comment: Uses multiple functions (get_leaves, squarify, make_label, create_wedge)
          which violates KISS principle
      - id: CQ-02
        name: Reproducibility
        score: 3
        max: 3
        passed: true
        comment: Uses np.random.seed(42)
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: All imports used appropriately
      - id: CQ-04
        name: No Deprecated API
        score: 1
        max: 1
        passed: true
        comment: No deprecated APIs used
      - id: CQ-05
        name: Output Correct
        score: 1
        max: 1
        passed: true
        comment: Saves as plot.png and plot.html
    library_features:
      score: 4
      max: 5
      items:
      - id: LF-01
        name: Distinctive Features
        score: 4
        max: 5
        passed: true
        comment: Good use of gggrid for combining plots, geom_polygon for sunburst,
          geom_rect for treemap, theme_void(). Also generates interactive HTML
  verdict: REJECTED
impl_tags:
  dependencies: []
  techniques:
  - subplots
  - annotations
  - patches
  - html-export
  patterns:
  - data-generation
  - iteration-over-groups
  - matrix-construction
  dataprep: []
  styling:
  - minimal-chrome
  - alpha-blending
  - edge-highlighting
