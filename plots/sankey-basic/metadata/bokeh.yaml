library: bokeh
specification_id: sankey-basic
created: '2025-12-23T19:43:20Z'
updated: '2025-12-23T19:50:47Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 20469995210
issue: 0
python_version: 3.13.11
library_version: 3.8.1
preview_url: https://storage.googleapis.com/pyplots-images/plots/sankey-basic/bokeh/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/sankey-basic/bokeh/plot_thumb.png
preview_html: https://storage.googleapis.com/pyplots-images/plots/sankey-basic/bokeh/plot.html
quality_score: 91
review:
  strengths:
  - Excellent custom implementation of Sankey diagram using Bokeh primitives (patches
    for flows, quads for nodes)
  - Smooth bezier curves create visually appealing flow paths
  - Clear energy flow context with realistic TWh values
  - Good color differentiation between sources and targets
  - Labels include both name and value for immediate data comprehension
  - Proper stacking of flows at connection points prevents visual confusion
  weaknesses:
  - Missing legend to explain the color scheme for viewers not reading labels
  - Could leverage Bokeh interactive features (hover tooltips showing flow details)
  - Font sizes could be slightly larger for optimal readability at full resolution
  image_description: 'The plot displays a Sankey diagram showing energy flow from
    5 source nodes on the left (Solar 11 TWh, Hydro 15 TWh, Nuclear 30 TWh, Gas 65
    TWh, Coal 35 TWh) to 3 target nodes on the right (Commercial 45 TWh, Residential
    53 TWh, Industrial 58 TWh). The flows are rendered as smooth bezier curves connecting
    sources to destinations, with widths proportional to flow values. Colors used:
    orange for Solar, light blue for Hydro, purple for Nuclear, yellow/gold for Gas,
    and Python blue (#306998) for Coal. Target nodes are colored teal (Commercial),
    red (Residential), and dark blue-grey (Industrial). The title "Energy Flow · sankey-basic
    · bokeh · pyplots.ai" is centered at the top. The background is a light grey (#FAFAFA).
    All labels include the node name and total value in TWh. Flow opacity is set at
    0.5, allowing overlapping flows to be distinguished.'
  criteria_checklist:
    visual_quality:
      score: 36
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 9
        max: 10
        passed: true
        comment: All text is readable at 22pt for labels and 32pt for title. Slightly
          small for the 4800x2700 canvas but still clear.
      - id: VQ-02
        name: No Overlap
        score: 8
        max: 8
        passed: true
        comment: No text overlap; labels are well-positioned outside nodes
      - id: VQ-03
        name: Element Visibility
        score: 8
        max: 8
        passed: true
        comment: Flows are clearly visible with appropriate widths proportional to
          values; 0.5 alpha allows overlapping flows to be distinguished
      - id: VQ-04
        name: Color Accessibility
        score: 5
        max: 5
        passed: true
        comment: Good colorblind-safe palette with distinct hues (orange, blue, purple,
          yellow, teal, red, dark grey)
      - id: VQ-05
        name: Layout Balance
        score: 4
        max: 5
        passed: true
        comment: Good use of canvas with balanced margins; plot fills approximately
          70% of canvas width
      - id: VQ-07
        name: Grid & Legend
        score: 0
        max: 2
        passed: true
        comment: No legend provided; while node colors are labeled, a legend explaining
          the color scheme would improve clarity
    spec_compliance:
      score: 25
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 8
        max: 8
        passed: true
        comment: Correct Sankey diagram with nodes and flows
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: Source, target, and value correctly mapped to visual elements
      - id: SC-03
        name: Required Features
        score: 5
        max: 5
        passed: true
        comment: 'All spec features present: flows with proportional widths, distinct
          source colors, node labels, no circular flows'
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: All data visible; flow widths accurately represent relative values
      - id: SC-05
        name: Legend Accuracy
        score: 2
        max: 2
        passed: true
        comment: Node labels accurately show names and values
      - id: SC-06
        name: Title Format
        score: 2
        max: 2
        passed: true
        comment: 'Correct format: "Energy Flow · sankey-basic · bokeh · pyplots.ai"'
    data_quality:
      score: 18
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 7
        max: 8
        passed: true
        comment: Shows multiple sources flowing to multiple targets with varying magnitudes;
          demonstrates flow crossing and stacking
      - id: DQ-02
        name: Realistic Context
        score: 7
        max: 7
        passed: true
        comment: Energy flow from sources to sectors is a classic, realistic Sankey
          use case with plausible TWh values
      - id: DQ-03
        name: Appropriate Scale
        score: 4
        max: 5
        passed: true
        comment: Values are reasonable for energy flows; total sources (156 TWh) equals
          total targets (156 TWh) as expected
    code_quality:
      score: 9
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 3
        max: 3
        passed: true
        comment: 'Linear script: imports → data → calculations → plotting → save'
      - id: CQ-02
        name: Reproducibility
        score: 2
        max: 3
        passed: true
        comment: Data is deterministic (hardcoded), but numpy is imported for bezier
          calculations without random operations
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: All imports are used
      - id: CQ-04
        name: No Deprecated API
        score: 1
        max: 1
        passed: true
        comment: Uses current Bokeh API
      - id: CQ-05
        name: Output Correct
        score: 1
        max: 1
        passed: true
        comment: Saves as plot.png and plot.html
    library_features:
      score: 3
      max: 5
      items:
      - id: LF-01
        name: Uses distinctive library features
        score: 3
        max: 5
        passed: true
        comment: Uses Bokeh's figure, patch for bezier flows, quad for nodes, and
          Label for annotations. However, could better leverage ColumnDataSource for
          data management or hover tooltips for interactivity.
  verdict: APPROVED
