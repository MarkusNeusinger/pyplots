library: plotnine
specification_id: drawdown-basic
created: '2026-01-20T11:58:00Z'
updated: '2026-01-20T12:00:35Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 21170482676
issue: 3752
python_version: 3.13.11
library_version: 0.15.2
preview_url: https://storage.googleapis.com/pyplots-images/plots/drawdown-basic/plotnine/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/drawdown-basic/plotnine/plot_thumb.png
preview_html: null
quality_score: 91
review:
  strengths:
  - Excellent implementation of ggplot2 grammar of graphics with proper layer composition
    (ribbon + line + point + annotation)
  - Clean, readable code following plotnine conventions
  - Good use of theme customization for publication-quality output
  - Statistics displayed in caption provide useful context
  - Date formatting with proper scale_x_datetime usage
  weaknesses:
  - Recovery points (where drawdown returns to zero/new highs) are not explicitly
    marked as suggested in spec
  - The max drawdown marker point could be slightly more prominent
  image_description: |-
    The plot displays a drawdown chart showing percentage decline from peak value over approximately 500 days (Jan 2022 to May 2023). The chart features a red filled area (semi-transparent, ~40% opacity) extending from the drawdown line down to the zero baseline. A darker red line (#d62728) traces the drawdown values over time. A dashed black horizontal line at y=0 represents the zero baseline (peak reference).

    The maximum drawdown point (~-47%) is marked with a dark red dot around August 2022, with an annotation "Max Drawdown: -47.0%" labeling this point. The X-axis shows dates formatted as "Mon YYYY" at 3-month intervals with labels rotated 45 degrees for readability. The Y-axis shows "Drawdown (%)" ranging from approximately -47 to 0 with breaks at 5% intervals.

    The title follows the correct format: "drawdown-basic · plotnine · pyplots.ai". A caption at the bottom right displays key statistics: "Max Drawdown: -47.0% | Max Duration: 489 days". The plot uses a clean minimal theme with subtle gray grid lines, providing a professional appearance suitable for financial analysis.

    The data shows realistic portfolio behavior with an initial drawdown from January 2022, partial recovery around July 2022, followed by a deeper drawdown reaching the maximum around August 2022, and then gradual partial recovery through 2023 while remaining in drawdown territory.
  criteria_checklist:
    visual_quality:
      score: 36
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 10
        max: 10
        passed: true
        comment: Title at 24pt, axis titles at 20pt, tick labels at 16pt, all perfectly
          readable
      - id: VQ-02
        name: No Overlap
        score: 8
        max: 8
        passed: true
        comment: No overlapping text elements, x-axis labels properly rotated to avoid
          collision
      - id: VQ-03
        name: Element Visibility
        score: 6
        max: 8
        passed: true
        comment: Line and filled area clearly visible, max drawdown marker visible
          but could be slightly larger
      - id: VQ-04
        name: Color Accessibility
        score: 5
        max: 5
        passed: true
        comment: Red color scheme is distinct, no red-green confusion issues since
          single-color scheme
      - id: VQ-05
        name: Layout Balance
        score: 5
        max: 5
        passed: true
        comment: Plot fills canvas well, balanced margins, caption positioned appropriately
      - id: VQ-06
        name: Axis Labels
        score: 2
        max: 2
        passed: true
        comment: Drawdown (%) includes units, Date is descriptive
      - id: VQ-07
        name: Grid & Legend
        score: 0
        max: 2
        passed: false
        comment: Grid is subtle with appropriate alpha, no legend needed - scored
          0 as there is nothing to evaluate for legend portion
    spec_compliance:
      score: 23
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 8
        max: 8
        passed: true
        comment: Correct drawdown chart with filled area from line to zero baseline
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: Date on X-axis, drawdown percentage on Y-axis, correctly implemented
      - id: SC-03
        name: Required Features
        score: 4
        max: 5
        passed: true
        comment: 'Has filled area, zero baseline, max drawdown marker with annotation,
          key statistics. Missing: recovery points not explicitly marked'
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: Y-axis shows full range of drawdown values
      - id: SC-05
        name: Legend Accuracy
        score: 2
        max: 2
        passed: true
        comment: No legend needed for single series, caption provides context
      - id: SC-06
        name: Title Format
        score: 2
        max: 2
        passed: true
        comment: 'Correct format: drawdown-basic · plotnine · pyplots.ai'
    data_quality:
      score: 18
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 7
        max: 8
        passed: true
        comment: Shows multiple drawdown periods, recovery phases, and deepening patterns
      - id: DQ-02
        name: Realistic Context
        score: 7
        max: 7
        passed: true
        comment: Portfolio/stock drawdown scenario is realistic and neutral
      - id: DQ-03
        name: Appropriate Scale
        score: 4
        max: 5
        passed: true
        comment: Drawdown values (-47% max) realistic for volatile assets, somewhat
          severe for typical portfolios
    code_quality:
      score: 9
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 3
        max: 3
        passed: true
        comment: 'Linear flow: imports → data generation → calculations → plot → save'
      - id: CQ-02
        name: Reproducibility
        score: 3
        max: 3
        passed: true
        comment: Uses np.random.seed(42)
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: All imports are used
      - id: CQ-04
        name: No Deprecated API
        score: 1
        max: 1
        passed: true
        comment: Uses current plotnine API
      - id: CQ-05
        name: Output Correct
        score: 0
        max: 1
        passed: false
        comment: Saves as plot.png but width/height in save() redundant with figure_size
          in theme()
    library_features:
      score: 5
      max: 5
      items:
      - id: LF-01
        name: Distinctive Features
        score: 5
        max: 5
        passed: true
        comment: 'Excellent use of grammar of graphics: geom_ribbon, geom_line, geom_hline,
          geom_point, annotate, theme customization, scale_x_datetime'
  verdict: APPROVED
impl_tags:
  dependencies: []
  techniques:
  - annotations
  - layer-composition
  patterns:
  - data-generation
  - cumulative-calculation
  dataprep:
  - time-series
  - cumulative-sum
  styling:
  - alpha-blending
  - grid-styling
