library: altair
specification_id: mosaic-categorical
created: '2026-01-11T00:19:06Z'
updated: '2026-01-11T00:25:02Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 20886560753
issue: 3650
python_version: 3.13.11
library_version: 6.0.0
preview_url: https://storage.googleapis.com/pyplots-images/plots/mosaic-categorical/altair/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/mosaic-categorical/altair/plot_thumb.png
preview_html: https://storage.googleapis.com/pyplots-images/plots/mosaic-categorical/altair/plot.html
quality_score: 91
review:
  strengths:
  - Excellent mosaic plot implementation with clear visual hierarchy showing survival
    rates across classes
  - Smart use of conditional coloring for text labels (white on blue, dark on yellow)
    ensuring readability
  - Clean data preparation logic calculating proportional widths and heights correctly
  - Interactive tooltips provide additional detail on hover
  - White stroke separation between rectangles enhances visual clarity
  weaknesses:
  - Missing explicit axis labels for the two categorical variables (e.g., Passenger
    Class as x-axis label, Proportion as y-axis label)
  - Manual position calculation is verbose; could potentially use Altair transforms
    for cleaner code
  image_description: 'The plot displays a mosaic chart visualizing Titanic survival
    data by passenger class. Four vertical columns represent the classes (1st, 2nd,
    3rd, Crew), with widths proportional to the total number of passengers in each
    class. Each column is divided into two rectangles colored by survival status:
    blue (#306998) for "Survived" and yellow (#FFD43B) for "Did Not Survive". The
    heights within each column represent the proportion of survivors vs non-survivors.
    Count labels (203, 122, 118, 167, 178, 528, 212, 673) are displayed inside each
    rectangle in bold text with appropriate contrast (white on blue, dark gray on
    yellow). Class labels appear at the top of each column. A legend on the right
    shows "Survival Status" with color coding. The title "mosaic-categorical · altair
    · pyplots.ai" appears centered at the top. White gaps separate the rectangles
    for visual clarity.'
  criteria_checklist:
    visual_quality:
      score: 37
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 10
        max: 10
        passed: true
        comment: Title at 28pt, count labels at 22pt bold, class labels at 20pt, legend
          at 18-20pt - all clearly readable
      - id: VQ-02
        name: No Overlap
        score: 8
        max: 8
        passed: true
        comment: No overlapping text elements; rectangles well separated with white
          stroke
      - id: VQ-03
        name: Element Visibility
        score: 8
        max: 8
        passed: true
        comment: Rectangles well-sized, areas proportional to frequencies as expected
          for mosaic
      - id: VQ-04
        name: Color Accessibility
        score: 5
        max: 5
        passed: true
        comment: Blue and yellow are colorblind-safe, excellent contrast
      - id: VQ-05
        name: Layout Balance
        score: 4
        max: 5
        passed: true
        comment: Good canvas utilization; legend slightly far from plot but acceptable
      - id: VQ-06
        name: Axis Labels
        score: 0
        max: 2
        passed: false
        comment: No explicit axis labels for the categorical variables
      - id: VQ-07
        name: Grid & Legend
        score: 2
        max: 2
        passed: true
        comment: Legend well-placed with appropriate sizing, no grid needed for mosaic
    spec_compliance:
      score: 25
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 8
        max: 8
        passed: true
        comment: Correct mosaic plot with areas proportional to frequencies
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: Class mapped to width, Survival to height within columns
      - id: SC-03
        name: Required Features
        score: 5
        max: 5
        passed: true
        comment: 'All spec features present: proportional widths, heights, gap spacing,
          color coding, labels'
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: All 8 combinations displayed
      - id: SC-05
        name: Legend Accuracy
        score: 2
        max: 2
        passed: true
        comment: Legend correctly shows Survived/Did Not Survive with matching colors
      - id: SC-06
        name: Title Format
        score: 2
        max: 2
        passed: true
        comment: 'Uses correct format: mosaic-categorical · altair · pyplots.ai'
    data_quality:
      score: 19
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 8
        max: 8
        passed: true
        comment: 'Shows clear variation: 1st class has high survival, 3rd/Crew have
          low survival; different class sizes visible'
      - id: DQ-02
        name: Realistic Context
        score: 6
        max: 7
        passed: true
        comment: Titanic survival data is classic, neutral, and educational
      - id: DQ-03
        name: Appropriate Scale
        score: 5
        max: 5
        passed: true
        comment: Values are realistic for Titanic data (totals around 2200)
    code_quality:
      score: 7
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 3
        max: 3
        passed: true
        comment: 'Flat structure: imports → data → calculations → plot → save'
      - id: CQ-02
        name: Reproducibility
        score: 0
        max: 3
        passed: false
        comment: No random seed but data is deterministic hardcoded values
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: Only altair and pandas imported, both used
      - id: CQ-04
        name: No Deprecated API
        score: 1
        max: 1
        passed: true
        comment: Uses current Altair API
      - id: CQ-05
        name: Output Correct
        score: 1
        max: 1
        passed: true
        comment: Saves as plot.png and plot.html
    library_features:
      score: 3
      max: 5
      items:
      - id: LF-01
        name: Distinctive Features
        score: 3
        max: 5
        passed: true
        comment: Uses mark_rect with x/x2/y/y2 encoding, layered composition, conditional
          color for labels, tooltips
  verdict: APPROVED
impl_tags:
  dependencies: []
  techniques:
  - annotations
  - layer-composition
  - hover-tooltips
  - html-export
  patterns:
  - groupby-aggregation
  - iteration-over-groups
  dataprep: []
  styling:
  - edge-highlighting
