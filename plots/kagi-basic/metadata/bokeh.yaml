library: bokeh
specification_id: kagi-basic
created: '2026-01-08T21:54:18Z'
updated: '2026-01-08T22:22:23Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 20832944885
issue: 3341
python_version: 3.13.11
library_version: 3.8.2
preview_url: https://storage.googleapis.com/pyplots-images/plots/kagi-basic/bokeh/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/kagi-basic/bokeh/plot_thumb.png
preview_html: https://storage.googleapis.com/pyplots-images/plots/kagi-basic/bokeh/plot.html
quality_score: 85
review:
  strengths:
  - Correct Kagi chart algorithm with proper yang/yin transition logic
  - Colorblind-safe blue/orange color scheme
  - Good differentiation between thick (yang) and thin (yin) lines
  - Proper horizontal connectors at reversal points
  - Clean, readable code structure with good comments
  weaknesses:
  - Legend text appears small relative to the large canvas size
  - Does not use ColumnDataSource which is idiomatic Bokeh
  - Could benefit from HoverTool to show price values interactively
  - Some thin (yin) lines are less visually prominent
  image_description: The plot displays a Kagi chart with price movements over approximately
    21 kagi line indices. Blue thick lines represent Yang (Bullish) segments and orange
    thin lines represent Yin (Bearish) segments. The chart shows the characteristic
    step-like pattern of Kagi charts with vertical price movements connected by horizontal
    segments at reversal points. The price ranges from approximately $78 to $113.
    The title "kagi-basic · bokeh · pyplots.ai" is centered at the top. The legend
    in the top-left corner shows "Yang (Bullish)" with a blue line and "Yin (Bearish)"
    with an orange line. The x-axis is labeled "Kagi Line Index" and the y-axis is
    labeled "Price ($)". The background is a light gray (#fafafa) with subtle dashed
    grid lines. The chart demonstrates multiple trend reversals with yang/yin transitions
    occurring when price breaks previous highs or lows.
  criteria_checklist:
    visual_quality:
      score: 34
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 8
        max: 10
        passed: true
        comment: Title and axis labels are readable but could be slightly larger for
          the canvas size
      - id: VQ-02
        name: No Overlap
        score: 8
        max: 8
        passed: true
        comment: No overlapping text elements
      - id: VQ-03
        name: Element Visibility
        score: 7
        max: 8
        passed: true
        comment: Line segments are visible with good thickness differentiation (12px
          vs 4px), though some thin lines are less prominent
      - id: VQ-04
        name: Color Accessibility
        score: 5
        max: 5
        passed: true
        comment: Blue/orange color scheme is colorblind-safe
      - id: VQ-05
        name: Layout Balance
        score: 4
        max: 5
        passed: true
        comment: Good layout but legend is small relative to canvas
      - id: VQ-06
        name: Axis Labels
        score: 2
        max: 2
        passed: true
        comment: 'Descriptive labels with units: Price ($), Kagi Line Index'
      - id: VQ-07
        name: Grid & Legend
        score: 0
        max: 2
        passed: false
        comment: Legend text appears small in output, positioned far from data area
    spec_compliance:
      score: 23
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 8
        max: 8
        passed: true
        comment: Correct Kagi chart implementation with yang/yin segments
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: X shows line index (time-independent), Y shows price
      - id: SC-03
        name: Required Features
        score: 4
        max: 5
        passed: true
        comment: Has thick/thin lines, color coding, horizontal connectors; shoulders/waists
          present but not explicitly highlighted
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: All data visible within axes
      - id: SC-05
        name: Legend Accuracy
        score: 2
        max: 2
        passed: true
        comment: Legend correctly identifies Yang (Bullish) and Yin (Bearish)
      - id: SC-06
        name: Title Format
        score: 1
        max: 2
        passed: false
        comment: Correct format but separator rendering may vary
    data_quality:
      score: 17
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 7
        max: 8
        passed: true
        comment: Shows multiple yang/yin transitions, uptrends and downtrends
      - id: DQ-02
        name: Realistic Context
        score: 7
        max: 7
        passed: true
        comment: Simulated stock price data with realistic 4% reversal threshold
      - id: DQ-03
        name: Appropriate Scale
        score: 3
        max: 5
        passed: true
        comment: Price range ($78-$113) is realistic, though data density is sparse
    code_quality:
      score: 8
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 3
        max: 3
        passed: true
        comment: 'Linear flow: imports → data → plot → save, no functions/classes'
      - id: CQ-02
        name: Reproducibility
        score: 3
        max: 3
        passed: true
        comment: Uses np.random.seed(42)
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: All imports are used
      - id: CQ-04
        name: No Deprecated API
        score: 0
        max: 1
        passed: false
        comment: strict=True in zip is Python 3.10+ only
      - id: CQ-05
        name: Output Correct
        score: 0
        max: 1
        passed: false
        comment: Saves as plot.png correctly
    library_features:
      score: 3
      max: 5
      items:
      - id: LF-01
        name: Distinctive Features
        score: 3
        max: 5
        passed: true
        comment: Uses Legend/LegendItem models, figure configuration, but does not
          leverage ColumnDataSource or HoverTool
  verdict: APPROVED
impl_tags:
  dependencies: []
  techniques:
  - custom-legend
  - iteration-over-groups
  patterns:
  - data-generation
  - iteration-over-groups
  dataprep: []
  styling:
  - grid-styling
