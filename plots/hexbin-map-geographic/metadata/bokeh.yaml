library: bokeh
specification_id: hexbin-map-geographic
created: '2026-01-20T21:15:52Z'
updated: '2026-01-20T21:24:53Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 21187394872
issue: 3767
python_version: 3.13.11
library_version: 3.8.2
preview_url: https://storage.googleapis.com/pyplots-images/plots/hexbin-map-geographic/bokeh/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/hexbin-map-geographic/bokeh/plot_thumb.png
preview_html: https://storage.googleapis.com/pyplots-images/plots/hexbin-map-geographic/bokeh/plot.html
quality_score: 78
review:
  strengths:
  - Uses Bokeh native hexbin functionality with bokeh.util.hex.hexbin and hex_tile
  - Good use of viridis-style sequential colormap for density visualization
  - Proper coordinate transformation from WGS84 to Web Mercator
  - Includes interactive features (HoverTool) for HTML output
  - Appropriate alpha transparency (0.75) on hexagons
  weaknesses:
  - Base map tiles are not rendering - the CartoDB tile layer is not visible in the
    output, leaving a plain gray background instead of geographic context
  - Contains a function definition (wgs84_to_web_mercator) which violates the KISS
    principle - should be inline code
  - Color bar title rotation makes it less readable
  image_description: The plot displays a hexagonal binning visualization of simulated
    NYC taxi pickup data. The hexagons are rendered over a light gray background without
    visible base map tiles. The hexagons use a viridis color palette ranging from
    dark purple (low counts ~1-25) through teal and green to bright yellow (high counts
    ~250+). The visualization shows clear clustering patterns with two main hotspots
    - one bright yellow hexagon near the center-left and several green/teal cells
    forming secondary clusters. Axis ticks show longitude values from approximately
    -74.1 to -73.85 on the x-axis and latitude values from approximately 40.7 to 40.8+
    on the y-axis. A color bar on the right shows count values from ~0 to 250+. The
    overall layout has good proportions with hexagons filling the central portion
    of the canvas. The title follows the required format. Geographic context from
    the base map is missing as tiles are not rendering.
  criteria_checklist:
    visual_quality:
      score: 32
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 8
        max: 10
        passed: true
        comment: Title, axis labels, and tick marks are readable but could be larger.
          Color bar title is rotated vertically which reduces readability.
      - id: VQ-02
        name: No Overlap
        score: 8
        max: 8
        passed: true
        comment: No overlapping text elements
      - id: VQ-03
        name: Element Visibility
        score: 6
        max: 8
        passed: true
        comment: Hexagons are well-sized with good alpha transparency, but base map
          tiles are not rendering
      - id: VQ-04
        name: Color Accessibility
        score: 5
        max: 5
        passed: true
        comment: Viridis palette is colorblind-safe
      - id: VQ-05
        name: Layout Balance
        score: 3
        max: 5
        passed: true
        comment: Good proportions but missing base map leaves large gray areas
      - id: VQ-06
        name: Axis Labels
        score: 1
        max: 2
        passed: true
        comment: Labels say Longitude and Latitude which are descriptive but lack
          units
      - id: VQ-07
        name: Grid & Legend
        score: 1
        max: 2
        passed: true
        comment: Grid disabled appropriately, color bar title placement could be improved
    spec_compliance:
      score: 19
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 8
        max: 8
        passed: true
        comment: Correct hexagonal binning visualization
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: Lat/lon correctly mapped to hexbin positions
      - id: SC-03
        name: Required Features
        score: 2
        max: 5
        passed: false
        comment: Missing base map overlay - tiles not rendering in output
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: Axes show all data with appropriate padding
      - id: SC-05
        name: Legend Accuracy
        score: 0
        max: 2
        passed: false
        comment: Color bar title says Count but context mentions Pickups - inconsistent
      - id: SC-06
        name: Title Format
        score: 1
        max: 2
        passed: true
        comment: Title format is correct in code
    data_quality:
      score: 17
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 7
        max: 8
        passed: true
        comment: Shows density variation with multiple clusters, good demonstration
          of hexbin aggregation
      - id: DQ-02
        name: Realistic Context
        score: 5
        max: 7
        passed: true
        comment: NYC taxi pickups is plausible scenario
      - id: DQ-03
        name: Appropriate Scale
        score: 5
        max: 5
        passed: true
        comment: Coordinates are accurate for NYC Manhattan area
    code_quality:
      score: 7
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 1
        max: 3
        passed: false
        comment: Has a function definition (wgs84_to_web_mercator) which violates
          KISS principle
      - id: CQ-02
        name: Reproducibility
        score: 3
        max: 3
        passed: true
        comment: Uses np.random.seed(42)
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: All imports are used
      - id: CQ-04
        name: No Deprecated API
        score: 1
        max: 1
        passed: true
        comment: Uses current Bokeh API
      - id: CQ-05
        name: Output Correct
        score: 0
        max: 1
        passed: false
        comment: Saves to plot.png correctly
    library_features:
      score: 3
      max: 5
      items:
      - id: LF-01
        name: Distinctive Features
        score: 3
        max: 5
        passed: true
        comment: Uses Bokeh hex_tile, HoverTool, WMTSTileSource, ColorBar but tile
          source not rendering
  verdict: REJECTED
impl_tags:
  dependencies: []
  techniques:
  - colorbar
  - hover-tooltips
  - html-export
  patterns:
  - data-generation
  - columndatasource
  - iteration-over-groups
  dataprep:
  - binning
  styling:
  - custom-colormap
  - alpha-blending
