library: bokeh
specification_id: scatter-map-geographic
created: '2026-01-10T04:04:15Z'
updated: '2026-01-10T04:06:57Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 20872457397
issue: 3617
python_version: 3.13.11
library_version: 3.8.2
preview_url: https://storage.googleapis.com/pyplots-images/plots/scatter-map-geographic/bokeh/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/scatter-map-geographic/bokeh/plot_thumb.png
preview_html: https://storage.googleapis.com/pyplots-images/plots/scatter-map-geographic/bokeh/plot.html
quality_score: 91
review:
  strengths:
  - Excellent use of Bokeh's tile mapping capabilities with WMTSTileSource and CartoDB
    basemap
  - Interactive tooltips showing city name, population, elevation, and coordinates
  - Clean Viridis colormap for colorblind-safe elevation encoding
  - Appropriate Web Mercator projection conversion for accurate positioning
  - Good marker sizing that differentiates population levels
  - Both static PNG and interactive HTML outputs generated
  weaknesses:
  - 'Missing size legend to explain population encoding (spec notes: "Add a size legend
    when size varies")'
  - Title includes "World Cities" prefix instead of starting directly with spec-id
  - Axis labels lack degree symbols/units
  - Helper function slightly breaks KISS structure (though necessary for projection)
  image_description: |-
    The plot displays a world map using CartoDB Positron basemap tiles showing 30 major cities across all continents. Cities are represented as scatter points with:
    - Position: Correctly placed by latitude/longitude (converted to Web Mercator projection)
    - Size encoding: Point sizes vary from small (~25px) to large (~80px) representing population (millions) - Tokyo, Shanghai, Beijing, Mumbai show largest circles
    - Color encoding: Viridis colormap from purple (low elevation) to yellow (high elevation) - Mexico City appears yellow-green (2240m), São Paulo and Johannesburg show greenish tones, most coastal cities are purple/blue
    - Color bar: Located on right side showing "Elevation (m)" scale from 0 to ~2200m
    - Title: "World Cities · scatter-map-geographic · bokeh · pyplots.ai" in blue (#306998) at top-left
    - Axis labels: "Longitude" (x-axis) and "Latitude" (y-axis)
    - Basemap: Clean light gray CartoDB tiles with country names and boundaries visible
    - Layout: World view from approximately -150° to +180° longitude, -60° to +70° latitude
  criteria_checklist:
    visual_quality:
      score: 36
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 9
        max: 10
        passed: true
        comment: Title at 32pt, axis labels at 24pt, tick labels at 18pt, colorbar
          title at 22pt - all readable, though colorbar title could be slightly larger
      - id: VQ-02
        name: No Overlap
        score: 8
        max: 8
        passed: true
        comment: No overlapping text elements, markers well-spaced globally
      - id: VQ-03
        name: Element Visibility
        score: 7
        max: 8
        passed: true
        comment: Markers sized 25-80px appropriate for 30 points, alpha=0.75 handles
          sparse overlap well
      - id: VQ-04
        name: Color Accessibility
        score: 5
        max: 5
        passed: true
        comment: Viridis colormap is colorblind-safe, good contrast against light
          basemap
      - id: VQ-05
        name: Layout Balance
        score: 5
        max: 5
        passed: true
        comment: World map fills canvas well, colorbar positioned appropriately on
          right
      - id: VQ-06
        name: Axis Labels
        score: 1
        max: 2
        passed: true
        comment: Labels say Longitude and Latitude but lack units (could say Longitude
          (°))
      - id: VQ-07
        name: Grid & Legend
        score: 1
        max: 2
        passed: true
        comment: Colorbar well-placed; no explicit size legend for population encoding
    spec_compliance:
      score: 23
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 8
        max: 8
        passed: true
        comment: Correct geographic scatter plot on map tiles
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: Lat/lon correctly converted to Mercator, mapped to x/y
      - id: SC-03
        name: Required Features
        score: 4
        max: 5
        passed: true
        comment: Has basemap, color encoding, size encoding, tooltips; missing explicit
          size legend
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: World view shows all 30 cities without clipping
      - id: SC-05
        name: Legend Accuracy
        score: 2
        max: 2
        passed: true
        comment: Colorbar correctly labeled Elevation (m)
      - id: SC-06
        name: Title Format
        score: 1
        max: 2
        passed: true
        comment: Title has extra World Cities prefix instead of starting directly
          with spec-id
    data_quality:
      score: 18
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 7
        max: 8
        passed: true
        comment: Shows cities across all continents, varies population (0.7M-24.9M)
          and elevation (0-2240m)
      - id: DQ-02
        name: Realistic Context
        score: 7
        max: 7
        passed: true
        comment: Real world cities with actual population and elevation data - neutral,
          educational context
      - id: DQ-03
        name: Appropriate Scale
        score: 4
        max: 5
        passed: true
        comment: Populations and elevations are realistic; some elevation values approximate
    code_quality:
      score: 9
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 2
        max: 3
        passed: true
        comment: Mostly linear flow, but includes a helper function lat_lon_to_mercator
          (necessary for projection)
      - id: CQ-02
        name: Reproducibility
        score: 3
        max: 3
        passed: true
        comment: Uses np.random.seed(42) though data is deterministic
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: All imports used appropriately
      - id: CQ-04
        name: No Deprecated API
        score: 1
        max: 1
        passed: true
        comment: Using current Bokeh APIs
      - id: CQ-05
        name: Output Correct
        score: 1
        max: 1
        passed: true
        comment: Saves as plot.png and plot.html
    library_features:
      score: 5
      max: 5
      items:
      - id: LF-01
        name: Distinctive Features
        score: 5
        max: 5
        passed: true
        comment: 'Excellent use of Bokeh features: WMTSTileSource for tile maps, ColumnDataSource,
          interactive tooltips, mercator axis types, ColorBar, both PNG and HTML export'
  verdict: APPROVED
impl_tags:
  dependencies: []
  techniques:
  - colorbar
  - hover-tooltips
  - html-export
  patterns:
  - data-generation
  - columndatasource
  dataprep: []
  styling:
  - custom-colormap
  - alpha-blending
  - edge-highlighting
