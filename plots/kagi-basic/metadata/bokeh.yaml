library: bokeh
specification_id: kagi-basic
created: '2026-01-08T22:38:15Z'
updated: '2026-01-08T22:40:36Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 20834086969
issue: 3341
python_version: 3.13.11
library_version: 3.8.2
preview_url: https://storage.googleapis.com/pyplots-images/plots/kagi-basic/bokeh/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/kagi-basic/bokeh/plot_thumb.png
preview_html: https://storage.googleapis.com/pyplots-images/plots/kagi-basic/bokeh/plot.html
quality_score: 91
review:
  strengths:
  - Correct Kagi chart algorithm implementation with proper yang/yin state transitions
  - Clear visual distinction between thick yang (blue) and thin yin (red) lines
  - Good use of Bokeh multi_line for efficient rendering of multiple segments
  - Appropriate font scaling for 4800x2700 canvas
  - Clean, readable code structure following KISS principles
  weaknesses:
  - Legend text appears small relative to the large canvas size despite 24pt setting
  - Does not use ColumnDataSource which is the recommended Bokeh pattern
  - Grid styling uses dashed lines which works but could be more subtle
  image_description: The plot displays a Kagi chart showing stock price movements
    over approximately 23 line indices. The chart uses thick blue lines (yang) for
    uptrend segments and thin red lines (yin) for downtrend segments. The price ranges
    from approximately $83 to $134. The chart shows clear trend reversals with horizontal
    shoulders/waists connecting vertical price movements. A legend in the top-left
    identifies "Yang (Uptrend)" in blue and "Yin (Downtrend)" in red. The background
    is a subtle off-white (#FAFAFA) with dashed grid lines. The title "kagi-basic
    路 bokeh 路 pyplots.ai" appears at the top, and axes are labeled "Line Index" (x-axis)
    and "Price ($)" (y-axis).
  criteria_checklist:
    visual_quality:
      score: 36
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 9
        max: 10
        passed: true
        comment: Title, axis labels, and tick marks are all readable, though legend
          text could be slightly larger
      - id: VQ-02
        name: No Overlap
        score: 8
        max: 8
        passed: true
        comment: No overlapping text elements
      - id: VQ-03
        name: Element Visibility
        score: 7
        max: 8
        passed: true
        comment: Line widths are well differentiated (thick vs thin), clearly distinguishable
      - id: VQ-04
        name: Color Accessibility
        score: 5
        max: 5
        passed: true
        comment: Blue and red are colorblind-distinguishable, good contrast
      - id: VQ-05
        name: Layout Balance
        score: 5
        max: 5
        passed: true
        comment: Plot fills canvas well with balanced margins
      - id: VQ-06
        name: Axis Labels
        score: 2
        max: 2
        passed: true
        comment: 'Descriptive labels with units: Price ($) and Line Index'
      - id: VQ-07
        name: Grid & Legend
        score: 0
        max: 2
        passed: false
        comment: Grid is subtle but legend items appear small relative to canvas size
    spec_compliance:
      score: 25
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 8
        max: 8
        passed: true
        comment: Correct Kagi chart implementation with vertical lines and horizontal
          reversals
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: Line Index on X, Price on Y as specified
      - id: SC-03
        name: Required Features
        score: 5
        max: 5
        passed: true
        comment: Thick yang lines, thin yin lines, direction changes on reversal threshold
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: All data visible within axes
      - id: SC-05
        name: Legend Accuracy
        score: 2
        max: 2
        passed: true
        comment: Legend correctly identifies Yang (Uptrend) and Yin (Downtrend)
      - id: SC-06
        name: Title Format
        score: 2
        max: 2
        passed: true
        comment: 'Uses correct format: kagi-basic 路 bokeh 路 pyplots.ai'
    data_quality:
      score: 18
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 7
        max: 8
        passed: true
        comment: Shows both uptrends and downtrends, multiple reversals, yang-to-yin
          transitions
      - id: DQ-02
        name: Realistic Context
        score: 7
        max: 7
        passed: true
        comment: Stock price simulation is plausible and neutral
      - id: DQ-03
        name: Appropriate Scale
        score: 4
        max: 5
        passed: true
        comment: Price range ($83-$134) is realistic for a stock
    code_quality:
      score: 9
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 3
        max: 3
        passed: true
        comment: Linear script with imports, data, algorithm, plot, save
      - id: CQ-02
        name: Reproducibility
        score: 3
        max: 3
        passed: true
        comment: np.random.seed(42) set
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: All imports used
      - id: CQ-04
        name: No Deprecated API
        score: 1
        max: 1
        passed: true
        comment: Uses current Bokeh API
      - id: CQ-05
        name: Output Correct
        score: 0
        max: 1
        passed: false
        comment: Saves as plot.png but should verify path consistency
    library_features:
      score: 3
      max: 5
      items:
      - id: LF-01
        name: Distinctive Features
        score: 3
        max: 5
        passed: true
        comment: Uses multi_line for efficient segment rendering, Legend with LegendItem.
          Could use ColumnDataSource for better Bokeh idiom.
  verdict: APPROVED
impl_tags:
  dependencies: []
  techniques:
  - custom-legend
  patterns:
  - data-generation
  - iteration-over-groups
  dataprep: []
  styling:
  - grid-styling
