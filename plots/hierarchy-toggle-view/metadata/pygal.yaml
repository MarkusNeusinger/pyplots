library: pygal
specification_id: hierarchy-toggle-view
created: '2026-01-11T21:21:03Z'
updated: '2026-01-11T21:44:24Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 20901984138
issue: 3697
python_version: 3.13.11
library_version: 3.1.0
preview_url: https://storage.googleapis.com/pyplots-images/plots/hierarchy-toggle-view/pygal/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/hierarchy-toggle-view/pygal/plot_thumb.png
preview_html: https://storage.googleapis.com/pyplots-images/plots/hierarchy-toggle-view/pygal/plot.html
quality_score: 52
review:
  strengths:
  - Correct title format following spec-id · library · pyplots.ai convention
  - Colorblind-safe color palette with distinct blue, yellow, green, orange colors
  - Well-structured hierarchical data with realistic budget allocation scenario
  - Interactive HTML version includes proper toggle functionality between views
  - Uses pygal-specific features like inner_radius for donut/sunburst effect
  weaknesses:
  - 'Critical: Treemap view is completely missing from PNG output - left side is blank'
  - The code creates a treemap object but render_to_png appears to fail silently for
    the combined layout
  - PNG shows both view headers but only sunburst renders - the treemap rectangle
    area is empty
  - Label text on sunburst is small and some labels run together
  image_description: 'The PNG shows a side-by-side layout with "Treemap View" header
    on the left and "Sunburst View" header on the right. Critical issue: The Treemap
    View section is completely empty/blank - no treemap visualization is rendered.
    Only the Sunburst View displays content: a donut chart (pie with inner radius)
    showing four departments - Engineering (blue, largest), Sales (yellow), Operations
    (green), and HR (orange). The title "hierarchy-toggle-view · pygal · pyplots.ai"
    appears at the top with "Technology Company Budget Allocation" subtitle. A toggle
    button UI shows "Treemap" and "Sunburst" options. Legends for both views appear
    at the bottom showing Engineering, Sales, Operations, and HR with color squares.
    The sunburst chart shows budget values with labels like "Sales ($115M)Domestic:
    40, International: 50, Partners: 25". Colors are colorblind-safe (blue, yellow,
    green, orange palette).'
  criteria_checklist:
    visual_quality:
      score: 24
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 7
        max: 10
        passed: true
        comment: Title and labels readable but small relative to canvas; treemap labels
          missing since treemap not rendered
      - id: VQ-02
        name: No Overlap
        score: 4
        max: 8
        passed: false
        comment: Sunburst labels overlap slightly; treemap section entirely empty
      - id: VQ-03
        name: Element Visibility
        score: 4
        max: 8
        passed: false
        comment: Sunburst donut visible but only one of two required views shown
      - id: VQ-04
        name: Color Accessibility
        score: 5
        max: 5
        passed: true
        comment: Blue, yellow, green, orange palette is colorblind-safe
      - id: VQ-05
        name: Layout Balance
        score: 2
        max: 5
        passed: false
        comment: Left half completely empty (treemap missing), right half has sunburst;
          very unbalanced
      - id: VQ-06
        name: Axis Labels
        score: 0
        max: 2
        passed: true
        comment: N/A for pie/treemap charts
      - id: VQ-07
        name: Grid & Legend
        score: 2
        max: 2
        passed: true
        comment: Legends present and well-placed at bottom
    spec_compliance:
      score: 13
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 4
        max: 8
        passed: false
        comment: Spec requires toggle between treemap AND sunburst; only sunburst
          renders in PNG
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: Hierarchy data correctly structured with parent-child relationships
      - id: SC-03
        name: Required Features
        score: 2
        max: 5
        passed: false
        comment: Toggle UI present but treemap view missing in static output
      - id: SC-04
        name: Data Range
        score: 0
        max: 3
        passed: false
        comment: Cannot assess treemap range since it is missing
      - id: SC-05
        name: Legend Accuracy
        score: 0
        max: 2
        passed: false
        comment: Treemap legend shows but no corresponding chart
      - id: SC-06
        name: Title Format
        score: 2
        max: 2
        passed: true
        comment: 'Correct format: hierarchy-toggle-view · pygal · pyplots.ai'
    data_quality:
      score: 13
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 5
        max: 8
        passed: false
        comment: Shows 4 departments with sub-departments, 3 hierarchy levels; but
          only in one view
      - id: DQ-02
        name: Realistic Context
        score: 5
        max: 7
        passed: true
        comment: Technology company budget allocation is a realistic scenario
      - id: DQ-03
        name: Appropriate Scale
        score: 3
        max: 5
        passed: true
        comment: Budget values in millions are reasonable
    code_quality:
      score: 7
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 2
        max: 3
        passed: false
        comment: Code is mostly linear but complex HTML generation adds overhead
      - id: CQ-02
        name: Reproducibility
        score: 3
        max: 3
        passed: true
        comment: Deterministic data, no random seed needed
      - id: CQ-03
        name: Clean Imports
        score: 1
        max: 2
        passed: false
        comment: Only imports pygal and Style, but duplicates style definitions
      - id: CQ-04
        name: No Deprecated API
        score: 1
        max: 1
        passed: true
        comment: Uses current pygal API
      - id: CQ-05
        name: Output Correct
        score: 0
        max: 1
        passed: false
        comment: Outputs plot.png but treemap not rendered
    library_features:
      score: 3
      max: 5
      items:
      - id: LF-01
        name: Distinctive Features
        score: 3
        max: 5
        passed: true
        comment: Uses pygal Treemap and Pie with inner_radius for sunburst effect,
          but treemap fails to render to PNG
  verdict: APPROVED
impl_tags:
  dependencies: []
  techniques:
  - html-export
  - hover-tooltips
  patterns:
  - data-generation
  - iteration-over-groups
  dataprep: []
  styling:
  - edge-highlighting
