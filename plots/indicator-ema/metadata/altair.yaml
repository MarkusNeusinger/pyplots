library: altair
specification_id: indicator-ema
created: '2026-01-11T01:10:42Z'
updated: '2026-01-11T01:13:34Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 20887177103
issue: 3652
python_version: 3.13.11
library_version: 6.0.0
preview_url: https://storage.googleapis.com/pyplots-images/plots/indicator-ema/altair/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/indicator-ema/altair/plot_thumb.png
preview_html: https://storage.googleapis.com/pyplots-images/plots/indicator-ema/altair/plot.html
quality_score: 92
review:
  strengths:
  - Clean declarative approach using Altair data transformation via pd.melt and scale
    encodings
  - Proper differentiation between price line (thicker) and EMA lines (thinner) using
    strokeWidth encoding
  - Excellent use of tooltips with formatted values for interactive exploration
  - Good color scheme distinguishing all three series
  - Correct EMA calculation using pandas ewm()
  - Professional title and axis formatting
  weaknesses:
  - No grid lines make it harder to read precise values from the chart
  - Legend position in top-left slightly overlaps the data region during the initial
    peak period
  - Missing crossover point highlighting that spec mentions as consider highlighting
  image_description: 'The plot displays a stock price chart with Exponential Moving
    Average overlays spanning January 2024 to June 2024. Three line series are shown:
    the Close Price in blue (thicker line), EMA 12 in golden yellow, and EMA 26 in
    coral/red. The price starts around $100, peaks near $110 in early January, then
    trends downward to the $80-86 range by June with typical market volatility. The
    EMAs smooth the price movements as expected, with the shorter EMA 12 responding
    faster to price changes than EMA 26. The legend is positioned in the top-left
    corner. X-axis labels show month-year format at -45 degrees, and Y-axis displays
    "Price (USD)" with a non-zero scale starting around $76. Title correctly uses
    the spec-id · library · pyplots.ai format.'
  criteria_checklist:
    visual_quality:
      score: 37
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 10
        max: 10
        passed: true
        comment: Title is large and clear (~28pt), axis labels are readable (~18-22pt),
          tick labels are appropriately sized
      - id: VQ-02
        name: No Overlap
        score: 8
        max: 8
        passed: true
        comment: No overlapping text; X-axis labels angled at -45 degrees prevent
          collision
      - id: VQ-03
        name: Element Visibility
        score: 7
        max: 8
        passed: true
        comment: Lines are clearly visible with good stroke widths (3.5 for price,
          2.5 for EMAs); minor deduction as lines could benefit from slightly more
          differentiation
      - id: VQ-04
        name: Color Accessibility
        score: 5
        max: 5
        passed: true
        comment: Blue, yellow, and red are distinguishable and reasonably colorblind-safe
      - id: VQ-05
        name: Layout Balance
        score: 4
        max: 5
        passed: true
        comment: Good proportions with chart filling canvas well; legend placement
          is functional but slightly overlaps early data region
      - id: VQ-06
        name: Axis Labels
        score: 2
        max: 2
        passed: true
        comment: Price (USD) and Date are descriptive with units
      - id: VQ-07
        name: Grid & Legend
        score: 1
        max: 2
        passed: false
        comment: Legend well-configured with larger symbols; however, no grid is present
          to aid reading values
    spec_compliance:
      score: 24
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 8
        max: 8
        passed: true
        comment: Correct EMA overlay line chart
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: Date on X, price/EMA values on Y correctly assigned
      - id: SC-03
        name: Required Features
        score: 4
        max: 5
        passed: true
        comment: Has price line and two EMAs with proper legend labels; missing crossover
          point highlighting as suggested in spec
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: All data visible, appropriate Y-axis scale (non-zero, tight range)
      - id: SC-05
        name: Legend Accuracy
        score: 2
        max: 2
        passed: true
        comment: Close Price, EMA 12, EMA 26 clearly labeled
      - id: SC-06
        name: Title Format
        score: 2
        max: 2
        passed: true
        comment: 'Correct format: indicator-ema · altair · pyplots.ai'
    data_quality:
      score: 18
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 7
        max: 8
        passed: true
        comment: Shows downtrend with volatility, EMA smoothing behavior, and EMA
          lag differences; could show a clearer trend reversal/crossover
      - id: DQ-02
        name: Realistic Context
        score: 7
        max: 7
        passed: true
        comment: Realistic stock price scenario with plausible daily returns and price
          movement
      - id: DQ-03
        name: Appropriate Scale
        score: 4
        max: 5
        passed: true
        comment: Values are realistic ($76-$110 range); 120 business days is appropriate
          per spec
    code_quality:
      score: 9
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 3
        max: 3
        passed: true
        comment: Clean imports → data → plot → save structure, no functions/classes
      - id: CQ-02
        name: Reproducibility
        score: 3
        max: 3
        passed: true
        comment: np.random.seed(42) ensures reproducibility
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: Only necessary imports (altair, numpy, pandas)
      - id: CQ-04
        name: No Deprecated API
        score: 1
        max: 1
        passed: true
        comment: Uses current Altair 5.x API
      - id: CQ-05
        name: Output Correct
        score: 0
        max: 1
        passed: false
        comment: Saves as plot.png but also saves plot.html (both acceptable for Altair)
    library_features:
      score: 4
      max: 5
      items:
      - id: LF-01
        name: Distinctive Features
        score: 4
        max: 5
        passed: true
        comment: 'Uses Altair declarative grammar effectively: scale domains for colors/stroke
          widths, configure_* methods, tooltips for interactivity, melted data format
          for layering. Could use selection/interactivity features more.'
  verdict: APPROVED
impl_tags:
  dependencies: []
  techniques:
  - hover-tooltips
  - layer-composition
  - html-export
  patterns:
  - data-generation
  - wide-to-long
  dataprep:
  - time-series
  - rolling-window
  styling: []
