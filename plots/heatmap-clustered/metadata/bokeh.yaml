library: bokeh
specification_id: heatmap-clustered
created: '2025-12-26T15:43:08Z'
updated: '2025-12-26T15:53:17Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 20524969738
issue: 0
python_version: 3.13.11
library_version: 3.8.1
preview_url: https://storage.googleapis.com/pyplots-images/plots/heatmap-clustered/bokeh/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/heatmap-clustered/bokeh/plot_thumb.png
preview_html: https://storage.googleapis.com/pyplots-images/plots/heatmap-clustered/bokeh/plot.html
quality_score: 91
review:
  strengths:
  - Excellent implementation of hierarchical clustering with dendrograms on both axes
  - Clean dendrogram rendering with proper coordinate transformation
  - Realistic gene expression dataset with biologically meaningful patterns (tumor
    vs normal)
  - Good use of Bokeh layout system to compose multiple figures
  - Proper diverging colormap (RdBu11) centered at zero for expression data
  - Clear visual separation between sample clusters matches biological expectations
  weaknesses:
  - Missing hover tooltips showing gene name, sample name, and exact value (key Bokeh
    interactive feature)
  - Colorbar title is rotated 90 degrees making it harder to read
  image_description: The plot displays a clustered heatmap showing gene expression
    data with 20 genes (rows) and 15 samples (columns). Hierarchical clustering dendrograms
    are present on both the left side (row dendrogram) and top (column dendrogram),
    rendered in blue (#306998). The heatmap uses a diverging RdBu colormap with red
    representing positive expression values (up to +3.0) and blue representing negative
    values (down to -3.0). Gene names (TNF, IL1B, CXCL8, IL6, IFNG, MYC, EGFR, ENO1,
    PKM, GAPDH, LDHA, HK2, TP53, VEGFA, PLK1, BRCA1, BUB1, CDK1, CCNB1, AURKA) are
    labeled on the right side. Sample names (N2_D through T2_A) are displayed at the
    bottom at a 45-degree angle. A vertical colorbar on the far right shows "Expression
    (z-score)" with tick marks. The title "heatmap-clustered · bokeh · pyplots.ai"
    appears at the top center. Clear cluster structure is visible - tumor samples
    (T prefix) cluster together on the right showing predominantly red (upregulated),
    while normal samples (N prefix) cluster on the left showing predominantly blue
    (downregulated).
  criteria_checklist:
    visual_quality:
      score: 36
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 9
        max: 10
        passed: true
        comment: Title, gene labels, sample labels, and colorbar text are all readable.
          Sample labels at 45° angle are clear. Slightly smaller than ideal for the
          canvas size.
      - id: VQ-02
        name: No Overlap
        score: 8
        max: 8
        passed: true
        comment: No overlapping text elements. Gene labels are well-spaced, sample
          labels don't overlap.
      - id: VQ-03
        name: Element Visibility
        score: 8
        max: 8
        passed: true
        comment: Heatmap cells are clearly visible with appropriate sizing. Dendrogram
          lines are visible and well-rendered.
      - id: VQ-04
        name: Color Accessibility
        score: 4
        max: 5
        passed: true
        comment: RdBu diverging colormap is generally colorblind-friendly (red-blue
          distinction). Good choice for centered data.
      - id: VQ-05
        name: Layout Balance
        score: 4
        max: 5
        passed: true
        comment: 'Good layout with dendrograms, heatmap, and colorbar well-proportioned.
          Minor: some empty space in corners.'
      - id: VQ-06
        name: Axis Labels
        score: 2
        max: 2
        passed: true
        comment: '"Samples" and "Genes" axis labels present with bold styling. Colorbar
          has "Expression (z-score)" with units.'
      - id: VQ-07
        name: Grid & Legend
        score: 1
        max: 2
        passed: true
        comment: Colorbar is well-placed. White gridlines between cells are subtle.
          No legend needed for this plot type.
    spec_compliance:
      score: 25
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 8
        max: 8
        passed: true
        comment: Correct clustered heatmap with dendrograms
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: Genes on rows, samples on columns, expression values in cells
      - id: SC-03
        name: Required Features
        score: 5
        max: 5
        passed: true
        comment: Dendrograms on both rows and columns, reordered data, diverging colormap,
          colorbar legend
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: Full data range visible (-3 to +3 z-scores)
      - id: SC-05
        name: Legend Accuracy
        score: 2
        max: 2
        passed: true
        comment: Colorbar correctly shows expression z-score values
      - id: SC-06
        name: Title Format
        score: 2
        max: 2
        passed: true
        comment: 'Correct format: "heatmap-clustered · bokeh · pyplots.ai"'
    data_quality:
      score: 18
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 7
        max: 8
        passed: true
        comment: Shows clear cluster structure with tumor vs normal separation. Demonstrates
          gene groupings by function. Could show more within-cluster variation.
      - id: DQ-02
        name: Realistic Context
        score: 7
        max: 7
        passed: true
        comment: Gene expression analysis is a canonical use case. Gene names are
          real (CDK1, GAPDH, TP53, etc.). Sample naming (T=tumor, N=normal) is realistic.
      - id: DQ-03
        name: Appropriate Scale
        score: 4
        max: 5
        passed: true
        comment: Z-scores from -3 to +3 are appropriate for expression data. Most
          values fall within expected range.
    code_quality:
      score: 9
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 3
        max: 3
        passed: true
        comment: 'Linear script structure: imports → data → clustering → plotting
          → save'
      - id: CQ-02
        name: Reproducibility
        score: 3
        max: 3
        passed: true
        comment: np.random.seed(42) is set
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: All imports are used
      - id: CQ-04
        name: No Deprecated API
        score: 0
        max: 1
        passed: false
        comment: Uses CDN resource which is not deprecated but could be simplified
      - id: CQ-05
        name: Output Correct
        score: 1
        max: 1
        passed: true
        comment: Saves as plot.png and plot.html
    library_features:
      score: 3
      max: 5
      items:
      - id: LF-01
        name: Uses distinctive library features
        score: 3
        max: 5
        passed: true
        comment: Uses Bokeh's ColumnDataSource, ColorBar, figure layouts, and multi-figure
          composition. However, doesn't leverage Bokeh's interactive features (hover
          tooltips would be valuable for heatmaps).
  verdict: APPROVED
