library: pygal
specification_id: line-impurity-comparison
created: '2026-02-17T18:55:53Z'
updated: '2026-02-17T19:07:59Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 22111342471
issue: 4133
python_version: 3.14.3
library_version: 3.1.0
preview_url: https://storage.googleapis.com/pyplots-images/plots/line-impurity-comparison/pygal/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/line-impurity-comparison/pygal/plot_thumb.png
preview_html: https://storage.googleapis.com/pyplots-images/plots/line-impurity-comparison/pygal/plot.html
quality_score: 78
review:
  strengths:
  - Explicit font sizing across all text elements produces excellent legibility at
    4800x2700
  - Clean blue/orange color palette is colorblind-safe and visually harmonious
  - Correct mathematical computation with proper handling of edge cases (np.errstate,
    nan_to_num)
  - 'Good use of pygal-specific features: cubic interpolation, per-series stroke_style,
    legend column layout'
  - Subtle grid styling with dashed guides and contrasting plot background
  weaknesses:
  - The annotation at the Gini peak (0.5, 0.5) label text is not visible in the rendered
    PNG — only the dot appears. The entropy peak at (0.5, 1.0) is not annotated at
    all. Spec requires annotating the maximum impurity point where both curves peak.
  - The Max impurity (p = 0.5) vertical line is rendered as a third data series in
    the legend, which is misleading — it should be visually distinguished as an annotation,
    not a data series.
  - Data storytelling is weak — the key insight that both curves peak at p=0.5 but
    at different heights (showing Gini is a scaled approximation of entropy) is not
    communicated visually.
  - Bottom legend area creates excess whitespace; the three-item legend with a fake
    series is cluttered.
  image_description: 'The plot displays two smooth curves on a white canvas with a
    light gray (#fafafa) plot background. The blue curve (Gini: 2p(1−p)) forms a parabola
    peaking at 0.5 at p=0.5. The orange curve (Entropy: −p log₂p − (1−p) log₂(1−p))
    forms a taller arch peaking at 1.0 at p=0.5. A gray dashed vertical line marks
    p=0.5 with dots at its endpoints (0,0) and (0.5,1.0). A small blue dot marks the
    Gini peak at (0.5, 0.5). The title "line-impurity-comparison · pygal · pyplots.ai"
    appears at top. The X-axis is labeled "Probability p (range 0 to 1)" with tick
    marks at 0, 0.2, 0.4, 0.5, 0.6, 0.8, 1.0. The Y-axis is labeled "Impurity Measure
    (normalized)" with matching ticks. A bottom legend shows three items: "Gini: 2p(1−p)"
    (blue), "Entropy: −p log₂p − (1−p) log₂(1−p)" (orange), and "Max impurity (p =
    0.5)" (gray). Horizontal grid lines are subtle dashed gray. Overall layout is
    clean with generous margins.'
  criteria_checklist:
    visual_quality:
      score: 24
      max: 30
      items:
      - id: VQ-01
        name: Text Legibility
        score: 8
        max: 8
        passed: true
        comment: All font sizes explicitly set (title 74pt, labels 48pt, major labels
          44pt, legend 42pt). Perfectly readable.
      - id: VQ-02
        name: No Overlap
        score: 6
        max: 6
        passed: true
        comment: No overlapping text elements anywhere.
      - id: VQ-03
        name: Element Visibility
        score: 5
        max: 6
        passed: false
        comment: Lines well-sized at stroke width 8. Gini peak annotation dot is small
          relative to the large canvas.
      - id: VQ-04
        name: Color Accessibility
        score: 3
        max: 4
        passed: false
        comment: Blue/orange palette is colorblind-safe. Gray dashed vertical line
          has low contrast against light background.
      - id: VQ-05
        name: Layout & Canvas
        score: 2
        max: 4
        passed: false
        comment: Plot area fills reasonable portion but large bottom margin for legend
          creates wasted space. X-axis tick labels appear faint.
      - id: VQ-06
        name: Axis Labels & Title
        score: 2
        max: 2
        passed: true
        comment: Both axes have descriptive labels with context.
    design_excellence:
      score: 12
      max: 20
      items:
      - id: DE-01
        name: Aesthetic Sophistication
        score: 6
        max: 8
        passed: false
        comment: Custom color palette, intentional typography hierarchy, clean professional
          appearance. Above defaults but not publication-flagship.
      - id: DE-02
        name: Visual Refinement
        score: 4
        max: 6
        passed: false
        comment: Subtle dashed grid, contrasting plot background, generous whitespace,
          legend at bottom. Good but could be more polished.
      - id: DE-03
        name: Data Storytelling
        score: 2
        max: 6
        passed: false
        comment: Vertical dashed line at p=0.5 provides some structure, but key insight
          that both curves peak at same point is not effectively communicated. Annotation
          labels not visible in PNG.
    spec_compliance:
      score: 12
      max: 15
      items:
      - id: SC-01
        name: Plot Type
        score: 5
        max: 5
        passed: true
        comment: Correct XY line chart showing two mathematical curves.
      - id: SC-02
        name: Required Features
        score: 3
        max: 4
        passed: false
        comment: Spec requires annotating max impurity at p=0.5 for both curves. Only
          Gini peak has a dot; entropy peak not annotated. Label text not visible
          in PNG.
      - id: SC-03
        name: Data Mapping
        score: 3
        max: 3
        passed: true
        comment: X/Y correctly assigned; probability on X, impurity on Y.
      - id: SC-04
        name: Title & Legend
        score: 1
        max: 3
        passed: false
        comment: Title format correct. But Max impurity line appears as third data
          series in legend, which is misleading.
    data_quality:
      score: 14
      max: 15
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 5
        max: 6
        passed: false
        comment: Shows both curves across full range with clear peak comparison. Could
          better emphasize region where curves are closest.
      - id: DQ-02
        name: Realistic Context
        score: 5
        max: 5
        passed: true
        comment: Standard ML educational scenario. Gini vs Entropy is a well-known
          comparison.
      - id: DQ-03
        name: Appropriate Scale
        score: 4
        max: 4
        passed: true
        comment: Mathematically correct values. Both curves properly normalized to
          [0,1].
    code_quality:
      score: 9
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 3
        max: 3
        passed: true
        comment: Clean imports → data → style → plot → save structure.
      - id: CQ-02
        name: Reproducibility
        score: 2
        max: 2
        passed: true
        comment: Deterministic mathematical functions, no randomness needed.
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: All imports used (numpy, pygal, Style).
      - id: CQ-04
        name: Code Elegance
        score: 1
        max: 2
        passed: false
        comment: Slightly verbose list comprehensions. chart.add(None, ...) with stroke_style
          width 0 is a workaround pattern.
      - id: CQ-05
        name: Output & API
        score: 1
        max: 1
        passed: true
        comment: Saves as plot.png correctly.
    library_features:
      score: 7
      max: 10
      items:
      - id: LM-01
        name: Idiomatic Usage
        score: 4
        max: 5
        passed: false
        comment: Good use of pygal XY chart, Style customization, per-series stroke_style
          overrides.
      - id: LM-02
        name: Distinctive Features
        score: 3
        max: 5
        passed: false
        comment: Uses pygal cubic interpolation, legend_at_bottom with column control,
          SVG-native rendering, and inline stroke_style per series.
  verdict: REJECTED
impl_tags:
  dependencies: []
  techniques:
  - manual-ticks
  patterns:
  - data-generation
  dataprep:
  - normalization
  styling:
  - grid-styling
