library: altair
specification_id: heatmap-correlation
created: '2025-12-26T10:03:02Z'
updated: '2025-12-26T10:06:56Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 20520464727
issue: 1948
python_version: 3.13.11
library_version: 6.0.0
preview_url: https://storage.googleapis.com/pyplots-images/plots/heatmap-correlation/altair/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/heatmap-correlation/altair/plot_thumb.png
preview_html: https://storage.googleapis.com/pyplots-images/plots/heatmap-correlation/altair/plot.html
quality_score: 92
impl_tags:
  dependencies: []
  techniques:
  - colorbar
  - annotations
  - layer-composition
  - html-export
  patterns:
  - data-generation
  - wide-to-long
  dataprep:
  - correlation-matrix
  styling: []
review:
  strengths:
  - Excellent diverging color scheme (redblue) properly centered at zero with domain
    [-1, 1]
  - Smart conditional text coloring (white on dark backgrounds, black on light) improves
    readability
  - Clean data generation approach creating valid symmetric correlation matrix
  - Good use of Altair's layered composition (heatmap + text)
  - Professional styling with white cell borders and bold fonts
  weaknesses:
  - Missing axis titles (could add "Variables" or similar descriptive label)
  - Triangle masking not implemented (spec mentions "consider masking upper or lower
    triangle")
  - Could add tooltips for interactivity since HTML is also saved
  image_description: The plot displays an 8×8 correlation matrix heatmap showing financial
    metrics (Revenue, Profit, Expenses, Employees, Market Cap, Debt, Assets, R&D Spend).
    The color scheme uses a diverging blue-white-red palette where dark red represents
    strong positive correlations (1.0), dark blue represents strong negative correlations
    (-1.0), and white/light colors represent values near zero. Each cell is annotated
    with the correlation coefficient to 2 decimal places. The title "heatmap-correlation
    · altair · pyplots.ai" appears at the top. Variable names are displayed on both
    axes with bold text. A vertical colorbar legend labeled "Correlation" appears
    on the right side ranging from -1.0 to 1.0. The diagonal shows perfect correlations
    (1.00) in dark red. The layout is square and well-balanced with white borders
    between cells.
  criteria_checklist:
    visual_quality:
      score: 36
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 10
        max: 10
        passed: true
        comment: Title is large and bold at 28pt, axis labels are 15pt bold, cell
          annotations are 14pt bold, all clearly readable
      - id: VQ-02
        name: No Overlap
        score: 8
        max: 8
        passed: true
        comment: No overlapping text, all labels and annotations are well spaced
      - id: VQ-03
        name: Element Visibility
        score: 8
        max: 8
        passed: true
        comment: Cells are appropriately sized, white borders provide clear separation
      - id: VQ-04
        name: Color Accessibility
        score: 5
        max: 5
        passed: true
        comment: Red-blue diverging colormap is colorblind-friendly (not pure red-green)
      - id: VQ-05
        name: Layout Balance
        score: 3
        max: 5
        passed: true
        comment: Good square layout but plot could fill slightly more canvas area
      - id: VQ-06
        name: Axis Labels
        score: 0
        max: 2
        passed: true
        comment: No axis titles provided (just variable names, no descriptive labels
          like "Variables")
      - id: VQ-07
        name: Grid & Legend
        score: 2
        max: 2
        passed: true
        comment: Legend well placed with appropriate sizing, white cell borders serve
          as grid
    spec_compliance:
      score: 24
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 8
        max: 8
        passed: true
        comment: Correct correlation matrix heatmap
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: Variables correctly mapped to both axes
      - id: SC-03
        name: Required Features
        score: 4
        max: 5
        passed: true
        comment: Has diverging colormap, annotations, symmetric matrix; missing optional
          triangle masking
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: Colorbar correctly fixed to -1 to 1
      - id: SC-05
        name: Legend Accuracy
        score: 2
        max: 2
        passed: true
        comment: Legend clearly shows Correlation scale
      - id: SC-06
        name: Title Format
        score: 2
        max: 2
        passed: true
        comment: 'Correct format: "heatmap-correlation · altair · pyplots.ai"'
    data_quality:
      score: 19
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 7
        max: 8
        passed: true
        comment: 'Shows positive correlations (Profit-Market Cap: 0.66), negative
          correlations (Assets-Profit: -0.67), near-zero values (Employees-Market
          Cap: 0.01), diagonal 1.0s'
      - id: DQ-02
        name: Realistic Context
        score: 7
        max: 7
        passed: true
        comment: Financial metrics is a realistic scenario for correlation analysis
      - id: DQ-03
        name: Appropriate Scale
        score: 5
        max: 5
        passed: true
        comment: All correlation values are in valid -1 to 1 range with sensible relationships
    code_quality:
      score: 10
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 3
        max: 3
        passed: true
        comment: Clean imports → data → plot → save structure
      - id: CQ-02
        name: Reproducibility
        score: 3
        max: 3
        passed: true
        comment: Uses np.random.seed(42)
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: Only altair, numpy, pandas imported and used
      - id: CQ-04
        name: No Deprecated API
        score: 1
        max: 1
        passed: true
        comment: Uses current Altair API
      - id: CQ-05
        name: Output Correct
        score: 1
        max: 1
        passed: true
        comment: Saves as plot.png and plot.html
    library_features:
      score: 3
      max: 5
      items:
      - id: LF-01
        name: Uses distinctive library features
        score: 3
        max: 5
        passed: true
        comment: Uses Altair's declarative grammar with mark_rect and mark_text layering,
          conditional color encoding for text visibility, but could leverage more
          interactive features
  verdict: APPROVED
