library: letsplot
specification_id: donut-nested
created: '2025-12-25T20:03:39Z'
updated: '2025-12-25T20:05:47Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 20510190055
issue: 2015
python_version: 3.13.11
library_version: 4.8.2
preview_url: https://storage.googleapis.com/pyplots-images/plots/donut-nested/letsplot/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/donut-nested/letsplot/plot_thumb.png
preview_html: https://storage.googleapis.com/pyplots-images/plots/donut-nested/letsplot/plot.html
quality_score: 92
impl_tags:
  dependencies: []
  techniques:
  - html-export
  patterns:
  - data-generation
  - matrix-construction
  dataprep: []
  styling: []
review:
  strengths:
  - Excellent use of consistent color families per parent category (blues for Marketing,
    yellows for Operations, greens for R&D, oranges for Sales)
  - Clear visual hierarchy with bold white labels on inner ring and dark labels on
    outer ring
  - Well-proportioned spacing between rings for visual separation
  - Creative use of geom_polygon to create donut segments, demonstrating lets-plot
    flexibility
  - Center label showing total value adds informative context
  - Clean white borders between segments enhance readability
  weaknesses:
  - Uses a helper function create_wedge() which violates KISS structure guidelines
    (prefer inline code)
  - No legend provided to explain the color scheme, relying solely on segment labels
  - Outer ring labels could include percentage values for better data interpretation
  image_description: The plot displays a nested donut chart with two concentric rings.
    The inner ring shows four parent departments (Marketing in blue, Operations in
    yellow, R&D in green, Sales in orange), with bold white labels. The outer ring
    displays child expense categories for each department using lighter shades of
    the parent color family (blues for Marketing subcategories, yellows for Operations,
    greens for R&D, oranges for Sales). Each segment has a dark text label. The center
    of the donut displays "Total $100M" in bold black text. White borders separate
    segments clearly. The title "donut-nested · letsplot · pyplots.ai" appears at
    the top. The chart uses a square 1:1 aspect ratio with the donut well-centered.
  criteria_checklist:
    visual_quality:
      score: 36
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 9
        max: 10
        passed: true
        comment: 'All text is readable; inner ring labels are bold white, outer ring
          labels are dark and clear. Title is visible at top. Minor: some outer labels
          could be slightly larger.'
      - id: VQ-02
        name: No Overlap
        score: 8
        max: 8
        passed: true
        comment: No overlapping text; all labels are positioned in the middle of their
          respective arcs without collision.
      - id: VQ-03
        name: Element Visibility
        score: 8
        max: 8
        passed: true
        comment: Segments are clearly visible with good proportions; white borders
          separate segments excellently.
      - id: VQ-04
        name: Color Accessibility
        score: 5
        max: 5
        passed: true
        comment: 'Colors are distinct: blue, yellow, green, orange families with lighter
          shades for children. No red-green only distinctions.'
      - id: VQ-05
        name: Layout Balance
        score: 4
        max: 5
        passed: true
        comment: Good layout with donut well-centered. The chart uses appropriate
          canvas area (~60-70%). Slight extra whitespace at bottom.
      - id: VQ-07
        name: Grid & Legend
        score: 0
        max: 2
        passed: true
        comment: No legend provided. While segment labels are present, a legend showing
          the color-to-category mapping would help interpretation.
    spec_compliance:
      score: 25
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 8
        max: 8
        passed: true
        comment: Correct nested donut chart with two concentric rings.
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: Inner ring shows parent categories (level_1), outer ring shows children
          (level_2) as specified.
      - id: SC-03
        name: Required Features
        score: 5
        max: 5
        passed: true
        comment: 'All spec features present: hierarchical display, color families
          per parent, spacing between rings, labels on segments.'
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: All data values visible and proportionally represented.
      - id: SC-05
        name: Legend Accuracy
        score: 2
        max: 2
        passed: true
        comment: Labels directly on segments are accurate.
      - id: SC-06
        name: Title Format
        score: 2
        max: 2
        passed: true
        comment: 'Title follows exact format: "donut-nested · letsplot · pyplots.ai"'
    data_quality:
      score: 18
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 7
        max: 8
        passed: true
        comment: Shows 4 parent categories with 2-3 children each. Good variety in
          segment sizes showing different proportions. Could show percentage values
          on segments for completeness.
      - id: DQ-02
        name: Realistic Context
        score: 7
        max: 7
        passed: true
        comment: Budget allocation scenario is realistic and matches spec example
          (department totals inner, expense categories outer).
      - id: DQ-03
        name: Appropriate Scale
        score: 4
        max: 5
        passed: true
        comment: 'Total $100M is realistic for company budget. Individual values (4-18M)
          are reasonable. Minor: would benefit from showing actual percentages.'
    code_quality:
      score: 8
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 1
        max: 3
        passed: true
        comment: Uses a function `create_wedge()` which violates pure KISS structure
          (imports → data → plot → save without functions).
      - id: CQ-02
        name: Reproducibility
        score: 3
        max: 3
        passed: true
        comment: Data is deterministic (no random values), ensuring reproducibility.
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: All imports are used; no unused imports.
      - id: CQ-04
        name: No Deprecated API
        score: 1
        max: 1
        passed: true
        comment: Uses current lets-plot API.
      - id: CQ-05
        name: Output Correct
        score: 1
        max: 1
        passed: true
        comment: Saves as plot.png and plot.html correctly.
    library_features:
      score: 5
      max: 5
      items:
      - id: LF-01
        name: Distinctive Features
        score: 5
        max: 5
        passed: true
        comment: 'Good use of lets-plot''s ggplot2 grammar: geom_polygon for custom
          shapes, coord_fixed for aspect ratio, scale_fill_manual for custom colors,
          comprehensive theme customization.'
  verdict: APPROVED
