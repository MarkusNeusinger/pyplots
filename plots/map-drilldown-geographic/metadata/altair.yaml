library: altair
specification_id: map-drilldown-geographic
created: '2026-01-20T07:44:04Z'
updated: '2026-01-20T07:46:46Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 21163297410
issue: 3770
python_version: 3.13.11
library_version: 6.0.0
preview_url: https://storage.googleapis.com/pyplots-images/plots/map-drilldown-geographic/altair/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/map-drilldown-geographic/altair/plot_thumb.png
preview_html: https://storage.googleapis.com/pyplots-images/plots/map-drilldown-geographic/altair/plot.html
quality_score: 82
review:
  strengths:
  - Excellent use of Altair declarative selection mechanism for drill-down filtering
  - Clean composition using hconcat/vconcat for dashboard-style layout
  - Good tooltip implementation with formatted values
  - Proper use of TopoJSON for geographic data
  - Interactive HTML export alongside PNG
  weaknesses:
  - Missing breadcrumb navigation as specified (e.g., World > United States > California)
  - No smooth zoom transitions when drilling down - map highlights but does not zoom
  - Bottom state chart shows ALL states initially rather than filtering to selected
    region only
  - Large whitespace around the map - could better utilize canvas space
  - State labels in the detailed chart are crowded and hard to read with 51 entries
  image_description: 'The plot displays a US choropleth map on the left showing states
    colored in a blue gradient based on sales values (0-550). Alaska and Hawaii are
    shown separately in the upper-left. On the right side, two horizontal bar charts
    provide drill-down functionality: the top chart "Click to Drill Down by Region"
    shows four US regions (South in yellow, West in blue, Midwest in olive-green,
    Northeast in coral-red) with their total sales. The bottom chart "States in Selected
    Region" lists all 51 states/territories sorted by sales value in descending order
    (California at top with ~520, Wyoming at bottom with ~25). The title "map-drilldown-geographic
    · altair · pyplots.ai" appears at the top with a subtitle explaining the interaction.
    A vertical color legend on the far right shows the Sales Value scale.'
  criteria_checklist:
    visual_quality:
      score: 32
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 8
        max: 10
        passed: true
        comment: Title and most labels readable, but state names in bottom chart are
          small and crowded
      - id: VQ-02
        name: No Overlap
        score: 6
        max: 8
        passed: true
        comment: State labels in the States in Selected Region chart overlap/truncate
          due to many entries
      - id: VQ-03
        name: Element Visibility
        score: 8
        max: 8
        passed: true
        comment: Map states and bars are clearly visible with appropriate sizing
      - id: VQ-04
        name: Color Accessibility
        score: 4
        max: 5
        passed: true
        comment: Good blue color scheme for map, but region colors (yellow, red) could
          be more colorblind-friendly
      - id: VQ-05
        name: Layout Balance
        score: 3
        max: 5
        passed: true
        comment: Map is relatively small compared to canvas; large empty space around
          it
      - id: VQ-06
        name: Axis Labels
        score: 2
        max: 2
        passed: true
        comment: Descriptive labels Total Sales and Sales Value
      - id: VQ-07
        name: Grid & Legend
        score: 1
        max: 2
        passed: true
        comment: Legend present but positioned far from map; no grid needed for this
          type
    spec_compliance:
      score: 21
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 8
        max: 8
        passed: true
        comment: Correct choropleth map with drill-down interaction
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: States correctly mapped to regions, values displayed appropriately
      - id: SC-03
        name: Required Features
        score: 3
        max: 5
        passed: false
        comment: 'Has drill-down via selection, tooltips, color legend; MISSING: breadcrumb
          navigation, smooth zoom transitions'
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: Full US coverage with all states visible
      - id: SC-05
        name: Legend Accuracy
        score: 0
        max: 2
        passed: false
        comment: Legend shows continuous scale but region bar colors have no legend
          connection
      - id: SC-06
        name: Title Format
        score: 2
        max: 2
        passed: true
        comment: 'Correct format: map-drilldown-geographic · altair · pyplots.ai'
    data_quality:
      score: 17
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 6
        max: 8
        passed: true
        comment: Shows regional aggregation and state-level detail, but no city-level
          third tier as spec suggests
      - id: DQ-02
        name: Realistic Context
        score: 7
        max: 7
        passed: true
        comment: Sales data across US regions is a plausible business scenario
      - id: DQ-03
        name: Appropriate Scale
        score: 4
        max: 5
        passed: true
        comment: Values 25-520 are reasonable sales figures; could benefit from units
    code_quality:
      score: 8
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 3
        max: 3
        passed: true
        comment: 'Clean linear structure: imports → data → charts → composition →
          save'
      - id: CQ-02
        name: Reproducibility
        score: 2
        max: 3
        passed: true
        comment: Deterministic data (no random seed needed), but relies on external
          TopoJSON URL
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: Only altair and pandas imported, both used
      - id: CQ-04
        name: No Deprecated API
        score: 1
        max: 1
        passed: true
        comment: Modern Altair API used
      - id: CQ-05
        name: Output Correct
        score: 0
        max: 1
        passed: false
        comment: Saves as plot.png AND plot.html, which is appropriate for Altair
    library_features:
      score: 4
      max: 5
      items:
      - id: LF-01
        name: Distinctive Features
        score: 4
        max: 5
        passed: true
        comment: 'Good use of Altair declarative grammar: selection_point for interaction,
          transform_lookup for data joining, topo_feature for maps, condition encoding,
          hconcat/vconcat composition'
  verdict: REJECTED
impl_tags:
  dependencies: []
  techniques:
  - hover-tooltips
  - layer-composition
  - html-export
  patterns:
  - groupby-aggregation
  dataprep: []
  styling:
  - custom-colormap
  - edge-highlighting
