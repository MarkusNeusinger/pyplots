library: plotnine
specification_id: flowmap-origin-destination
created: '2026-01-16T08:07:17Z'
updated: '2026-01-16T08:09:49Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 21059785864
issue: 3765
python_version: 3.13.11
library_version: 0.15.2
preview_url: https://storage.googleapis.com/pyplots-images/plots/flowmap-origin-destination/plotnine/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/flowmap-origin-destination/plotnine/plot_thumb.png
preview_html: null
quality_score: 91
review:
  strengths:
  - Excellent visualization of global shipping flows with proper curved arcs (Bezier
    curves)
  - 'Good use of plotnine grammar of graphics: geom_polygon for basemap, geom_path
    with grouped aesthetics, scale_size_identity, scale_color_gradient, coord_fixed'
  - Color gradient from yellow to red effectively communicates flow magnitude
  - Realistic shipping route data between actual major world ports
  - Proper transparency (alpha=0.55) handles overlapping routes well
  - Clean professional appearance with appropriate theming
  weaknesses:
  - Code includes a helper function bezier_curve() which violates KISS principle (should
    be inline calculations or no functions)
  - Legend colorbar shows truncated range (~40-80) instead of full data range (22-95)
  - Grid styling could be more subtle (currently visible lines)
  image_description: The plot displays a global shipping flow map on a light blue
    ocean background with simplified gray continent polygons (North America, South
    America, Europe, Africa, Asia, Australia). Blue dots mark 15 major port cities
    (Shanghai, Singapore, Rotterdam, Los Angeles, Dubai, Hong Kong, Tokyo, New York,
    Hamburg, Busan, Santos, Mumbai, Sydney, Cape Town, Vancouver). Curved arcs (Bezier
    curves) connect origin-destination pairs, with line thickness proportional to
    flow volume and color encoded on a yellow-to-red gradient representing flow volume
    (22-95 units). The title "Global Shipping Routes · flowmap-origin-destination
    · plotnine · pyplots.ai" appears at the top in bold. Axes are labeled "Longitude
    (°)" and "Latitude (°)". A color bar legend on the right shows "Flow Volume" ranging
    from ~40 to ~80. The overall layout is well-balanced with 16:9 aspect ratio.
  criteria_checklist:
    visual_quality:
      score: 36
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 10
        max: 10
        passed: true
        comment: Title is large and bold, axis labels and tick labels are clearly
          readable
      - id: VQ-02
        name: No Overlap
        score: 8
        max: 8
        passed: true
        comment: No overlapping text elements, arcs have transparency to reduce visual
          clutter
      - id: VQ-03
        name: Element Visibility
        score: 7
        max: 8
        passed: true
        comment: Flow arcs are visible with varying thickness, alpha=0.55 helps with
          overlapping routes; some thin lines could be slightly thicker
      - id: VQ-04
        name: Color Accessibility
        score: 5
        max: 5
        passed: true
        comment: Yellow-to-red gradient is colorblind-friendly and provides good contrast
          against the blue background
      - id: VQ-05
        name: Layout Balance
        score: 5
        max: 5
        passed: true
        comment: Plot fills canvas well, balanced margins, legend positioned appropriately
      - id: VQ-06
        name: Axis Labels
        score: 1
        max: 2
        passed: false
        comment: Labels include units (°) which is good, but Longitude and Latitude
          are standard rather than context-specific
      - id: VQ-07
        name: Grid & Legend
        score: 0
        max: 2
        passed: false
        comment: Legend colorbar range shows 40-80 when actual data is 22-95, causing
          slight confusion
    spec_compliance:
      score: 24
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 8
        max: 8
        passed: true
        comment: Correct origin-destination flow map with curved arcs
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: Origin/destination coordinates correctly mapped, flow volume to line
          width and color
      - id: SC-03
        name: Required Features
        score: 4
        max: 5
        passed: false
        comment: Has curved arcs, line width proportional to flow, transparency, color
          gradient, basemap; missing location name labels on the map
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: All flows visible within the coordinate range
      - id: SC-05
        name: Legend Accuracy
        score: 2
        max: 2
        passed: true
        comment: Flow Volume legend present and correctly labeled
      - id: SC-06
        name: Title Format
        score: 2
        max: 2
        passed: true
        comment: 'Correct format: Global Shipping Routes · flowmap-origin-destination
          · plotnine · pyplots.ai'
    data_quality:
      score: 18
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 7
        max: 8
        passed: true
        comment: Shows 20 flows between 15 major ports, good variety of directions
          and distances; could benefit from showing bidirectional flows
      - id: DQ-02
        name: Realistic Context
        score: 7
        max: 7
        passed: true
        comment: Real-world shipping routes between actual major ports (Shanghai,
          Rotterdam, Los Angeles, etc.) - neutral and educational
      - id: DQ-03
        name: Appropriate Scale
        score: 4
        max: 5
        passed: true
        comment: Flow volumes 22-95 are reasonable relative units; coordinates are
          accurate for named cities
    code_quality:
      score: 8
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 1
        max: 3
        passed: false
        comment: Code includes a helper function bezier_curve() which violates the
          KISS principle of no functions/classes
      - id: CQ-02
        name: Reproducibility
        score: 3
        max: 3
        passed: true
        comment: np.random.seed(42) is set (though data is deterministic)
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: All imports are used appropriately
      - id: CQ-04
        name: No Deprecated API
        score: 1
        max: 1
        passed: true
        comment: Uses current plotnine API
      - id: CQ-05
        name: Output Correct
        score: 1
        max: 1
        passed: true
        comment: Saves as plot.png
    library_features:
      score: 5
      max: 5
      items:
      - id: LF-01
        name: Distinctive Features
        score: 5
        max: 5
        passed: true
        comment: 'Excellent use of plotnine grammar of graphics: geom_polygon for
          basemap, geom_path with grouped aesthetics, scale_size_identity, scale_color_gradient,
          coord_fixed, comprehensive theming'
  verdict: APPROVED
impl_tags:
  dependencies: []
  techniques:
  - bezier-curves
  - layer-composition
  - colorbar
  patterns:
  - data-generation
  - iteration-over-groups
  dataprep: []
  styling:
  - alpha-blending
  - custom-colormap
  - grid-styling
