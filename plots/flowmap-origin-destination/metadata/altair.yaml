library: altair
specification_id: flowmap-origin-destination
created: '2026-01-16T08:06:11Z'
updated: '2026-01-16T08:09:03Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 21059785737
issue: 3765
python_version: 3.13.11
library_version: 6.0.0
preview_url: https://storage.googleapis.com/pyplots-images/plots/flowmap-origin-destination/altair/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/flowmap-origin-destination/altair/plot_thumb.png
preview_html: https://storage.googleapis.com/pyplots-images/plots/flowmap-origin-destination/altair/plot.html
quality_score: 91
review:
  strengths:
  - Excellent implementation of curved Bezier arcs using mathematical computation
  - Clean integration of basemap from CDN using topo_feature
  - 'Good layer composition: basemap + arcs + points + labels'
  - Proper use of Altair geographic projection with clipExtent
  - Interactive tooltips enabled for exploring flow details
  - Color gradient effectively encodes flow magnitude
  - Transparency and rounded stroke caps prevent visual clutter
  weaknesses:
  - Some arc bundles overlap heavily in the London-Paris-Berlin corridor making individual
    flows hard to distinguish
  - Legend is positioned far from the main visualization in the bottom-right corner
  image_description: The plot displays an origin-destination flow map of European
    cities overlaid on a world map basemap. The map shows 10 European cities (Dublin,
    London, Amsterdam, Brussels, Berlin, Paris, Vienna, Madrid, Lisbon, Rome) connected
    by curved arcs representing migration flows. Arc thickness varies with flow magnitude,
    and color encoding uses a blue gradient ("blues" scheme) ranging from 2,189 to
    49,732. The basemap shows country boundaries in light gray (#e8e8e8) with white
    borders. City points are rendered as blue circles (#306998) with white stroke,
    and city labels appear in bold black text above each point. The title "flowmap-origin-destination
    · altair · pyplots.ai" is positioned at the top-left. A color legend for "Flow
    Volume" appears in the bottom-right corner with values from 2,189 to 49,732.
  criteria_checklist:
    visual_quality:
      score: 37
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 9
        max: 10
        passed: true
        comment: Title and city labels are clearly readable, legend text is adequate
      - id: VQ-02
        name: No Overlap
        score: 7
        max: 8
        passed: true
        comment: Minor overlap between some arc bundles in the London-Paris-Berlin
          corridor, but city labels are well-positioned
      - id: VQ-03
        name: Element Visibility
        score: 8
        max: 8
        passed: true
        comment: Arcs are well-sized with appropriate opacity (0.5), city markers
          clearly visible
      - id: VQ-04
        name: Color Accessibility
        score: 5
        max: 5
        passed: true
        comment: Blues colorscheme is colorblind-safe, good contrast against gray
          basemap
      - id: VQ-05
        name: Layout Balance
        score: 4
        max: 5
        passed: true
        comment: Good use of canvas space with Europe centered, though some empty
          space in corners
      - id: VQ-06
        name: Axis Labels
        score: 2
        max: 2
        passed: true
        comment: N/A for geographic projection; legend properly labeled Flow Volume
      - id: VQ-07
        name: Grid & Legend
        score: 2
        max: 2
        passed: true
        comment: Legend well-placed in bottom-right, basemap subtle
    spec_compliance:
      score: 24
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 8
        max: 8
        passed: true
        comment: Correct origin-destination flow map with curved arcs
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: Origin/destination coordinates correctly mapped, flow determines
          width and color
      - id: SC-03
        name: Required Features
        score: 4
        max: 5
        passed: true
        comment: Curved arcs, width proportional to flow, transparency, color gradient,
          basemap, tooltips all present. Missing optional animation
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: All cities and flows visible within the projection
      - id: SC-05
        name: Legend Accuracy
        score: 2
        max: 2
        passed: true
        comment: Flow Volume legend correctly shows flow magnitude scale
      - id: SC-06
        name: Title Format
        score: 2
        max: 2
        passed: true
        comment: 'Correct format: flowmap-origin-destination · altair · pyplots.ai'
    data_quality:
      score: 18
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 6
        max: 8
        passed: true
        comment: Shows flows from hub cities to other cities AND reverse flows. Good
          variety in flow magnitudes.
      - id: DQ-02
        name: Realistic Context
        score: 7
        max: 7
        passed: true
        comment: European migration flows between major capitals is a realistic and
          neutral scenario
      - id: DQ-03
        name: Appropriate Scale
        score: 5
        max: 5
        passed: true
        comment: Flow values 2,000-50,000 are plausible for city-to-city migration/travel
          data
    code_quality:
      score: 9
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 3
        max: 3
        passed: true
        comment: No functions or classes, follows imports → data → plot → save pattern
      - id: CQ-02
        name: Reproducibility
        score: 3
        max: 3
        passed: true
        comment: np.random.seed(42) is set
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: Only imports altair, numpy, pandas (all used)
      - id: CQ-04
        name: No Deprecated API
        score: 1
        max: 1
        passed: true
        comment: Uses current Altair API
      - id: CQ-05
        name: Output Correct
        score: 0
        max: 1
        passed: false
        comment: Saves both plot.png and plot.html - minor redundancy
    library_features:
      score: 3
      max: 5
      items:
      - id: LF-01
        name: Distinctive Features
        score: 3
        max: 5
        passed: true
        comment: Uses Altair declarative layer composition, geographic projections,
          topo_feature for basemap, and interactive tooltips
  verdict: APPROVED
impl_tags:
  dependencies: []
  techniques:
  - bezier-curves
  - layer-composition
  - hover-tooltips
  - html-export
  patterns:
  - data-generation
  - iteration-over-groups
  dataprep: []
  styling:
  - custom-colormap
  - alpha-blending
  - edge-highlighting
