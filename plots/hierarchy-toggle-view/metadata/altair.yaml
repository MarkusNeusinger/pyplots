library: altair
specification_id: hierarchy-toggle-view
created: '2026-01-11T09:30:49Z'
updated: '2026-01-11T09:35:22Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 20892893334
issue: 3697
python_version: 3.13.11
library_version: 6.0.0
preview_url: https://storage.googleapis.com/pyplots-images/plots/hierarchy-toggle-view/altair/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/hierarchy-toggle-view/altair/plot_thumb.png
preview_html: https://storage.googleapis.com/pyplots-images/plots/hierarchy-toggle-view/altair/plot.html
quality_score: 75
review:
  strengths:
  - Excellent use of Altairs declarative layering with mark_rect and mark_arc for
    both views
  - Consistent color scheme shared across both visualizations via resolve_scale
  - Interactive tooltips show team, headcount, and department on hover
  - Clean manual implementation of treemap layout algorithm without external dependencies
  - Proper sunburst construction with theta/radius encoding
  weaknesses:
  - Missing interactive toggle functionality - spec asks for toggle button to switch
    between views, but implementation shows both side by side
  - Visual imbalance - treemap is significantly larger than sunburst making them hard
    to compare
  - Sunburst lacks inner ring labels for departments - only outer ring teams are implied
    by color
  image_description: |-
    The visualization displays two side-by-side views of a company organizational structure (TechCorp Inc.) with 4 departments and 17 teams across ~21 nodes total.

    Left - Treemap View: A nested rectangle layout where area represents team headcount. Teams are organized in horizontal rows sorted by size (largest at bottom). The largest rectangles are Backend (52), Frontend (45), Enterprise (38), and Data Science (35). Colors: Engineering (blue #306998), Sales (yellow #FFD43B), Marketing (red #E74C3C), Operations (green #27AE60). White labels centered in each rectangle show team names.

    Right - Sunburst View: A two-ring radial chart with departments in the inner ring (radius 40-70) and teams in the outer ring (radius 70-100). Arc angles are proportional to headcount. The center is hollow. Same color scheme as treemap. Engineering dominates approximately 45% of the chart.

    Title: "hierarchy-toggle-view 路 altair 路 pyplots.ai" with subtitle "Company Organization: Treemap (Size Comparison) vs Sunburst (Hierarchy)". A shared legend on the right shows department colors.
  criteria_checklist:
    visual_quality:
      score: 30
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 7
        max: 10
        passed: true
        comment: Main title and labels readable but some smaller treemap labels slightly
          small
      - id: VQ-02
        name: No Overlap
        score: 8
        max: 8
        passed: true
        comment: No overlapping text elements, all labels clearly visible
      - id: VQ-03
        name: Element Visibility
        score: 6
        max: 8
        passed: true
        comment: Both views visible but sunburst feels smaller relative to treemap
      - id: VQ-04
        name: Color Accessibility
        score: 4
        max: 5
        passed: true
        comment: Good distinct colors, though yellow on white background can be hard
          to see in legend
      - id: VQ-05
        name: Layout Balance
        score: 3
        max: 5
        passed: true
        comment: Treemap much larger than sunburst creates visual imbalance
      - id: VQ-06
        name: Axis Labels
        score: 0
        max: 2
        passed: false
        comment: N/A for this chart type (no axes), but no value labels on sunburst
      - id: VQ-07
        name: Grid & Legend
        score: 2
        max: 2
        passed: true
        comment: Legend well placed and clear
    spec_compliance:
      score: 19
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 8
        max: 8
        passed: true
        comment: Correctly shows both treemap and sunburst representations
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: Values correctly mapped to area (treemap) and angle (sunburst)
      - id: SC-03
        name: Required Features
        score: 2
        max: 5
        passed: false
        comment: Missing toggle functionality - shows side-by-side instead of interactive
          toggle
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: All data visible in both views
      - id: SC-05
        name: Legend Accuracy
        score: 1
        max: 2
        passed: false
        comment: Legend accurate but only shows departments, not hierarchy
      - id: SC-06
        name: Title Format
        score: 2
        max: 2
        passed: true
        comment: 'Correct format: hierarchy-toggle-view 路 altair 路 pyplots.ai'
    data_quality:
      score: 18
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 7
        max: 8
        passed: true
        comment: Good hierarchy depth (3 levels), shows different sized teams across
          departments
      - id: DQ-02
        name: Realistic Context
        score: 7
        max: 7
        passed: true
        comment: Realistic company structure with Engineering, Sales, Marketing, Operations
      - id: DQ-03
        name: Appropriate Scale
        score: 4
        max: 5
        passed: true
        comment: Headcount values realistic (8-52 per team)
    code_quality:
      score: 8
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 2
        max: 3
        passed: true
        comment: Mostly linear flow but has multiple loops for data transformation
      - id: CQ-02
        name: Reproducibility
        score: 3
        max: 3
        passed: true
        comment: Uses np.random.seed(42)
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: Only necessary imports
      - id: CQ-04
        name: No Deprecated API
        score: 1
        max: 1
        passed: true
        comment: Modern Altair API
      - id: CQ-05
        name: Output Correct
        score: 0
        max: 1
        passed: false
        comment: Saves as plot.png and plot.html which is correct
    library_features:
      score: 5
      max: 5
      items:
      - id: LF-01
        name: Distinctive Features
        score: 5
        max: 5
        passed: true
        comment: 'Excellent use of Altair declarative grammar: hconcat, mark_rect,
          mark_arc, resolve_scale, configure_view, tooltips, and HTML export'
  verdict: REJECTED
impl_tags:
  dependencies: []
  techniques:
  - layer-composition
  - hover-tooltips
  - html-export
  patterns:
  - data-generation
  - iteration-over-groups
  dataprep: []
  styling:
  - edge-highlighting
