library: pygal
specification_id: hierarchy-toggle-view
created: '2026-01-11T10:06:23Z'
updated: '2026-01-11T10:09:09Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 20893330162
issue: 3697
python_version: 3.13.11
library_version: 3.1.0
preview_url: https://storage.googleapis.com/pyplots-images/plots/hierarchy-toggle-view/pygal/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/hierarchy-toggle-view/pygal/plot_thumb.png
preview_html: https://storage.googleapis.com/pyplots-images/plots/hierarchy-toggle-view/pygal/plot.html
quality_score: 72
review:
  strengths:
  - Creative approach using HTML with JavaScript toggle to achieve the treemap/sunburst
    switching
  - Good color palette with clear contrast between departments
  - Realistic business data scenario (company budget allocation)
  - Clean code structure following KISS principles
  - Both PNG and HTML outputs generated
  weaknesses:
  - Treemap rectangles have no visible labels - cannot identify which sub-item is
    which without hovering (only works in HTML)
  - Static PNG only shows treemap view, not the sunburst toggle capability
  - Legend text is very small relative to the large canvas size
  - Title format should be {spec-id} · {library} · pyplots.ai not Company Budget Allocation
    · hierarchy-toggle-view · pygal · pyplots.ai
  - The pie chart is labeled Sunburst View but it is actually a donut/pie chart, not
    a true sunburst (which shows hierarchical rings)
  image_description: |-
    The plot displays a treemap visualization of "Company Budget Allocation" with the title "Company Budget Allocation · hierarchy-toggle-view · pygal · pyplots.ai" at the top. The treemap shows 4 main departments represented by nested rectangles:

    - Engineering (blue/steel blue): Two large rectangles on the left side, representing Frontend, Backend, DevOps, and QA subdivisions
    - Marketing (golden yellow): Three rectangles in the upper-middle area showing Digital, Brand, and Events
    - Operations (light blue): Four rectangles in the lower-right showing HR, Finance, Legal, and Facilities
    - Product (pale yellow): Three rectangles showing Research, Design, and Analytics

    The legend at the bottom shows four categories: Engineering, Marketing, Operations, and Product with their respective color swatches. The rectangles are sized proportionally to budget values. The colors provide good contrast between categories. However, there are NO labels visible on any of the rectangles themselves - only the legend identifies the departments.
  criteria_checklist:
    visual_quality:
      score: 28
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 7
        max: 10
        passed: true
        comment: Title is readable but legend text is quite small relative to canvas
          size
      - id: VQ-02
        name: No Overlap
        score: 8
        max: 8
        passed: true
        comment: No overlapping text elements
      - id: VQ-03
        name: Element Visibility
        score: 4
        max: 8
        passed: false
        comment: Rectangles visible but NO labels on individual treemap cells - cannot
          identify sub-items
      - id: VQ-04
        name: Color Accessibility
        score: 5
        max: 5
        passed: true
        comment: Good color contrast, blue/yellow palette is colorblind-friendly
      - id: VQ-05
        name: Layout Balance
        score: 3
        max: 5
        passed: true
        comment: Treemap fills most of canvas but legend is tiny and isolated at bottom
      - id: VQ-06
        name: Axis Labels
        score: 0
        max: 2
        passed: false
        comment: N/A for treemap, but sub-item labels are missing from the visualization
      - id: VQ-07
        name: Grid & Legend
        score: 1
        max: 2
        passed: true
        comment: Legend present but very small, no grid needed
    spec_compliance:
      score: 18
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 6
        max: 8
        passed: true
        comment: Treemap is correct for static PNG; spec requires toggle between treemap
          AND sunburst - only treemap shown in PNG
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: Values correctly mapped to rectangle areas
      - id: SC-03
        name: Required Features
        score: 2
        max: 5
        passed: false
        comment: 'Missing: toggle functionality not visible in static image, no node
          labels visible, hierarchy depth not clearly shown'
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: All data visible
      - id: SC-05
        name: Legend Accuracy
        score: 2
        max: 2
        passed: true
        comment: Legend correctly identifies departments
      - id: SC-06
        name: Title Format
        score: 0
        max: 2
        passed: false
        comment: Title uses Company Budget Allocation as prefix instead of just spec-id
          format
    data_quality:
      score: 17
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 6
        max: 8
        passed: true
        comment: Shows 4 departments with sub-items, but hierarchy visualization is
          limited (only 2 levels clearly visible)
      - id: DQ-02
        name: Realistic Context
        score: 7
        max: 7
        passed: true
        comment: Company budget allocation is a realistic, neutral business scenario
      - id: DQ-03
        name: Appropriate Scale
        score: 4
        max: 5
        passed: true
        comment: Budget values are realistic (180K-520K range)
    code_quality:
      score: 9
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 3
        max: 3
        passed: true
        comment: Clean imports → data → plot → save structure
      - id: CQ-02
        name: Reproducibility
        score: 3
        max: 3
        passed: true
        comment: Data is hardcoded (deterministic), no random seed needed
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: Only pygal and Style imported
      - id: CQ-04
        name: No Deprecated API
        score: 1
        max: 1
        passed: true
        comment: Uses current pygal API
      - id: CQ-05
        name: Output Correct
        score: 0
        max: 1
        passed: false
        comment: Saves both plot.png AND plot.html (good), but PNG lacks labels
    library_features:
      score: 0
      max: 5
      items:
      - id: LF-01
        name: Distinctive Features
        score: 0
        max: 5
        passed: false
        comment: pygal Treemap is used but does not show value labels on rectangles.
          HTML toggle is custom JavaScript, not a pygal feature.
  verdict: REJECTED
impl_tags:
  dependencies: []
  techniques:
  - html-export
  - hover-tooltips
  patterns:
  - iteration-over-groups
  dataprep: []
  styling: []
