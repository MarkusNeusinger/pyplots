library: letsplot
specification_id: bar-permutation-importance
created: '2025-12-31T10:56:21Z'
updated: '2025-12-31T11:20:08Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 20617503531
issue: 2998
python_version: 3.13.11
library_version: 4.8.2
preview_url: https://storage.googleapis.com/pyplots-images/plots/bar-permutation-importance/letsplot/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/bar-permutation-importance/letsplot/plot_thumb.png
preview_html: https://storage.googleapis.com/pyplots-images/plots/bar-permutation-importance/letsplot/plot.html
quality_score: 91
impl_tags:
  dependencies: []
  techniques:
  - html-export
  patterns:
  - data-generation
  dataprep: []
  styling: []
review:
  strengths:
  - Excellent visual clarity with well-sized text and properly spaced bars
  - Color gradient from yellow to blue effectively emphasizes importance ranking
  - Error bars are clearly visible and informative with appropriate styling
  - Realistic credit/lending domain data that demonstrates the plot type well
  - Clean, KISS-compliant code structure with proper reproducibility seed
  - Good use of lets-plot grammar of graphics with theme_minimal and scale_fill_gradient
  weaknesses:
  - The vertical reference line at x=0 is not rendering correctly with coord_flip()
    - geom_vline with xintercept=0 creates a horizontal line instead of vertical after
    the coordinate flip
  - HTML output could leverage lets-plot interactivity features like tooltips
  image_description: The plot displays a horizontal bar chart showing permutation
    feature importance for 15 features from a credit/lending machine learning model.
    The bars are colored using a gradient from yellow (low importance) to blue (high
    importance). Income Level has the highest importance (~0.15), followed by Credit
    Score (~0.12), Employment Years (~0.09), and so on down to Region Code (near zero/slightly
    negative). Each bar has black error bars showing the standard deviation. A dashed
    gray vertical reference line is visible at x=0. The y-axis shows feature names
    (Feature), and the x-axis shows "Mean Decrease in Model Score". The title reads
    "bar-permutation-importance · letsplot · pyplots.ai". The plot uses a minimal
    theme with subtle gray gridlines.
  criteria_checklist:
    visual_quality:
      score: 36
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 9
        max: 10
        passed: true
        comment: 'Title, axis labels, and tick labels are all readable at full size.
          Font sizes are well-chosen (24pt title, 20pt axis labels, 16/14pt tick labels).
          Minor: y-axis labels could be slightly larger.'
      - id: VQ-02
        name: No Overlap
        score: 8
        max: 8
        passed: true
        comment: No overlapping text anywhere. Feature names are well-spaced.
      - id: VQ-03
        name: Element Visibility
        score: 8
        max: 8
        passed: true
        comment: Bars are clearly visible with good width (0.7) and alpha (0.9). Error
          bars are distinct with appropriate width and color.
      - id: VQ-04
        name: Color Accessibility
        score: 5
        max: 5
        passed: true
        comment: Yellow-to-blue gradient is colorblind-safe, good contrast.
      - id: VQ-05
        name: Layout Balance
        score: 4
        max: 5
        passed: true
        comment: 'Plot fills canvas well; minor: some whitespace on the right side.'
      - id: VQ-06
        name: Axis Labels
        score: 2
        max: 2
        passed: true
        comment: 'Descriptive labels: "Feature" and "Mean Decrease in Model Score".'
      - id: VQ-07
        name: Grid & Legend
        score: 0
        max: 2
        passed: true
        comment: Grid is subtle and appropriate. Legend is hidden (guide="none") which
          is correct since color encodes the same variable as bar length. However,
          the dashed reference line at x=0 is positioned incorrectly - it appears
          as a horizontal line across the plot rather than a vertical line at x=0
          on the importance axis.
    spec_compliance:
      score: 23
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 8
        max: 8
        passed: true
        comment: Correct horizontal bar chart for permutation importance.
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: Features on y-axis, importance mean on x-axis with error bars.
      - id: SC-03
        name: Required Features
        score: 4
        max: 5
        passed: true
        comment: Has sorted bars, error bars, color gradient, but the vertical reference
          line at x=0 is not rendering correctly (appears as horizontal dashed line).
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: All data visible, shows full range including negative values.
      - id: SC-05
        name: Legend Accuracy
        score: 2
        max: 2
        passed: true
        comment: No legend needed, color gradient is self-explanatory with sorted
          bars.
      - id: SC-06
        name: Title Format
        score: 2
        max: 2
        passed: true
        comment: 'Correct format: "bar-permutation-importance · letsplot · pyplots.ai"'
    data_quality:
      score: 20
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 8
        max: 8
        passed: true
        comment: Shows 15 features with varying importance levels, includes positive
          and near-zero/negative values, varying error bar sizes.
      - id: DQ-02
        name: Realistic Context
        score: 7
        max: 7
        passed: true
        comment: Credit/lending scenario is realistic and neutral. Feature names make
          domain sense.
      - id: DQ-03
        name: Appropriate Scale
        score: 5
        max: 5
        passed: true
        comment: Importance values (0-0.15) are realistic for permutation importance
          output.
    code_quality:
      score: 9
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 3
        max: 3
        passed: true
        comment: 'Simple linear structure: imports → data → plot → save.'
      - id: CQ-02
        name: Reproducibility
        score: 3
        max: 3
        passed: true
        comment: np.random.seed(42) set.
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: All imports are used.
      - id: CQ-04
        name: No Deprecated API
        score: 1
        max: 1
        passed: true
        comment: Current API usage.
      - id: CQ-05
        name: Output Correct
        score: 0
        max: 1
        passed: false
        comment: Uses path="." which works but non-standard; should just be filename
          only for cleaner approach.
    library_features:
      score: 3
      max: 5
      items:
      - id: LF-01
        name: Uses distinctive library features
        score: 3
        max: 5
        passed: true
        comment: Uses lets-plot ggplot2-style grammar with geoms, themes, scales.
          Good use of scale_fill_gradient and theme customization. Could use more
          advanced features like tooltips for interactivity in HTML output.
  verdict: APPROVED
