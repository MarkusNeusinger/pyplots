library: altair
specification_id: line-pca-variance-cumulative
created: '2026-02-17T21:42:25Z'
updated: '2026-02-17T21:45:57Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 22116658518
issue: 4131
python_version: 3.14.3
library_version: 6.0.0
preview_url: https://storage.googleapis.com/pyplots-images/plots/line-pca-variance-cumulative/altair/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/line-pca-variance-cumulative/altair/plot_thumb.png
preview_html: https://storage.googleapis.com/pyplots-images/plots/line-pca-variance-cumulative/altair/plot.html
quality_score: 82
review:
  strengths:
  - Excellent use of real-world Wine dataset providing authentic PCA variance data
  - Idiomatic Altair layer composition combining line, points, threshold rules, and
    text labels
  - All font sizes explicitly set for readability at target resolution
  - Subtle grid styling with dashed lines at low opacity and removed view stroke
  - Tooltips provide interactive detail on hover (HTML version)
  weaknesses:
  - Threshold lines use red-green color pair (#E15759/#59A14F) which is problematic
    for colorblind users — should use colorblind-safe alternatives like blue-orange
  - No elbow point annotation or marking where the curve crosses the 90%/95% thresholds,
    which would enhance data storytelling
  - Y-axis domain 0-110 creates wasted space below the data range (~36-100%), could
    start at 20 or 30 for better canvas utilization
  - Threshold text labels on the right duplicate information already in the legend
    — choose one or the other
  - Color scale for thresholds is defined redundantly in both threshold_lines and
    threshold_text layers
  image_description: 'The plot shows a cumulative explained variance line chart for
    PCA on the Wine dataset with 13 components. A dark blue (#306998) line with filled
    circle markers (white stroke) ascends from ~36% at component 1 to ~100% at component
    13, following the classic diminishing-returns elbow pattern. Two horizontal dashed
    reference lines are present: a red dashed line at 90% and a green dashed line
    at 95%, each labeled on the right side of the chart. A legend in the upper right
    identifies the threshold colors. The title reads "line-pca-variance-cumulative
    · altair · pyplots.ai" at the top center. The x-axis is labeled "Number of Components"
    (1-13) and the y-axis "Cumulative Explained Variance (%)" (0-110). The grid uses
    subtle dashed lines with low opacity. The view border is removed.'
  criteria_checklist:
    visual_quality:
      score: 25
      max: 30
      items:
      - id: VQ-01
        name: Text Legibility
        score: 8
        max: 8
        passed: true
        comment: 'All font sizes explicitly set: title 28pt, axis labels 22pt, tick
          labels 18pt'
      - id: VQ-02
        name: No Overlap
        score: 6
        max: 6
        passed: true
        comment: No overlapping text elements anywhere
      - id: VQ-03
        name: Element Visibility
        score: 5
        max: 6
        passed: true
        comment: Line width 4 and point size 200 good for 13 data points
      - id: VQ-04
        name: Color Accessibility
        score: 2
        max: 4
        passed: false
        comment: Threshold lines use red-green color pair problematic for colorblind
          users
      - id: VQ-05
        name: Layout & Canvas
        score: 2
        max: 4
        passed: false
        comment: Y-axis domain 0-110 creates wasted space; threshold legend and text
          labels are redundant
      - id: VQ-06
        name: Axis Labels & Title
        score: 2
        max: 2
        passed: true
        comment: Descriptive labels with units on both axes
    design_excellence:
      score: 12
      max: 20
      items:
      - id: DE-01
        name: Aesthetic Sophistication
        score: 5
        max: 8
        passed: true
        comment: Python Blue line, white-stroked markers, intentional threshold colors.
          Above defaults.
      - id: DE-02
        name: Visual Refinement
        score: 4
        max: 6
        passed: true
        comment: Custom dashed grid at 0.2 opacity, removed view stroke, positioned
          threshold labels
      - id: DE-03
        name: Data Storytelling
        score: 3
        max: 6
        passed: true
        comment: Threshold lines guide component selection. No elbow annotation or
          crossing-point markers.
    spec_compliance:
      score: 14
      max: 15
      items:
      - id: SC-01
        name: Plot Type
        score: 5
        max: 5
        passed: true
        comment: Correct line plot showing cumulative variance
      - id: SC-02
        name: Required Features
        score: 3
        max: 4
        passed: false
        comment: Missing elbow point annotation (spec recommends marking it)
      - id: SC-03
        name: Data Mapping
        score: 3
        max: 3
        passed: true
        comment: X = components starting at 1, Y = cumulative variance percentage
      - id: SC-04
        name: Title & Legend
        score: 3
        max: 3
        passed: true
        comment: Title format matches spec-id · library · pyplots.ai
    data_quality:
      score: 14
      max: 15
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 5
        max: 6
        passed: true
        comment: Classic PCA curve with clear elbow region across 13 components
      - id: DQ-02
        name: Realistic Context
        score: 5
        max: 5
        passed: true
        comment: Real Wine dataset from sklearn, standard neutral scientific data
      - id: DQ-03
        name: Appropriate Scale
        score: 4
        max: 4
        passed: true
        comment: Values are correct for Wine dataset PCA
    code_quality:
      score: 9
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 3
        max: 3
        passed: true
        comment: Clean imports, data, plot, save flow
      - id: CQ-02
        name: Reproducibility
        score: 2
        max: 2
        passed: true
        comment: Deterministic real data, no random seed needed
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: All imports used
      - id: CQ-04
        name: Code Elegance
        score: 1
        max: 2
        passed: false
        comment: Color scale defined redundantly; threshold text uses fragile pixel
          positioning
      - id: CQ-05
        name: Output & API
        score: 1
        max: 1
        passed: true
        comment: Saves plot.png with scale_factor=3.0 and plot.html
    library_mastery:
      score: 8
      max: 10
      items:
      - id: LM-01
        name: Idiomatic Usage
        score: 5
        max: 5
        passed: true
        comment: 'Excellent Altair idioms: encoding types, layered composition, alt.Scale,
          alt.Axis, alt.Tooltip'
      - id: LM-02
        name: Distinctive Features
        score: 3
        max: 5
        passed: true
        comment: Layer composition and tooltip encoding are Altair-distinctive
  verdict: REJECTED
impl_tags:
  dependencies:
  - sklearn
  techniques:
  - layer-composition
  - hover-tooltips
  - html-export
  patterns:
  - dataset-loading
  dataprep:
  - pca
  - cumulative-sum
  - normalization
  styling:
  - grid-styling
  - edge-highlighting
