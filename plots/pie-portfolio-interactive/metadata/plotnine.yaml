library: plotnine
specification_id: pie-portfolio-interactive
created: '2026-01-20T23:08:25Z'
updated: '2026-01-20T23:11:16Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 21190551588
issue: 3754
python_version: 3.13.11
library_version: 0.15.2
preview_url: https://storage.googleapis.com/pyplots-images/plots/pie-portfolio-interactive/plotnine/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/pie-portfolio-interactive/plotnine/plot_thumb.png
preview_html: null
quality_score: 88
review:
  strengths:
  - Excellent creative solution for donut charts using geom_polygon in plotnine
  - Clear visual hierarchy with main allocation and drill-down detail
  - Good color choices with accessible palette
  - Clean legend design with colored squares
  - Helpful instructional text explaining the static nature of the interactive feature
  - Professional appearance with subtle background and white segment borders
  weaknesses:
  - Uses a helper function which deviates from KISS principle (though justified for
    complexity)
  - No native interactivity (expected given plotnine static nature)
  - Detail donut could be slightly larger for better balance
  image_description: 'The plot displays a dual donut chart visualization for portfolio
    allocation. On the left is the main portfolio allocation donut showing four asset
    classes: Equities (45%, blue), Fixed Income (30%, yellow/gold), Alternatives (15%,
    green), and Cash (10%, purple). The center of the main donut displays "Total $1.2M".
    On the right is a smaller secondary donut showing the Equities breakdown with
    four holdings: Tech Stocks (18%), Healthcare (12%), Financials (10%), and Energy
    (5%), all in different shades of blue. A dashed arrow connects the two donuts
    to indicate the drill-down relationship. The center of the detail donut shows
    "45% Equities". A legend at the bottom identifies the four asset classes with
    colored squares. An instructional note in gray italic text reads "Click segment
    to drill down (interactive feature shown as static example)". The background is
    a light gray (#FAFAFA), and the title follows the required format "pie-portfolio-interactive
    路 plotnine 路 pyplots.ai".'
  criteria_checklist:
    visual_quality:
      score: 35
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 9
        max: 10
        passed: true
        comment: All text readable; percentage labels are bold and clear. Title is
          large. Slightly smaller than ideal for some labels.
      - id: VQ-02
        name: No Overlap
        score: 8
        max: 8
        passed: true
        comment: No overlapping text elements; all labels are well-positioned within
          or near their segments.
      - id: VQ-03
        name: Element Visibility
        score: 7
        max: 8
        passed: true
        comment: Donut segments are clearly visible with good contrast. White borders
          separate segments nicely.
      - id: VQ-04
        name: Color Accessibility
        score: 5
        max: 5
        passed: true
        comment: Colors are distinguishable; blue/yellow/green/purple are colorblind-safe.
      - id: VQ-05
        name: Layout Balance
        score: 4
        max: 5
        passed: true
        comment: Good use of space with two donuts side by side. Slight asymmetry
          with detail donut positioned higher.
      - id: VQ-06
        name: Axis Labels
        score: 0
        max: 2
        passed: true
        comment: N/A for pie/donut charts; no axes used.
      - id: VQ-07
        name: Grid & Legend
        score: 2
        max: 2
        passed: true
        comment: Legend is clean and well-positioned at bottom; no grid needed for
          donut charts.
    spec_compliance:
      score: 23
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 8
        max: 8
        passed: true
        comment: 'Correct chart type: donut/pie chart as specified for portfolio allocation.'
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: Weights correctly mapped to segment sizes; percentages displayed
          properly.
      - id: SC-03
        name: Required Features
        score: 4
        max: 5
        passed: true
        comment: Has drill-down visualization, legend, color-coding. Missing true
          interactivity but noted as static example.
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: All data visible; percentages sum to 100%.
      - id: SC-05
        name: Legend Accuracy
        score: 2
        max: 2
        passed: true
        comment: Legend accurately labels all four asset classes with correct colors.
      - id: SC-06
        name: Title Format
        score: 2
        max: 2
        passed: true
        comment: 'Correct format: pie-portfolio-interactive 路 plotnine 路 pyplots.ai'
    data_quality:
      score: 18
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 7
        max: 8
        passed: true
        comment: Shows main allocation and drill-down breakdown; demonstrates hierarchical
          portfolio data well.
      - id: DQ-02
        name: Realistic Context
        score: 7
        max: 7
        passed: true
        comment: Portfolio allocation is a real, neutral business scenario with realistic
          asset classes.
      - id: DQ-03
        name: Appropriate Scale
        score: 4
        max: 5
        passed: true
        comment: Percentages are realistic; $1.2M is a plausible portfolio value.
    code_quality:
      score: 9
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 2
        max: 3
        passed: true
        comment: Uses a helper function for donut segment creation, deviating from
          pure flat structure but justified for complexity.
      - id: CQ-02
        name: Reproducibility
        score: 3
        max: 3
        passed: true
        comment: Uses np.random.seed(42) for reproducibility.
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: All imports are used; no unused imports.
      - id: CQ-04
        name: No Deprecated API
        score: 1
        max: 1
        passed: true
        comment: Uses current plotnine API.
      - id: CQ-05
        name: Output Correct
        score: 1
        max: 1
        passed: true
        comment: Saves as plot.png.
    library_features:
      score: 3
      max: 5
      items:
      - id: LF-01
        name: Distinctive Features
        score: 3
        max: 5
        passed: true
        comment: Uses plotnine grammar of graphics with ggplot, geom_polygon, geom_text,
          geom_segment with arrow. Heavy reliance on manual polygon construction since
          plotnine lacks native pie chart support.
  verdict: APPROVED
impl_tags:
  dependencies: []
  techniques:
  - annotations
  - patches
  - layer-composition
  patterns:
  - data-generation
  - iteration-over-groups
  dataprep: []
  styling:
  - minimal-chrome
  - alpha-blending
  - edge-highlighting
