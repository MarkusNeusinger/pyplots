library: plotnine
specification_id: hierarchy-toggle-view
created: '2026-01-11T21:04:35Z'
updated: '2026-01-11T21:13:05Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 20901764320
issue: 3697
python_version: 3.13.11
library_version: 0.15.2
preview_url: https://storage.googleapis.com/pyplots-images/plots/hierarchy-toggle-view/plotnine/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/hierarchy-toggle-view/plotnine/plot_thumb.png
preview_html: null
quality_score: 90
review:
  strengths:
  - Excellent side-by-side comparison showing both treemap and sunburst views
  - Consistent color scheme across both visualizations making comparison easy
  - Clean implementation using plotnine grammar of graphics (geom_rect for treemap,
    geom_polygon for sunburst)
  - Good text contrast (dark text on yellow, white on other colors)
  - Realistic research budget scenario with appropriate hierarchy depth
  weaknesses:
  - Some outer ring sunburst labels could be slightly larger for optimal readability
  - Cannot implement actual interactive toggle (static library limitation - acceptable)
  image_description: |-
    The plot displays a side-by-side comparison of Treemap and Sunburst visualizations for Research Department Budget Allocation.

    **Treemap View (left):** Four vertical columns represent the main divisions (Biology in blue, Chemistry in yellow, Physics in green, Computing in orange). Each column is subdivided into stacked rectangles showing subdepartments with their budget amounts (e.g., Genetics $150K, Ecology $120K, etc.). Rectangle heights are proportional to values. White text labels show department names and budgets, with dark text on yellow backgrounds for accessibility.

    **Sunburst View (right):** A radial chart with inner ring showing the 4 main divisions (Biology, Chemistry, Physics, Computing) with their total budgets, and outer ring showing the 11 subdepartments. The center displays "Total $1370K". Colors are consistent between both views - blue for Biology, yellow for Chemistry, green for Physics, orange for Computing.

    **Title:** "hierarchy-toggle-view 路 plotnine 路 pyplots.ai" in blue at top center, with subtitle "Research Department Budget Allocation" in gray below.
  criteria_checklist:
    visual_quality:
      score: 36
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 9
        max: 10
        passed: true
        comment: All text readable, good sizing. Some outer ring sunburst labels slightly
          small but acceptable.
      - id: VQ-02
        name: No Overlap
        score: 8
        max: 8
        passed: true
        comment: No overlapping text; small segments correctly omit labels.
      - id: VQ-03
        name: Element Visibility
        score: 7
        max: 8
        passed: true
        comment: Both views clearly visible with good sizing. Treemap and sunburst
          well-proportioned.
      - id: VQ-04
        name: Color Accessibility
        score: 5
        max: 5
        passed: true
        comment: Colorblind-safe palette (blue, yellow, green, orange). Good contrast.
      - id: VQ-05
        name: Layout Balance
        score: 5
        max: 5
        passed: true
        comment: Excellent side-by-side layout utilizing canvas well. Both views balanced.
      - id: VQ-06
        name: Axis Labels
        score: 0
        max: 2
        passed: true
        comment: N/A for treemap/sunburst (no axes) - no deduction appropriate.
      - id: VQ-07
        name: Grid & Legend
        score: 2
        max: 2
        passed: true
        comment: Clean theme_void, no grid needed. Colors serve as self-legend.
    spec_compliance:
      score: 23
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 8
        max: 8
        passed: true
        comment: Correctly shows both treemap and sunburst views.
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: Values correctly mapped to area (treemap) and angle (sunburst).
      - id: SC-03
        name: Required Features
        score: 4
        max: 5
        passed: true
        comment: Both views present with consistent colors. Missing actual toggle
          button (static image limitation).
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: All 11 subdepartments visible in both views.
      - id: SC-05
        name: Legend Accuracy
        score: 2
        max: 2
        passed: true
        comment: Labels correctly match data; total correctly sums to $1370K.
      - id: SC-06
        name: Title Format
        score: 2
        max: 2
        passed: true
        comment: 'Uses correct format: hierarchy-toggle-view 路 plotnine 路 pyplots.ai'
    data_quality:
      score: 18
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 7
        max: 8
        passed: true
        comment: Shows 2-level hierarchy, 4 categories with 2-3 children each. Good
          variation in values.
      - id: DQ-02
        name: Realistic Context
        score: 7
        max: 7
        passed: true
        comment: Research department budget is a realistic, neutral business scenario.
      - id: DQ-03
        name: Appropriate Scale
        score: 4
        max: 5
        passed: true
        comment: Budget values ($70K-$200K per subdepartment) are realistic for research
          budgets.
    code_quality:
      score: 9
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 3
        max: 3
        passed: true
        comment: Follows imports -> data -> plot -> save pattern. Complex but necessary
          structure.
      - id: CQ-02
        name: Reproducibility
        score: 2
        max: 3
        passed: true
        comment: Data is deterministic (hardcoded), but no np.random.seed() needed
          as no random data.
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: Only necessary imports from plotnine, numpy, pandas.
      - id: CQ-04
        name: No Deprecated API
        score: 1
        max: 1
        passed: true
        comment: Uses current plotnine API.
      - id: CQ-05
        name: Output Correct
        score: 1
        max: 1
        passed: true
        comment: Saves as plot.png.
    library_features:
      score: 4
      max: 5
      items:
      - id: LF-01
        name: Distinctive Features
        score: 4
        max: 5
        passed: true
        comment: Good use of geom_rect, geom_polygon, geom_text, scale_fill_identity,
          theme_void. Creative approach using plotnine's grammar of graphics for non-standard
          chart types.
  verdict: APPROVED
impl_tags:
  dependencies: []
  techniques:
  - annotations
  - patches
  - layer-composition
  patterns:
  - data-generation
  - iteration-over-groups
  dataprep: []
  styling:
  - minimal-chrome
  - edge-highlighting
