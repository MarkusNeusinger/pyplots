library: altair
specification_id: map-drilldown-geographic
created: '2026-01-20T07:44:04Z'
updated: '2026-01-20T08:05:40Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 21163297410
issue: 3770
python_version: 3.13.11
library_version: 6.0.0
preview_url: https://storage.googleapis.com/pyplots-images/plots/map-drilldown-geographic/altair/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/map-drilldown-geographic/altair/plot_thumb.png
preview_html: https://storage.googleapis.com/pyplots-images/plots/map-drilldown-geographic/altair/plot.html
quality_score: 72
review:
  strengths:
  - Excellent use of Altair declarative grammar with geographic projections (albersUsa)
  - Good layout composition using hconcat/vconcat for multi-panel design
  - Interactive selection properly implemented for HTML export
  - Clean code structure following KISS principles
  - Region-state hierarchy well visualized with color-coded bars
  - Tooltips provide useful drill-down information
  weaknesses:
  - Spec calls for country-state-city hierarchy but implementation only shows region-state
    level
  - Static PNG cannot demonstrate drill-down functionality (only works in HTML)
  - Breadcrumb navigation is static text, not truly clickable even in concept
  - Missing smooth zoom transitions mentioned in spec
  - Map color legend uses different scale than region bar colors, which may confuse
    viewers
  image_description: 'The plot displays a US choropleth map on the left showing sales
    data by state, colored using a blue sequential color scale (0-500+ in $K). On
    the right side is a navigation sidebar containing: (1) a breadcrumb "World > USA"
    at the top, (2) a horizontal bar chart titled "USA > Regions (click to drill down)"
    showing 4 regions (South, West, Midwest, Northeast) with distinct colors (pink,
    blue, green, yellow) and a horizontal legend, and (3) a "Top 12 States by Sales"
    vertical bar chart showing states from California (highest ~520K) to Michigan,
    colored by their region. The main title reads "map-drilldown-geographic 路 altair
    路 pyplots.ai" with subtitles explaining the hierarchical navigation. The color
    legend for the map appears in the bottom-left corner. The layout is well-balanced
    with the map taking about 60% width and the sidebar panels stacked vertically
    on the right.'
  criteria_checklist:
    visual_quality:
      score: 32
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 8
        max: 10
        passed: true
        comment: Title and most labels readable, but some smaller state labels in
          bar chart could be larger
      - id: VQ-02
        name: No Overlap
        score: 8
        max: 8
        passed: true
        comment: No overlapping text elements
      - id: VQ-03
        name: Element Visibility
        score: 6
        max: 8
        passed: true
        comment: Map choropleth visible but some lighter states hard to distinguish;
          bar charts clear
      - id: VQ-04
        name: Color Accessibility
        score: 3
        max: 5
        passed: true
        comment: Blue sequential scale good; region colors include yellow-green that
          may be challenging for some colorblind users
      - id: VQ-05
        name: Layout Balance
        score: 5
        max: 5
        passed: true
        comment: Good composition with map and sidebar well-proportioned
      - id: VQ-06
        name: Axis Labels
        score: 2
        max: 2
        passed: true
        comment: Sales ($K), Total Sales ($K) with units
      - id: VQ-07
        name: Grid & Legend
        score: 0
        max: 2
        passed: false
        comment: No grid visible on bar charts; color legend placement adequate but
          map legend title partially cut
    spec_compliance:
      score: 18
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 6
        max: 8
        passed: true
        comment: Shows hierarchical map concept but lacks true drill-down in static
          PNG
      - id: SC-02
        name: Data Mapping
        score: 4
        max: 5
        passed: true
        comment: State data mapped correctly; region hierarchy shown but not country-state-city
          as spec requires
      - id: SC-03
        name: Required Features
        score: 3
        max: 5
        passed: false
        comment: Missing city-level drill-down; breadcrumb static; no zoom transitions
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: All US states shown with complete data range
      - id: SC-05
        name: Legend Accuracy
        score: 0
        max: 2
        passed: false
        comment: Region legend colors match bars but map uses different color scale
          creating confusion
      - id: SC-06
        name: Title Format
        score: 2
        max: 2
        passed: true
        comment: Correct format map-drilldown-geographic 路 altair 路 pyplots.ai
    data_quality:
      score: 15
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 5
        max: 8
        passed: true
        comment: Shows regional hierarchy and state-level data but missing city level
      - id: DQ-02
        name: Realistic Context
        score: 7
        max: 7
        passed: true
        comment: Sales data scenario is realistic and business-relevant
      - id: DQ-03
        name: Appropriate Scale
        score: 3
        max: 5
        passed: true
        comment: Values range 25-520K which is plausible for state sales
    code_quality:
      score: 10
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 3
        max: 3
        passed: true
        comment: Clean imports-data-plot-save structure, no functions/classes
      - id: CQ-02
        name: Reproducibility
        score: 3
        max: 3
        passed: true
        comment: Deterministic data (no random seed needed since data is explicit)
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: Only altair and pandas imported, both used
      - id: CQ-04
        name: No Deprecated API
        score: 1
        max: 1
        passed: true
        comment: Uses current Altair 5.x API
      - id: CQ-05
        name: Output Correct
        score: 1
        max: 1
        passed: true
        comment: Saves as plot.png and plot.html
    library_features:
      score: 5
      max: 5
      items:
      - id: LF-01
        name: Distinctive Features
        score: 5
        max: 5
        passed: true
        comment: 'Uses Altair declarative approach: topo_feature for geographic data,
          selection_point for interactivity, vconcat/hconcat composition, tooltips,
          HTML export'
  verdict: APPROVED
impl_tags:
  dependencies: []
  techniques:
  - hover-tooltips
  - html-export
  - layer-composition
  patterns:
  - groupby-aggregation
  dataprep: []
  styling:
  - custom-colormap
  - edge-highlighting
