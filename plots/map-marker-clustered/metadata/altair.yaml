library: altair
specification_id: map-marker-clustered
created: '2026-01-20T18:49:40Z'
updated: '2026-01-20T18:52:56Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 21183361624
issue: 3766
python_version: 3.13.11
library_version: 6.0.0
preview_url: https://storage.googleapis.com/pyplots-images/plots/map-marker-clustered/altair/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/map-marker-clustered/altair/plot_thumb.png
preview_html: https://storage.googleapis.com/pyplots-images/plots/map-marker-clustered/altair/plot.html
quality_score: 91
review:
  strengths:
  - Excellent use of Altair geographic projection (albersUsa) with proper TopoJSON
    basemap
  - Well-designed clustering algorithm with hierarchical clustering for pre-computed
    static display
  - Clean color scheme using Python colors that is both visually appealing and colorblind-safe
  - Effective use of layered composition (background + clusters + labels)
  - Informative tooltips showing count, category, and coordinates
  - Good data generation with realistic store locations clustered around major US
    cities
  weaknesses:
  - Static clustering rather than dynamic zoom-based clustering as spec suggests (Altair
    limitation)
  - Uses sklearn as external dependency for clustering - could use simpler approach
    or numpy-only solution
  - Missing interactive features like click-to-zoom on clusters (Altair supports selection
    but not implemented)
  - Single-point markers lack the count label (only shown for count > 1)
  image_description: 'The plot displays a clustered marker map of the United States
    showing 500 store locations. The map uses an Albers USA projection with state
    boundaries visible in light gray (#f0f0f0) with subtle gray strokes. Cluster markers
    are displayed as circles of varying sizes, where larger circles represent more
    locations clustered together. Each cluster shows a white number indicating the
    count of locations within it. Three categories are color-coded: retail (Python
    blue #306998), food (yellow/gold #FFD43B), and services (teal #4B8BBE). The title
    "map-marker-clustered · altair · pyplots.ai" appears in the top-left with a subtitle
    "500 store locations clustered by proximity (cluster size indicates count)". A
    legend in the bottom-right corner shows the category colors. Clusters are distributed
    across all major US regions, with notable concentrations around major metropolitan
    areas like New York, Los Angeles, Chicago, Houston, Denver, Seattle, Miami, Boston,
    and Washington DC.'
  criteria_checklist:
    visual_quality:
      score: 37
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 9
        max: 10
        passed: true
        comment: Title at 28pt, subtitle at 18pt, cluster labels at 14pt bold white.
          Slightly smaller than ideal for count labels on smaller clusters.
      - id: VQ-02
        name: No Overlap
        score: 8
        max: 8
        passed: true
        comment: No overlapping text elements. Cluster markers and labels are well-separated.
      - id: VQ-03
        name: Element Visibility
        score: 7
        max: 8
        passed: true
        comment: Cluster markers well-sized with appropriate scaling. Some smaller
          single-point clusters could be slightly more visible.
      - id: VQ-04
        name: Color Accessibility
        score: 5
        max: 5
        passed: true
        comment: Blue, yellow, and teal color scheme is colorblind-safe with excellent
          contrast.
      - id: VQ-05
        name: Layout Balance
        score: 5
        max: 5
        passed: true
        comment: Map fills canvas well, legend positioned appropriately in bottom-right.
      - id: VQ-06
        name: Axis Labels
        score: 1
        max: 2
        passed: true
        comment: Map visualization has no traditional axes; geographic context provided
          by basemap.
      - id: VQ-07
        name: Grid & Legend
        score: 2
        max: 2
        passed: true
        comment: Legend well-placed and styled, basemap provides subtle geographic
          context.
    spec_compliance:
      score: 23
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 8
        max: 8
        passed: true
        comment: Correct clustered marker map visualization.
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: Lat/lon correctly mapped using Albers USA projection.
      - id: SC-03
        name: Required Features
        score: 4
        max: 5
        passed: true
        comment: Shows clusters with counts, color-coded categories, size indicates
          count. Missing dynamic zoom-based clustering and click-to-zoom.
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: All 500 points represented, US geographic extent properly shown.
      - id: SC-05
        name: Legend Accuracy
        score: 2
        max: 2
        passed: true
        comment: Legend correctly shows all three categories with accurate colors.
      - id: SC-06
        name: Title Format
        score: 1
        max: 2
        passed: true
        comment: Title follows format but uses subtitle rather than single title line.
    data_quality:
      score: 19
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 7
        max: 8
        passed: true
        comment: Shows clusters of varying sizes, multiple categories, geographic
          distribution. Could show more density variation.
      - id: DQ-02
        name: Realistic Context
        score: 7
        max: 7
        passed: true
        comment: Store location scenario is highly realistic and practical.
      - id: DQ-03
        name: Appropriate Scale
        score: 5
        max: 5
        passed: true
        comment: 500 points around 10 major US cities is realistic and appropriate.
    code_quality:
      score: 9
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 3
        max: 3
        passed: true
        comment: 'Clean flow: imports → data generation → clustering → chart creation
          → save.'
      - id: CQ-02
        name: Reproducibility
        score: 3
        max: 3
        passed: true
        comment: Uses np.random.seed(42) for deterministic results.
      - id: CQ-03
        name: Clean Imports
        score: 1
        max: 2
        passed: true
        comment: sklearn adds external dependency beyond basic requirements.
      - id: CQ-04
        name: No Deprecated API
        score: 1
        max: 1
        passed: true
        comment: Uses current Altair API.
      - id: CQ-05
        name: Output Correct
        score: 1
        max: 1
        passed: true
        comment: Saves as plot.png and plot.html.
    library_features:
      score: 3
      max: 5
      items:
      - id: LF-01
        name: Distinctive Features
        score: 3
        max: 5
        passed: true
        comment: Uses layered composition, geographic projections, tooltips, and topo_feature.
          Could leverage more interactive features.
  verdict: APPROVED
impl_tags:
  dependencies:
  - sklearn
  techniques:
  - layer-composition
  - hover-tooltips
  - annotations
  - html-export
  patterns:
  - data-generation
  - groupby-aggregation
  - iteration-over-groups
  dataprep:
  - hierarchical-clustering
  styling:
  - alpha-blending
  - edge-highlighting
