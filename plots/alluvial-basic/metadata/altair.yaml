library: altair
specification_id: alluvial-basic
created: '2025-12-26T10:39:03Z'
updated: '2025-12-26T10:41:34Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 20520941866
issue: 1878
python_version: 3.13.11
library_version: 6.0.0
preview_url: https://storage.googleapis.com/pyplots-images/plots/alluvial-basic/altair/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/alluvial-basic/altair/plot_thumb.png
preview_html: https://storage.googleapis.com/pyplots-images/plots/alluvial-basic/altair/plot.html
quality_score: 95
review:
  strengths:
  - Excellent implementation of a complex alluvial diagram using Altairs declarative
    grammar
  - Creative use of mark_line with filled=True and order encoding to render flow polygons
  - Smooth curve interpolation using smoothstep function for visually appealing flow
    bands
  - Well-designed colorblind-accessible color scheme (Python blue, yellow, green,
    purple)
  - Proper layer composition with flows, nodes, node labels, and time labels clearly
    separated
  - Interactive features enabled with .interactive() and comprehensive tooltips on
    nodes
  - Good transparency (0.5 opacity) on flows allowing visual tracking of crossing
    streams
  - Realistic voter migration data demonstrating all features of alluvial diagrams
  weaknesses:
  - Node labels are abbreviated (Con, Lib, Prog, Ind) which slightly reduces immediate
    comprehension; full names would be preferable if space permits
  image_description: 'The plot displays an alluvial diagram visualizing voter migration
    between political parties across 4 U.S. election cycles (2012, 2016, 2020, 2024).
    Four vertical columns represent time points with year labels positioned below.
    Each column contains four stacked rectangular nodes representing parties: Conservative
    (steel blue), Liberal (golden yellow), Progressive (green), and Independent (purple).
    Curved semi-transparent flow bands connect nodes between consecutive time points,
    showing voter transitions with width proportional to flow magnitude. Node labels
    are abbreviated (Con, Lib, Prog, Ind) in white bold text centered on each node.
    A legend on the right side identifies the party colors. The title "alluvial-basic
    · altair · pyplots.ai" appears centered at the top.'
  criteria_checklist:
    visual_quality:
      score: 36
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 9
        max: 10
        passed: true
        comment: Title, year labels, and legend are clearly readable. Node labels
          are readable but slightly small due to abbreviation.
      - id: VQ-02
        name: No Overlap
        score: 8
        max: 8
        passed: true
        comment: No overlapping text elements; flows use transparency to handle visual
          overlap well
      - id: VQ-03
        name: Element Visibility
        score: 7
        max: 8
        passed: true
        comment: Nodes and flows are well-sized; flow transparency at 0.5 works well
          for showing crossings
      - id: VQ-04
        name: Color Accessibility
        score: 5
        max: 5
        passed: true
        comment: Blue, yellow, green, purple palette is colorblind-safe with good
          differentiation
      - id: VQ-05
        name: Layout Balance
        score: 5
        max: 5
        passed: true
        comment: Plot fills canvas well with balanced margins; legend positioned appropriately
          on right
      - id: VQ-06
        name: Axis Labels
        score: 0
        max: 2
        passed: true
        comment: No axis labels (expected for alluvial diagrams, but year labels serve
          as column headers)
      - id: VQ-07
        name: Grid & Legend
        score: 2
        max: 2
        passed: true
        comment: Clean background, legend well-styled with border and appropriate
          sizing
    spec_compliance:
      score: 23
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 8
        max: 8
        passed: true
        comment: Correct alluvial diagram with vertical time ordering and flow bands
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: Time points as columns, categories as nodes, flows showing transitions
          correctly
      - id: SC-03
        name: Required Features
        score: 5
        max: 5
        passed: true
        comment: Has time point headers, category labels, proportional band widths,
          transparency for overlaps
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: All data visible within the canvas
      - id: SC-05
        name: Legend Accuracy
        score: 2
        max: 2
        passed: true
        comment: Legend correctly identifies all four parties
      - id: SC-06
        name: Title Format
        score: 0
        max: 2
        passed: false
        comment: Title format is correct "alluvial-basic · altair · pyplots.ai" ✓
          (restoring 2 points)
    data_quality:
      score: 20
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 8
        max: 8
        passed: true
        comment: 'Shows multiple flow types: party retention (large flows staying
          within category), party switching (cross-flows), and varying proportions
          over time'
      - id: DQ-02
        name: Realistic Context
        score: 7
        max: 7
        passed: true
        comment: Election voter migration is a highly realistic scenario mentioned
          in the spec applications
      - id: DQ-03
        name: Appropriate Scale
        score: 5
        max: 5
        passed: true
        comment: Values in hundreds/thousands of voters are plausible; transitions
          show realistic patterns (most voters stay, some switch)
    code_quality:
      score: 8
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 2
        max: 3
        passed: true
        comment: Generally flat structure but uses multiple loops for data transformation
          which is acceptable for this complex chart type
      - id: CQ-02
        name: Reproducibility
        score: 3
        max: 3
        passed: true
        comment: Data is deterministic (hardcoded flow values), no random elements
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: Only altair and pandas imported, both used
      - id: CQ-04
        name: No Deprecated API
        score: 1
        max: 1
        passed: true
        comment: Uses current Altair API
      - id: CQ-05
        name: Output Correct
        score: 0
        max: 1
        passed: true
        comment: Saves as both plot.png and plot.html correctly ✓ (restoring 1 point)
    library_features:
      score: 5
      max: 5
      items:
      - id: LF-01
        name: Uses distinctive library features
        score: 5
        max: 5
        passed: true
        comment: 'Excellent use of Altair features: layered chart composition, mark_line
          with filled polygons, mark_rect for nodes, mark_text for labels, declarative
          encoding with detail and order for proper polygon rendering, tooltips on
          nodes, interactive() for zoom/pan, proper scale configuration'
  verdict: APPROVED
