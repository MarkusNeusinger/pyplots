library: altair
specification_id: hierarchy-toggle-view
created: '2026-01-11T09:30:49Z'
updated: '2026-01-11T09:44:58Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 20892893334
issue: 3697
python_version: 3.13.11
library_version: 6.0.0
preview_url: https://storage.googleapis.com/pyplots-images/plots/hierarchy-toggle-view/altair/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/hierarchy-toggle-view/altair/plot_thumb.png
preview_html: https://storage.googleapis.com/pyplots-images/plots/hierarchy-toggle-view/altair/plot.html
quality_score: 82
review:
  strengths:
  - Successfully implements toggle functionality using Altair selection binding with
    dropdown selector
  - Clean separation of treemap and sunburst views with shared color scale
  - Excellent use of Altair declarative grammar for interactive visualization
  - Both views properly share the same data and color scheme for consistency
  - HTML export enables full interactivity in browser
  weaknesses:
  - 'Text truncation/crowding in smaller treemap cells (top row: Facilities, Events,
    Brand, Legal are hard to read)'
  - Layout does not fully utilize canvas - treemap sits in upper portion with significant
    whitespace below
  - Static PNG only shows one view - consider adding annotation about interactivity
  image_description: |-
    The static PNG shows a treemap view (the default selection) of a company organizational structure for TechCorp Inc. The treemap is positioned in the upper portion of the canvas with significant whitespace below. It displays 17 team rectangles organized in 5 horizontal rows, sorted by size (largest at bottom - Backend, Frontend, Enterprise).

    Colors used:
    - Blue (#306998) for Engineering teams (Backend, Frontend, DevOps, QA, Data Science)
    - Yellow (#FFD43B) for Sales teams (Enterprise, SMB, Partnerships)
    - Red (#E74C3C) for Marketing teams (Digital, Content, Events, Brand)
    - Green (#27AE60) for Operations teams (HR, Finance, Legal, Facilities)

    Labels: White bold text centered in each rectangle. Some labels in smaller cells appear truncated or crowded (Facilities, Events, Brand, Legal in the top row are quite small; Partnership is cut off).

    Title: "hierarchy-toggle-view 路 altair 路 pyplots.ai" with subtitle "Use dropdown to toggle between Treemap and Sunburst views".

    Legend: Department color legend positioned on the right side showing all 4 departments.

    Notable: The dropdown toggle control for switching to Sunburst view is not visible in the static PNG export (expected behavior - interactivity only works in HTML). The sunburst view, when selected via the dropdown in the HTML version, displays the same data as concentric arcs with departments in the inner ring and teams in the outer ring.
  criteria_checklist:
    visual_quality:
      score: 32
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 8
        max: 10
        passed: true
        comment: Title and larger labels readable, but some smaller cell labels (top
          row) are quite small at output resolution
      - id: VQ-02
        name: No Overlap
        score: 4
        max: 8
        passed: false
        comment: Some text truncation issues in smaller cells (FacilitiesEvents appears
          merged, Partnership truncated)
      - id: VQ-03
        name: Element Visibility
        score: 6
        max: 8
        passed: true
        comment: Treemap rectangles clearly visible with good white borders, but only
          one view visible in PNG
      - id: VQ-04
        name: Color Accessibility
        score: 5
        max: 5
        passed: true
        comment: Excellent colorblind-safe palette with distinct hues
      - id: VQ-05
        name: Layout Balance
        score: 3
        max: 5
        passed: true
        comment: Treemap fills only ~40% of vertical canvas space; significant whitespace
          below
      - id: VQ-06
        name: Axis Labels
        score: 2
        max: 2
        passed: true
        comment: N/A for treemap (correctly omitted); tooltips provide context
      - id: VQ-07
        name: Grid & Legend
        score: 2
        max: 2
        passed: true
        comment: Legend well-placed on right, good font sizes
    spec_compliance:
      score: 22
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 8
        max: 8
        passed: true
        comment: Correctly implements both treemap and sunburst with toggle mechanism
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: Values correctly mapped to area (treemap) and angle (sunburst)
      - id: SC-03
        name: Required Features
        score: 4
        max: 5
        passed: true
        comment: 'Toggle implemented with dropdown selector; minor: static PNG can
          only show one view'
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: All 17 teams visible in treemap view
      - id: SC-05
        name: Legend Accuracy
        score: 2
        max: 2
        passed: true
        comment: Department legend accurate with correct colors
      - id: SC-06
        name: Title Format
        score: 2
        max: 2
        passed: true
        comment: 'Correct format: hierarchy-toggle-view 路 altair 路 pyplots.ai'
    data_quality:
      score: 18
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 7
        max: 8
        passed: true
        comment: Good hierarchy (3 levels, 21 nodes total), varied team sizes; sunburst
          shows parent-child relationships
      - id: DQ-02
        name: Realistic Context
        score: 7
        max: 7
        passed: true
        comment: Realistic tech company structure with sensible departments and teams
      - id: DQ-03
        name: Appropriate Scale
        score: 4
        max: 5
        passed: true
        comment: Headcount values realistic (8-52 range), though root has 0 value
    code_quality:
      score: 9
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 2
        max: 3
        passed: true
        comment: Linear flow but complex data transformation loops for manual treemap/sunburst
          layout
      - id: CQ-02
        name: Reproducibility
        score: 3
        max: 3
        passed: true
        comment: Uses np.random.seed(42)
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: Only altair, numpy, pandas
      - id: CQ-04
        name: No Deprecated API
        score: 1
        max: 1
        passed: true
        comment: Modern Altair 5.x API with selection_point
      - id: CQ-05
        name: Output Correct
        score: 1
        max: 1
        passed: true
        comment: Saves both plot.png and plot.html
    library_features:
      score: 5
      max: 5
      items:
      - id: LF-01
        name: Distinctive Features
        score: 5
        max: 5
        passed: true
        comment: 'Excellent use of declarative grammar: selection_point with binding_select
          for interactivity, alt.condition for visibility toggle, mark_rect/mark_arc
          for different chart types, theta/radius encoding, layer composition, tooltips,
          and HTML export'
  verdict: APPROVED
impl_tags:
  dependencies: []
  techniques:
  - layer-composition
  - hover-tooltips
  - html-export
  - polar-projection
  patterns:
  - data-generation
  - iteration-over-groups
  dataprep: []
  styling:
  - edge-highlighting
