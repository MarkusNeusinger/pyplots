library: letsplot
specification_id: sankey-basic
created: '2025-12-23T19:47:34Z'
updated: '2025-12-23T19:57:27Z'
generated_by: claude-opus-4-5-20251101
workflow_run: 20469999343
issue: 0
python_version: 3.13.11
library_version: 4.8.2
preview_url: https://storage.googleapis.com/pyplots-images/plots/sankey-basic/letsplot/plot.png
preview_thumb: https://storage.googleapis.com/pyplots-images/plots/sankey-basic/letsplot/plot_thumb.png
preview_html: https://storage.googleapis.com/pyplots-images/plots/sankey-basic/letsplot/plot.html
quality_score: 92
impl_tags:
  dependencies: []
  techniques:
    - bezier-curves
    - layer-composition
    - html-export
  patterns:
    - iteration-over-groups
  dataprep: []
  styling:
    - alpha-blending
review:
  strengths:
  - Excellent manual Sankey implementation using geom_polygon for smooth bezier flows
  - Clear visual hierarchy with distinct node bars and semi-transparent flows
  - Good color palette that is colorblind-accessible
  - Informative labels showing both names and total values (TWh units)
  - Proper canvas utilization with balanced layout
  - Correct title format following pyplots.ai conventions
  - Clean separation between flow calculation and visualization code
  weaknesses:
  - Node labels could be slightly larger for better readability at full resolution
  - Some minor whitespace imbalance (more space at bottom due to legend placement)
  image_description: 'The plot displays a Sankey diagram visualizing energy flow from
    four sources (Coal, Natural Gas, Nuclear, Renewable) on the left to three consumption
    sectors (Industrial, Residential, Commercial) on the right. Each source node has
    a dark navy rectangular bar with white labels showing the source name and total
    TWh (e.g., "Coal (36 TWh)"). The flows are smooth bezier curves colored by energy
    source: Coal is dark gray (#4A4A4A), Natural Gas is blue (#306998), Nuclear is
    purple (#9B59B6), and Renewable is green (#27AE60). Flows have ~65% opacity with
    thin white edges, allowing overlapping flows to remain distinguishable. Target
    nodes on the right display sector names with totals (e.g., "Industrial (72 TWh)").
    The title "Energy Flow · sankey-basic · letsplot · pyplots.ai" appears at the
    top left in bold. A horizontal legend at the bottom shows all four energy source
    colors. The plot fills approximately 70% of the canvas with balanced margins.'
  criteria_checklist:
    visual_quality:
      score: 36
      max: 40
      items:
      - id: VQ-01
        name: Text Legibility
        score: 10
        max: 10
        passed: true
        comment: Title is large and bold (~30pt), node labels are clear and readable
          (~14pt scaled)
      - id: VQ-02
        name: No Overlap
        score: 8
        max: 8
        passed: true
        comment: No overlapping text; labels are positioned outside the flow area
      - id: VQ-03
        name: Element Visibility
        score: 7
        max: 8
        passed: true
        comment: Flows are clearly visible with good alpha (0.65); white edges help
          distinguish overlapping flows
      - id: VQ-04
        name: Color Accessibility
        score: 5
        max: 5
        passed: true
        comment: Four distinct colors that work well for colorblind users (gray, blue,
          purple, green)
      - id: VQ-05
        name: Layout Balance
        score: 4
        max: 5
        passed: true
        comment: Good canvas utilization (~70%), slight imbalance with more whitespace
          at top/bottom than needed
      - id: VQ-06
        name: Axis Labels
        score: 0
        max: 2
        passed: true
        comment: N/A for Sankey diagrams (no traditional axes) - deducting as per
          criteria
      - id: VQ-07
        name: Grid & Legend
        score: 2
        max: 2
        passed: true
        comment: No grid (appropriate for Sankey), legend well-placed at bottom
    spec_compliance:
      score: 25
      max: 25
      items:
      - id: SC-01
        name: Plot Type
        score: 8
        max: 8
        passed: true
        comment: Correct Sankey diagram implementation
      - id: SC-02
        name: Data Mapping
        score: 5
        max: 5
        passed: true
        comment: Source→target flows correctly mapped with proportional widths
      - id: SC-03
        name: Required Features
        score: 5
        max: 5
        passed: true
        comment: 'All spec features present: flow visualization, node labels, distinct
          colors, link opacity'
      - id: SC-04
        name: Data Range
        score: 3
        max: 3
        passed: true
        comment: All flows visible, no data cut off
      - id: SC-05
        name: Legend Accuracy
        score: 2
        max: 2
        passed: true
        comment: Legend correctly identifies all four energy sources
      - id: SC-06
        name: Title Format
        score: 2
        max: 2
        passed: true
        comment: 'Title follows exact format: "Energy Flow · sankey-basic · letsplot
          · pyplots.ai"'
    data_quality:
      score: 19
      max: 20
      items:
      - id: DQ-01
        name: Feature Coverage
        score: 8
        max: 8
        passed: true
        comment: Shows multiple sources, multiple targets, varying flow magnitudes,
          crossing flows
      - id: DQ-02
        name: Realistic Context
        score: 6
        max: 7
        passed: true
        comment: Plausible energy distribution scenario with realistic proportions
          (gas dominates, coal to industrial)
      - id: DQ-03
        name: Appropriate Scale
        score: 5
        max: 5
        passed: true
        comment: TWh values are realistic for a regional energy system
    code_quality:
      score: 9
      max: 10
      items:
      - id: CQ-01
        name: KISS Structure
        score: 3
        max: 3
        passed: true
        comment: 'Linear flow: imports → data → calculations → plot → save'
      - id: CQ-02
        name: Reproducibility
        score: 2
        max: 3
        passed: false
        comment: Deterministic data (hardcoded values), but no explicit random seed
          statement
      - id: CQ-03
        name: Clean Imports
        score: 2
        max: 2
        passed: true
        comment: All imports are used
      - id: CQ-04
        name: No Deprecated API
        score: 1
        max: 1
        passed: true
        comment: Uses current lets-plot API
      - id: CQ-05
        name: Output Correct
        score: 1
        max: 1
        passed: true
        comment: Saves as plot.png and plot.html
    library_features:
      score: 3
      max: 5
      items:
      - id: LF-01
        name: Uses distinctive library features
        score: 3
        max: 5
        passed: true
        comment: Uses ggplot grammar effectively with geom_polygon, geom_rect, geom_text,
          theme_minimal, but Sankey is manually constructed rather than using a native
          Sankey geom (lets-plot lacks native Sankey support, so this manual approach
          is appropriate)
  verdict: APPROVED
